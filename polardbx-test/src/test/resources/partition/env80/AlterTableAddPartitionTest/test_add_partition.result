DROP TABLE IF EXISTS tbl_rng
DROP TABLE IF EXISTS tbl_rng1
DROP TABLE IF EXISTS tbl_rng2
CREATE TABLE IF NOT EXISTS tbl_rng (
	a int NOT NULL,
	PRIMARY KEY (`a`)
)
PARTITION BY RANGE (a) (
	PARTITION p1 VALUES LESS THAN (100),
	PARTITION p2 VALUES LESS THAN (200),
	PARTITION p3 VALUES LESS THAN (300),
	PARTITION p4 VALUES LESS THAN (500)
)
CREATE TABLE IF NOT EXISTS tbl_rng1 (
	a int NOT NULL,
	PRIMARY KEY (`a`)
)
PARTITION BY RANGE (a) (
	PARTITION p1 VALUES LESS THAN (100),
	PARTITION p2 VALUES LESS THAN (200),
	PARTITION p3 VALUES LESS THAN (300),
	PARTITION p4 VALUES LESS THAN (500)
)
CREATE TABLE IF NOT EXISTS tbl_rng2 (
	a int NOT NULL,
	PRIMARY KEY (`a`)
)
PARTITION BY RANGE (a) (
	PARTITION p1 VALUES LESS THAN (100),
	PARTITION p2 VALUES LESS THAN (200),
	PARTITION p3 VALUES LESS THAN (300),
	PARTITION p40 VALUES LESS THAN (500)
)
SHOW CREATE TABLE tbl_rng
Table,Create Table
tbl_rng,CREATE TABLE `tbl_rng` (
	`a` int NOT NULL,
	PRIMARY KEY (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 DEFAULT COLLATE = utf8mb4_general_ci
PARTITION BY RANGE(`a`)
(PARTITION p1 VALUES LESS THAN (100) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN (200) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (300) ENGINE = InnoDB,
 PARTITION p4 VALUES LESS THAN (500) ENGINE = InnoDB)
INSERT INTO tbl_rng
VALUES (10),
	(11),
	(12),
	(101),
	(102),
	(103),
	(201),
	(202),
	(203),
	(301)
ALTER TABLE tbl_rng
	ADD PARTITION (PARTITION p5 VALUES LESS THAN (1000))
INSERT INTO tbl_rng
VALUES (13),
	(14),
	(15),
	(104),
	(105),
	(106),
	(204),
	(205),
	(206),
	(302)
INSERT INTO tbl_rng1
VALUES (10),
	(11),
	(12),
	(101),
	(102),
	(103),
	(201),
	(202),
	(203),
	(301)
ALTER TABLE tbl_rng1
	ADD PARTITION (PARTITION p5 VALUES LESS THAN (1000))
INSERT INTO tbl_rng1
VALUES (13),
	(14),
	(15),
	(104),
	(105),
	(106),
	(204),
	(205),
	(206),
	(302)
SHOW CREATE TABLE tbl_rng
Table,Create Table
tbl_rng,CREATE TABLE `tbl_rng` (
	`a` int NOT NULL,
	PRIMARY KEY (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 DEFAULT COLLATE = utf8mb4_general_ci
PARTITION BY RANGE(`a`)
(PARTITION p1 VALUES LESS THAN (100) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN (200) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (300) ENGINE = InnoDB,
 PARTITION p4 VALUES LESS THAN (500) ENGINE = InnoDB,
 PARTITION p5 VALUES LESS THAN (1000) ENGINE = InnoDB)
INSERT INTO tbl_rng2
VALUES (10),
	(11),
	(12),
	(101),
	(102),
	(103),
	(201),
	(202),
	(203),
	(301)
ALTER TABLE tbl_rng2
	ADD PARTITION (PARTITION p5 VALUES LESS THAN (1000))
INSERT INTO tbl_rng2
VALUES (16),
	(17),
	(18),
	(110),
	(111),
	(112),
	(210),
	(211),
	(212)
SHOW CREATE TABLE tbl_rng
Table,Create Table
tbl_rng,CREATE TABLE `tbl_rng` (
	`a` int NOT NULL,
	PRIMARY KEY (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 DEFAULT COLLATE = utf8mb4_general_ci
PARTITION BY RANGE(`a`)
(PARTITION p1 VALUES LESS THAN (100) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN (200) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (300) ENGINE = InnoDB,
 PARTITION p4 VALUES LESS THAN (500) ENGINE = InnoDB,
 PARTITION p5 VALUES LESS THAN (1000) ENGINE = InnoDB)
SHOW CREATE TABLE tbl_rng1
Table,Create Table
tbl_rng1,CREATE TABLE `tbl_rng1` (
	`a` int NOT NULL,
	PRIMARY KEY (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 DEFAULT COLLATE = utf8mb4_general_ci
PARTITION BY RANGE(`a`)
(PARTITION p1 VALUES LESS THAN (100) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN (200) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (300) ENGINE = InnoDB,
 PARTITION p4 VALUES LESS THAN (500) ENGINE = InnoDB,
 PARTITION p5 VALUES LESS THAN (1000) ENGINE = InnoDB)
SHOW CREATE TABLE tbl_rng2
Table,Create Table
tbl_rng2,CREATE TABLE `tbl_rng2` (
	`a` int NOT NULL,
	PRIMARY KEY (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 DEFAULT COLLATE = utf8mb4_general_ci
PARTITION BY RANGE(`a`)
(PARTITION p1 VALUES LESS THAN (100) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN (200) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (300) ENGINE = InnoDB,
 PARTITION p40 VALUES LESS THAN (500) ENGINE = InnoDB,
 PARTITION p5 VALUES LESS THAN (1000) ENGINE = InnoDB)
SELECT *
FROM tbl_rng
ORDER BY a
a
10
11
12
13
14
15
101
102
103
104
105
106
201
202
203
204
205
206
301
302
SELECT *
FROM tbl_rng1
ORDER BY a
a
10
11
12
13
14
15
101
102
103
104
105
106
201
202
203
204
205
206
301
302
SELECT *
FROM tbl_rng2
ORDER BY a
a
10
11
12
16
17
18
101
102
103
110
111
112
201
202
203
210
211
212
301
DROP TABLE IF EXISTS tbl_rng_col
DROP TABLE IF EXISTS tbl_rng_col1
CREATE TABLE IF NOT EXISTS tbl_rng_col (
	a varchar(20) NOT NULL,
	b int,
	PRIMARY KEY (`a`)
)
PARTITION BY RANGE COLUMNS (a, b) (
	PARTITION p1 VALUES LESS THAN ('100', 20),
	PARTITION p2 VALUES LESS THAN ('200', 20),
	PARTITION p3 VALUES LESS THAN ('300', 20),
	PARTITION p4 VALUES LESS THAN ('500', 500)
)
CREATE TABLE IF NOT EXISTS tbl_rng_col1 (
	a varchar(20) NOT NULL,
	b int,
	PRIMARY KEY (`a`)
)
PARTITION BY RANGE COLUMNS (a, b) (
	PARTITION p1 VALUES LESS THAN ('100', 20),
	PARTITION p2 VALUES LESS THAN ('200', 20),
	PARTITION p3 VALUES LESS THAN ('300', 20),
	PARTITION p4 VALUES LESS THAN ('500', 500)
)
SHOW CREATE TABLE tbl_rng_col
Table,Create Table
tbl_rng_col,CREATE TABLE `tbl_rng_col` (
	`a` varchar(20) COLLATE utf8mb4_general_ci NOT NULL,
	`b` int DEFAULT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 DEFAULT COLLATE = utf8mb4_general_ci
PARTITION BY RANGE COLUMNS(`a`,`b`)
(PARTITION p1 VALUES LESS THAN ('100',20) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN ('200',20) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN ('300',20) ENGINE = InnoDB,
 PARTITION p4 VALUES LESS THAN ('500',500) ENGINE = InnoDB)
INSERT INTO tbl_rng_col
VALUES ('10', 10),
	('11', 11),
	('12', 12),
	('13', 101),
	('150', 10),
	('151', 103),
	('152', 201),
	('250', 202),
	('251', 203),
	('252', 301),
	('350', 10)
ALTER TABLE tbl_rng_col
	ADD PARTITION (PARTITION p5 VALUES LESS THAN ('800', 500))
INSERT INTO tbl_rng_col
VALUES ('20', 10),
	('21', 11),
	('22', 12),
	('23', 101),
	('160', 10),
	('161', 103),
	('162', 201),
	('260', 202),
	('261', 203),
	('262', 301),
	('360', 10)
INSERT INTO tbl_rng_col1
VALUES ('10', 10),
	('11', 11),
	('12', 12),
	('13', 101),
	('150', 10),
	('151', 103),
	('152', 201),
	('250', 202),
	('251', 203),
	('252', 301),
	('350', 10)
ALTER TABLE tbl_rng_col1
	ADD PARTITION (PARTITION p5 VALUES LESS THAN ('800', 500))
INSERT INTO tbl_rng_col1
VALUES ('20', 10),
	('21', 11),
	('22', 12),
	('23', 101),
	('160', 10),
	('161', 103),
	('162', 201),
	('260', 202),
	('261', 203),
	('262', 301),
	('360', 10)
SHOW CREATE TABLE tbl_rng_col
Table,Create Table
tbl_rng_col,CREATE TABLE `tbl_rng_col` (
	`a` varchar(20) COLLATE utf8mb4_general_ci NOT NULL,
	`b` int DEFAULT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 DEFAULT COLLATE = utf8mb4_general_ci
PARTITION BY RANGE COLUMNS(`a`,`b`)
(PARTITION p1 VALUES LESS THAN ('100',20) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN ('200',20) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN ('300',20) ENGINE = InnoDB,
 PARTITION p4 VALUES LESS THAN ('500',500) ENGINE = InnoDB,
 PARTITION p5 VALUES LESS THAN ('800',500) ENGINE = InnoDB)
ALTER TABLE tbl_rng_col
	DROP PARTITION p4
INSERT INTO tbl_rng_col
VALUES ('30', 10),
	('170', 10),
	('171', 103),
	('172', 201),
	('270', 202),
	('271', 203),
	('272', 301)
ALTER TABLE tbl_rng_col1
	DROP PARTITION p4
INSERT INTO tbl_rng_col1
VALUES ('30', 10),
	('170', 10),
	('171', 103),
	('172', 201),
	('270', 202),
	('271', 203),
	('272', 301)
SHOW CREATE TABLE tbl_rng_col
Table,Create Table
tbl_rng_col,CREATE TABLE `tbl_rng_col` (
	`a` varchar(20) COLLATE utf8mb4_general_ci NOT NULL,
	`b` int DEFAULT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 DEFAULT COLLATE = utf8mb4_general_ci
PARTITION BY RANGE COLUMNS(`a`,`b`)
(PARTITION p1 VALUES LESS THAN ('100',20) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN ('200',20) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN ('300',20) ENGINE = InnoDB,
 PARTITION p5 VALUES LESS THAN ('800',500) ENGINE = InnoDB)
SHOW CREATE TABLE tbl_rng_col1
Table,Create Table
tbl_rng_col1,CREATE TABLE `tbl_rng_col1` (
	`a` varchar(20) COLLATE utf8mb4_general_ci NOT NULL,
	`b` int DEFAULT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 DEFAULT COLLATE = utf8mb4_general_ci
PARTITION BY RANGE COLUMNS(`a`,`b`)
(PARTITION p1 VALUES LESS THAN ('100',20) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN ('200',20) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN ('300',20) ENGINE = InnoDB,
 PARTITION p5 VALUES LESS THAN ('800',500) ENGINE = InnoDB)
SELECT *
FROM tbl_rng_col
ORDER BY a
a,b
10,10
11,11
12,12
13,101
150,10
151,103
152,201
160,10
161,103
162,201
170,10
171,103
172,201
20,10
21,11
22,12
23,101
250,202
251,203
252,301
260,202
261,203
262,301
270,202
271,203
272,301
30,10
SELECT *
FROM tbl_rng_col1
ORDER BY a
a,b
10,10
11,11
12,12
13,101
150,10
151,103
152,201
160,10
161,103
162,201
170,10
171,103
172,201
20,10
21,11
22,12
23,101
250,202
251,203
252,301
260,202
261,203
262,301
270,202
271,203
272,301
30,10
DROP TABLE IF EXISTS tbl_list
DROP TABLE IF EXISTS tbl_list1
CREATE TABLE IF NOT EXISTS tbl_list (
	a int NOT NULL,
	PRIMARY KEY (`a`)
)
PARTITION BY LIST (a) (
	PARTITION p1 VALUES IN (10, 11),
	PARTITION p2 VALUES IN (100, 101),
	PARTITION p3 VALUES IN (200, 201),
	PARTITION p4 VALUES IN (300)
)
CREATE TABLE IF NOT EXISTS tbl_list1 (
	a int NOT NULL,
	PRIMARY KEY (`a`)
)
PARTITION BY LIST (a) (
	PARTITION p1 VALUES IN (10, 11),
	PARTITION p2 VALUES IN (100, 101),
	PARTITION p3 VALUES IN (200, 201),
	PARTITION p4 VALUES IN (300)
)
SHOW CREATE TABLE tbl_list
Table,Create Table
tbl_list,CREATE TABLE `tbl_list` (
	`a` int NOT NULL,
	PRIMARY KEY (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 DEFAULT COLLATE = utf8mb4_general_ci
PARTITION BY LIST(`a`)
(PARTITION p1 VALUES IN (10,11) ENGINE = InnoDB,
 PARTITION p2 VALUES IN (100,101) ENGINE = InnoDB,
 PARTITION p3 VALUES IN (200,201) ENGINE = InnoDB,
 PARTITION p4 VALUES IN (300) ENGINE = InnoDB)
INSERT INTO tbl_list
VALUES (10),
	(11),
	(100),
	(101),
	(201),
	(300)
ALTER TABLE tbl_list
	ADD PARTITION (PARTITION p5 VALUES IN (12, 13, 14, 15, 102, 103, 104, 105, 106, 202, 203, 204, 205, 206))
INSERT INTO tbl_list
VALUES (13),
	(14),
	(15),
	(104),
	(105),
	(106),
	(204),
	(205),
	(206)
INSERT INTO tbl_list1
VALUES (10),
	(11),
	(100),
	(101),
	(201),
	(300)
ALTER TABLE tbl_list1
	ADD PARTITION (PARTITION p5 VALUES IN (DEFAULT))
INSERT INTO tbl_list1
VALUES (13),
	(14),
	(15),
	(104),
	(105),
	(106),
	(204),
	(205),
	(206)
SHOW CREATE TABLE tbl_list
Table,Create Table
tbl_list,CREATE TABLE `tbl_list` (
	`a` int NOT NULL,
	PRIMARY KEY (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 DEFAULT COLLATE = utf8mb4_general_ci
PARTITION BY LIST(`a`)
(PARTITION p1 VALUES IN (10,11) ENGINE = InnoDB,
 PARTITION p5 VALUES IN (12,13,14,15,102,103,104,105,106,202,203,204,205,206) ENGINE = InnoDB,
 PARTITION p2 VALUES IN (100,101) ENGINE = InnoDB,
 PARTITION p3 VALUES IN (200,201) ENGINE = InnoDB,
 PARTITION p4 VALUES IN (300) ENGINE = InnoDB)
SHOW CREATE TABLE tbl_list1
Table,Create Table
tbl_list1,CREATE TABLE `tbl_list1` (
	`a` int NOT NULL,
	PRIMARY KEY (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 DEFAULT COLLATE = utf8mb4_general_ci
PARTITION BY LIST(`a`)
(PARTITION p1 VALUES IN (10,11) ENGINE = InnoDB,
 PARTITION p2 VALUES IN (100,101) ENGINE = InnoDB,
 PARTITION p3 VALUES IN (200,201) ENGINE = InnoDB,
 PARTITION p4 VALUES IN (300) ENGINE = InnoDB,
 PARTITION p5 VALUES IN (DEFAULT) ENGINE = InnoDB)
SELECT *
FROM tbl_list
ORDER BY a
a
10
11
13
14
15
100
101
104
105
106
201
204
205
206
300
SELECT *
FROM tbl_list1
ORDER BY a
a
10
11
13
14
15
100
101
104
105
106
201
204
205
206
300
DROP TABLE IF EXISTS tbl_list_col
DROP TABLE IF EXISTS tbl_list_col1
CREATE TABLE IF NOT EXISTS tbl_list_col (
	a int NOT NULL,
	b int,
	PRIMARY KEY (`a`)
)
PARTITION BY LIST COLUMNS (a, b) (
	PARTITION p1 VALUES IN ((10, 11), (12, 13)),
	PARTITION p2 VALUES IN ((100, 101), (100, 103)),
	PARTITION p3 VALUES IN ((200, 201), (100, 1321)),
	PARTITION p4 VALUES IN ((300, 301))
)
CREATE TABLE IF NOT EXISTS tbl_list_col1 (
	a int NOT NULL,
	b int,
	PRIMARY KEY (`a`)
)
PARTITION BY LIST COLUMNS (a, b) (
	PARTITION p1 VALUES IN ((10, 11), (12, 13)),
	PARTITION p2 VALUES IN ((100, 101), (100, 103)),
	PARTITION p3 VALUES IN ((200, 201), (100, 1321)),
	PARTITION p4 VALUES IN ((300, 301))
)
SHOW CREATE TABLE tbl_list_col
Table,Create Table
tbl_list_col,CREATE TABLE `tbl_list_col` (
	`a` int NOT NULL,
	`b` int DEFAULT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 DEFAULT COLLATE = utf8mb4_general_ci
PARTITION BY LIST COLUMNS(`a`,`b`)
(PARTITION p1 VALUES IN ((10,11),(12,13)) ENGINE = InnoDB,
 PARTITION p2 VALUES IN ((100,101),(100,103)) ENGINE = InnoDB,
 PARTITION p3 VALUES IN ((100,1321),(200,201)) ENGINE = InnoDB,
 PARTITION p4 VALUES IN ((300,301)) ENGINE = InnoDB)
INSERT INTO tbl_list_col
VALUES (10, 11),
	(100, 101),
	(300, 301)
ALTER TABLE tbl_list_col
	ADD PARTITION (PARTITION p5 VALUES IN ((301, 101)))
INSERT INTO tbl_list_col
VALUES (12, 13),
	(301, 101)
INSERT INTO tbl_list_col1
VALUES (10, 11),
	(100, 101),
	(300, 301)
ALTER TABLE tbl_list_col1
	ADD PARTITION (PARTITION p5 VALUES IN (DEFAULT))
INSERT INTO tbl_list_col1
VALUES (12, 13),
	(100, 1321),
	(301, 101)
ALTER TABLE tbl_list_col1
	DROP PARTITION p4
INSERT INTO tbl_list_col1
VALUES (200, 201)
SHOW CREATE TABLE tbl_list_col
Table,Create Table
tbl_list_col,CREATE TABLE `tbl_list_col` (
	`a` int NOT NULL,
	`b` int DEFAULT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 DEFAULT COLLATE = utf8mb4_general_ci
PARTITION BY LIST COLUMNS(`a`,`b`)
(PARTITION p1 VALUES IN ((10,11),(12,13)) ENGINE = InnoDB,
 PARTITION p2 VALUES IN ((100,101),(100,103)) ENGINE = InnoDB,
 PARTITION p3 VALUES IN ((100,1321),(200,201)) ENGINE = InnoDB,
 PARTITION p4 VALUES IN ((300,301)) ENGINE = InnoDB,
 PARTITION p5 VALUES IN ((301,101)) ENGINE = InnoDB)
SHOW CREATE TABLE tbl_list_col1
Table,Create Table
tbl_list_col1,CREATE TABLE `tbl_list_col1` (
	`a` int NOT NULL,
	`b` int DEFAULT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 DEFAULT COLLATE = utf8mb4_general_ci
PARTITION BY LIST COLUMNS(`a`,`b`)
(PARTITION p1 VALUES IN ((10,11),(12,13)) ENGINE = InnoDB,
 PARTITION p2 VALUES IN ((100,101),(100,103)) ENGINE = InnoDB,
 PARTITION p3 VALUES IN ((100,1321),(200,201)) ENGINE = InnoDB,
 PARTITION p5 VALUES IN (DEFAULT) ENGINE = InnoDB)
SELECT *
FROM tbl_list_col
ORDER BY a, b
a,b
10,11
12,13
100,101
300,301
301,101
SELECT *
FROM tbl_list_col1
ORDER BY a, b
a,b
10,11
12,13
100,101
100,1321
200,201
301,101