## DISABLE_FAST_SQL_PARSER
create tablegroup if not exists my_ntp_tg_1;
## h_h_ntp
create table if not exists h_h_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by hash (c,d) partitions 4
subpartition by hash (a,b)
(
partition p1 subpartitions 2,
partition p2 subpartitions 4,
partition p3 subpartitions 3,
partition p4 subpartitions 1
);
create table if not exists h_h_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by hash (c,d) partitions 4
subpartition by hash (a,b)
(
partition p1 subpartitions 2,
partition p2 subpartitions 4,
partition p3 subpartitions 3,
partition p4 subpartitions 1
);
alter table h_h_ntp1 split partition p1 into partitions 3;
alter table h_h_ntp2 split partition p1 into partitions 3;
alter table h_h_ntp1 split subpartition p2sp1 into subpartitions 2;
alter table h_h_ntp2 split subpartition p2sp1 into subpartitions 2;
alter table h_h_ntp1 merge partitions p3,p4 to p34;
alter table h_h_ntp2 merge partitions p3,p4 to p34;
alter table h_h_ntp1 merge subpartitions p2sp3,p2sp4 to p2sp34;
alter table h_h_ntp2 merge subpartitions p2sp3,p2sp4 to p2sp34;
alter table h_h_ntp1 set tablegroup=my_ntp_tg_1;
alter table h_h_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 merge subpartitions p2sp2,p2sp34 to p2sp234;
alter tablegroup my_ntp_tg_1 split subpartition p2sp234 into subpartitions 3;
alter tablegroup my_ntp_tg_1 merge partitions p2,p34 to p234;
alter tablegroup my_ntp_tg_1 split partition p234 into partitions 3;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table h_h_ntp1;
Table,Create Table
h_h_ntp1,CREATE TABLE `h_h_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY HASH(`c`,`d`)
SUBPARTITION BY HASH(`a`,`b`)
(PARTITION p5 VALUES LESS THAN (-7686143364045646505)
 (SUBPARTITION sp8 VALUES LESS THAN (1) ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202)
 (SUBPARTITION sp10 VALUES LESS THAN (1) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899)
 (SUBPARTITION sp12 VALUES LESS THAN (1) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p28 VALUES LESS THAN (3)
 (SUBPARTITION sp31 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p29 VALUES LESS THAN (4611686018427387905)
 (SUBPARTITION sp32 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p30 VALUES LESS THAN (9223372036854775807)
 (SUBPARTITION sp33 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table h_h_ntp2;
Table,Create Table
h_h_ntp2,CREATE TABLE `h_h_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY HASH(`c`,`d`)
SUBPARTITION BY HASH(`a`,`b`)
(PARTITION p5 VALUES LESS THAN (-7686143364045646505)
 (SUBPARTITION sp8 VALUES LESS THAN (1) ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202)
 (SUBPARTITION sp10 VALUES LESS THAN (1) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899)
 (SUBPARTITION sp12 VALUES LESS THAN (1) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p28 VALUES LESS THAN (3)
 (SUBPARTITION sp31 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p29 VALUES LESS THAN (4611686018427387905)
 (SUBPARTITION sp32 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p30 VALUES LESS THAN (9223372036854775807)
 (SUBPARTITION sp33 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table h_h_ntp1;
drop table h_h_ntp2;
## h_k_ntp
create table if not exists h_k_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by hash (c,d) partitions 4
subpartition by key (a,b)
(
partition p1 subpartitions 2,
partition p2 subpartitions 4,
partition p3 subpartitions 3,
partition p4 subpartitions 1
);
create table if not exists h_k_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by hash (c,d) partitions 4
subpartition by key (a,b)
(
partition p1 subpartitions 2,
partition p2 subpartitions 4,
partition p3 subpartitions 3,
partition p4 subpartitions 1
);
alter table h_k_ntp1 split partition p1 into partitions 3;
alter table h_k_ntp2 split partition p1 into partitions 3;
alter table h_k_ntp1 split subpartition p2sp1 into subpartitions 2;
alter table h_k_ntp2 split subpartition p2sp1 into subpartitions 2;
alter table h_k_ntp1 merge partitions p3,p4 to p34;
alter table h_k_ntp2 merge partitions p3,p4 to p34;
alter table h_k_ntp1 merge subpartitions p2sp3,p2sp4 to p2sp34;
alter table h_k_ntp2 merge subpartitions p2sp3,p2sp4 to p2sp34;
alter table h_k_ntp1 set tablegroup=my_ntp_tg_1;
alter table h_k_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 merge subpartitions p2sp2,p2sp34 to p2sp234;
alter tablegroup my_ntp_tg_1 split subpartition p2sp234 into subpartitions 3;
alter tablegroup my_ntp_tg_1 merge partitions p2,p34 to p234;
alter tablegroup my_ntp_tg_1 split partition p234 into partitions 3;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table h_k_ntp1;
Table,Create Table
h_k_ntp1,CREATE TABLE `h_k_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY HASH(`c`,`d`)
SUBPARTITION BY KEY(`a`,`b`)
(PARTITION p5 VALUES LESS THAN (-7686143364045646505)
 (SUBPARTITION sp8 VALUES LESS THAN (1,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202)
 (SUBPARTITION sp10 VALUES LESS THAN (1,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899)
 (SUBPARTITION sp12 VALUES LESS THAN (1,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p39 VALUES LESS THAN (3)
 (SUBPARTITION sp42 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p40 VALUES LESS THAN (4611686018427387905)
 (SUBPARTITION sp43 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p41 VALUES LESS THAN (9223372036854775807)
 (SUBPARTITION sp44 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table h_k_ntp2;
Table,Create Table
h_k_ntp2,CREATE TABLE `h_k_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY HASH(`c`,`d`)
SUBPARTITION BY KEY(`a`,`b`)
(PARTITION p5 VALUES LESS THAN (-7686143364045646505)
 (SUBPARTITION sp8 VALUES LESS THAN (1,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202)
 (SUBPARTITION sp10 VALUES LESS THAN (1,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899)
 (SUBPARTITION sp12 VALUES LESS THAN (1,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p39 VALUES LESS THAN (3)
 (SUBPARTITION sp42 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p40 VALUES LESS THAN (4611686018427387905)
 (SUBPARTITION sp43 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p41 VALUES LESS THAN (9223372036854775807)
 (SUBPARTITION sp44 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table h_k_ntp1;
drop table h_k_ntp2;
## h_r_ntp
create table if not exists h_r_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by hash (a,b) partitions 4
subpartition by range (to_days(c))
(
partition p1
(
subpartition p1sp1 values less than ( to_days('2020-01-01') ),
subpartition p1sp2 values less than ( maxvalue )
),
partition p2
(
subpartition p2sp1 values less than ( to_days('2020-01-01') ),
subpartition p2sp2 values less than ( to_days('2021-01-01') ),
subpartition p2sp3 values less than ( to_days('2022-01-01') ),
subpartition p2sp4 values less than ( maxvalue )
),
partition p3
(
subpartition p3sp1 values less than ( to_days('2020-01-01') ),
subpartition p3sp2 values less than ( maxvalue )
),
partition p4
(
subpartition p4sp1 values less than ( to_days('2020-01-01') ),
subpartition p4sp2 values less than ( maxvalue )
)
);
create table if not exists h_r_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by hash (a,b) partitions 4
subpartition by range (to_days(c))
(
partition p1
(
subpartition p1sp1 values less than ( to_days('2020-01-01') ),
subpartition p1sp2 values less than ( maxvalue )
),
partition p2
(
subpartition p2sp1 values less than ( to_days('2020-01-01') ),
subpartition p2sp2 values less than ( to_days('2021-01-01') ),
subpartition p2sp3 values less than ( to_days('2022-01-01') ),
subpartition p2sp4 values less than ( maxvalue )
),
partition p3
(
subpartition p3sp1 values less than ( to_days('2020-01-01') ),
subpartition p3sp2 values less than ( maxvalue )
),
partition p4
(
subpartition p4sp1 values less than ( to_days('2020-01-01') ),
subpartition p4sp2 values less than ( maxvalue )
)
);
alter table h_r_ntp1 split partition p1 into partitions 3;
alter table h_r_ntp2 split partition p1 into partitions 3;
alter table h_r_ntp1 split subpartition p3sp2 at(1000000) into (subpartition p3sp20,subpartition p3sp21);
alter table h_r_ntp2 split subpartition p3sp2 at(1000000) into (subpartition p3sp20,subpartition p3sp21);
alter table h_r_ntp1 merge subpartitions p3sp20,p3sp21 to p3sp2;
alter table h_r_ntp2 merge subpartitions p3sp20,p3sp21 to p3sp2;
alter table h_r_ntp1 merge partitions p3,p4 to p34;
alter table h_r_ntp2 merge partitions p3,p4 to p34;
alter table h_r_ntp1 set tablegroup=my_ntp_tg_1;
alter table h_r_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p2sp4 at(100000000) into (subpartition p2sp40,subpartition p2sp41);
alter tablegroup my_ntp_tg_1 merge subpartitions p2sp40,p2sp41 to p2sp4;
alter tablegroup my_ntp_tg_1 split partition p2 into px partitions 3;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table h_r_ntp1;
Table,Create Table
h_r_ntp1,CREATE TABLE `h_r_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY HASH(`a`,`b`)
SUBPARTITION BY RANGE(TO_DAYS(`c`))
(PARTITION p5 VALUES LESS THAN (-7686143364045646505)
 (SUBPARTITION sp8 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202)
 (SUBPARTITION sp10 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899)
 (SUBPARTITION sp12 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION px1 VALUES LESS THAN (-3074457345618258599)
 (SUBPARTITION sp46 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp47 VALUES LESS THAN (738156) ENGINE = InnoDB,
  SUBPARTITION sp48 VALUES LESS THAN (738521) ENGINE = InnoDB,
  SUBPARTITION sp49 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION px2 VALUES LESS THAN (-1537228672809129299)
 (SUBPARTITION sp50 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp51 VALUES LESS THAN (738156) ENGINE = InnoDB,
  SUBPARTITION sp52 VALUES LESS THAN (738521) ENGINE = InnoDB,
  SUBPARTITION sp53 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION px3 VALUES LESS THAN (3)
 (SUBPARTITION sp54 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp55 VALUES LESS THAN (738156) ENGINE = InnoDB,
  SUBPARTITION sp56 VALUES LESS THAN (738521) ENGINE = InnoDB,
  SUBPARTITION sp57 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p34 VALUES LESS THAN (9223372036854775807)
 (SUBPARTITION sp1 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table h_r_ntp2;
Table,Create Table
h_r_ntp2,CREATE TABLE `h_r_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY HASH(`a`,`b`)
SUBPARTITION BY RANGE(TO_DAYS(`c`))
(PARTITION p5 VALUES LESS THAN (-7686143364045646505)
 (SUBPARTITION sp8 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202)
 (SUBPARTITION sp10 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899)
 (SUBPARTITION sp12 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION px1 VALUES LESS THAN (-3074457345618258599)
 (SUBPARTITION sp46 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp47 VALUES LESS THAN (738156) ENGINE = InnoDB,
  SUBPARTITION sp48 VALUES LESS THAN (738521) ENGINE = InnoDB,
  SUBPARTITION sp49 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION px2 VALUES LESS THAN (-1537228672809129299)
 (SUBPARTITION sp50 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp51 VALUES LESS THAN (738156) ENGINE = InnoDB,
  SUBPARTITION sp52 VALUES LESS THAN (738521) ENGINE = InnoDB,
  SUBPARTITION sp53 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION px3 VALUES LESS THAN (3)
 (SUBPARTITION sp54 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp55 VALUES LESS THAN (738156) ENGINE = InnoDB,
  SUBPARTITION sp56 VALUES LESS THAN (738521) ENGINE = InnoDB,
  SUBPARTITION sp57 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p34 VALUES LESS THAN (9223372036854775807)
 (SUBPARTITION sp1 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table h_r_ntp1;
drop table h_r_ntp2;
## h_rc_ntp
create table if not exists h_rc_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by hash (a,b) partitions 4
subpartition by range columns (c,d)
(
partition p1
(
subpartition p1sp1 values less than ( '2020-01-01', 'abc' ),
subpartition p1sp2 values less than ( maxvalue, maxvalue )
),
partition p2
(
subpartition p2sp1 values less than ( '2020-01-01', 'abc' ),
subpartition p2sp2 values less than ( '2021-01-01', 'abc' ),
subpartition p2sp3 values less than ( '2022-01-01', 'abc' ),
subpartition p2sp4 values less than ( maxvalue, maxvalue )
),
partition p3
(
subpartition p3sp1 values less than ( '2020-01-01', 'abc' ),
subpartition p3sp2 values less than ( maxvalue, maxvalue )
),
partition p4
(
subpartition p4sp1 values less than ( '2020-01-01', 'abc' ),
subpartition p4sp2 values less than ( maxvalue, maxvalue )
)
);
create table if not exists h_rc_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by hash (a,b) partitions 4
subpartition by range columns (c,d)
(
partition p1
(
subpartition p1sp1 values less than ( '2020-01-01', 'abc' ),
subpartition p1sp2 values less than ( maxvalue, maxvalue )
),
partition p2
(
subpartition p2sp1 values less than ( '2020-01-01', 'abc' ),
subpartition p2sp2 values less than ( '2021-01-01', 'abc' ),
subpartition p2sp3 values less than ( '2022-01-01', 'abc' ),
subpartition p2sp4 values less than ( maxvalue, maxvalue )
),
partition p3
(
subpartition p3sp1 values less than ( '2020-01-01', 'abc' ),
subpartition p3sp2 values less than ( maxvalue, maxvalue )
),
partition p4
(
subpartition p4sp1 values less than ( '2020-01-01', 'abc' ),
subpartition p4sp2 values less than ( maxvalue, maxvalue )
)
);
alter table h_rc_ntp1 split partition p1 into partitions 3;
alter table h_rc_ntp2 split partition p1 into partitions 3;
alter table h_rc_ntp1 split subpartition p3sp2 into (subpartition p3sp20 values less than ( '2021-01-01', 'abc' ),subpartition p3sp21 values less than ( '2022-01-01', 'abc' ),subpartition p3sp22 values less than ( maxvalue, maxvalue ));
alter table h_rc_ntp2 split subpartition p3sp2 into (subpartition p3sp20 values less than ( '2021-01-01', 'abc' ),subpartition p3sp21 values less than ( '2022-01-01', 'abc' ),subpartition p3sp22 values less than ( maxvalue, maxvalue ));
alter table h_rc_ntp1 merge subpartitions p3sp20,p3sp21,p3sp22 to p3sp2;
alter table h_rc_ntp2 merge subpartitions p3sp20,p3sp21,p3sp22 to p3sp2;
alter table h_rc_ntp1 merge partitions p3,p4 to p34;
alter table h_rc_ntp2 merge partitions p3,p4 to p34;
alter table h_rc_ntp1 set tablegroup=my_ntp_tg_1;
alter table h_rc_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p2sp4 into (subpartition p2sp40 values less than ( '2023-01-01', 'abc' ),subpartition p2sp41 values less than ( maxvalue, maxvalue ));
alter tablegroup my_ntp_tg_1 merge subpartitions p2sp40,p2sp41 to p2sp4;
alter tablegroup my_ntp_tg_1 split partition p2 into px partitions 3;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table h_rc_ntp1;
Table,Create Table
h_rc_ntp1,CREATE TABLE `h_rc_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY HASH(`a`,`b`)
SUBPARTITION BY RANGE COLUMNS(`c`,`d`)
(PARTITION p5 VALUES LESS THAN (-7686143364045646505)
 (SUBPARTITION sp8 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202)
 (SUBPARTITION sp10 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899)
 (SUBPARTITION sp12 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION px1 VALUES LESS THAN (-3074457345618258599)
 (SUBPARTITION sp59 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp60 VALUES LESS THAN ('2021-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp61 VALUES LESS THAN ('2022-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp62 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION px2 VALUES LESS THAN (-1537228672809129299)
 (SUBPARTITION sp63 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp64 VALUES LESS THAN ('2021-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp65 VALUES LESS THAN ('2022-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp66 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION px3 VALUES LESS THAN (3)
 (SUBPARTITION sp67 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp68 VALUES LESS THAN ('2021-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp69 VALUES LESS THAN ('2022-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp70 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p34 VALUES LESS THAN (9223372036854775807)
 (SUBPARTITION sp1 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table h_rc_ntp2;
Table,Create Table
h_rc_ntp2,CREATE TABLE `h_rc_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY HASH(`a`,`b`)
SUBPARTITION BY RANGE COLUMNS(`c`,`d`)
(PARTITION p5 VALUES LESS THAN (-7686143364045646505)
 (SUBPARTITION sp8 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202)
 (SUBPARTITION sp10 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899)
 (SUBPARTITION sp12 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION px1 VALUES LESS THAN (-3074457345618258599)
 (SUBPARTITION sp59 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp60 VALUES LESS THAN ('2021-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp61 VALUES LESS THAN ('2022-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp62 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION px2 VALUES LESS THAN (-1537228672809129299)
 (SUBPARTITION sp63 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp64 VALUES LESS THAN ('2021-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp65 VALUES LESS THAN ('2022-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp66 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION px3 VALUES LESS THAN (3)
 (SUBPARTITION sp67 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp68 VALUES LESS THAN ('2021-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp69 VALUES LESS THAN ('2022-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp70 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p34 VALUES LESS THAN (9223372036854775807)
 (SUBPARTITION sp1 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table h_rc_ntp1;
drop table h_rc_ntp2;
## h_l_ntp
create table if not exists h_l_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by hash (a,b) partitions 4
subpartition by list (to_days(c))
(
partition p1
(
subpartition p1sp1 values in ( to_days('2020-01-01') ),
subpartition p1sp2 values in ( default )
),
partition p2
(
subpartition p2sp1 values in ( to_days('2020-01-01') ),
subpartition p2sp2 values in ( to_days('2021-01-01') ),
subpartition p2sp3 values in ( default )
),
partition p3
(
subpartition p3sp1 values in ( to_days('2020-01-01') ),
subpartition p3sp2 values in ( default )
),
partition p4
(
subpartition p4sp1 values in ( to_days('2020-01-01') ),
subpartition p4sp2 values in ( default )
)
);
create table if not exists h_l_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by hash (a,b) partitions 4
subpartition by list (to_days(c))
(
partition p1
(
subpartition p1sp1 values in ( to_days('2020-01-01') ),
subpartition p1sp2 values in ( default )
),
partition p2
(
subpartition p2sp1 values in ( to_days('2020-01-01') ),
subpartition p2sp2 values in ( to_days('2021-01-01') ),
subpartition p2sp3 values in ( default )
),
partition p3
(
subpartition p3sp1 values in ( to_days('2020-01-01') ),
subpartition p3sp2 values in ( default )
),
partition p4
(
subpartition p4sp1 values in ( to_days('2020-01-01') ),
subpartition p4sp2 values in ( default )
)
);
alter table h_l_ntp1 split partition p1 into partitions 3;
alter table h_l_ntp2 split partition p1 into partitions 3;
alter table h_l_ntp1 split subpartition p2sp3 into (subpartition p2sp30 values in(1,2,3,4), subpartition p2sp31 values in(5，6)， subpartition p2sp32 values in ( default ));
alter table h_l_ntp2 split subpartition p2sp3 into (subpartition p2sp30 values in(1,2,3,4), subpartition p2sp31 values in(5，6)， subpartition p2sp32 values in ( default ));
alter table h_l_ntp1 merge partitions p3,p4 to p34;
alter table h_l_ntp2 merge partitions p3,p4 to p34;
alter table h_l_ntp1 merge subpartitions p2sp30,p2sp31 to p2sp3;
alter table h_l_ntp2 merge subpartitions p2sp30,p2sp31 to p2sp3;
alter table h_l_ntp1 set tablegroup=my_ntp_tg_1;
alter table h_l_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p2sp32 into (subpartition p2sp320 values in(10,11),subpartition p2sp321 values in(12,13),subpartition p2sp322 values in ( default ));
alter tablegroup my_ntp_tg_1 merge subpartitions p2sp320,p2sp321 to p2sp32;
alter tablegroup my_ntp_tg_1 split partition p2 into partitions 3;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table h_l_ntp1;
Table,Create Table
h_l_ntp1,CREATE TABLE `h_l_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY HASH(`a`,`b`)
SUBPARTITION BY LIST(TO_DAYS(`c`))
(PARTITION p5 VALUES LESS THAN (-7686143364045646505)
 (SUBPARTITION sp8 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202)
 (SUBPARTITION sp10 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899)
 (SUBPARTITION sp12 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p72 VALUES LESS THAN (-3074457345618258599)
 (SUBPARTITION sp75 VALUES IN (1,2,3,4,5,6) ENGINE = InnoDB,
  SUBPARTITION sp76 VALUES IN (10,11,12,13) ENGINE = InnoDB,
  SUBPARTITION sp77 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp78 VALUES IN (738156) ENGINE = InnoDB,
  SUBPARTITION sp79 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p73 VALUES LESS THAN (-1537228672809129299)
 (SUBPARTITION sp80 VALUES IN (1,2,3,4,5,6) ENGINE = InnoDB,
  SUBPARTITION sp81 VALUES IN (10,11,12,13) ENGINE = InnoDB,
  SUBPARTITION sp82 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp83 VALUES IN (738156) ENGINE = InnoDB,
  SUBPARTITION sp84 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p74 VALUES LESS THAN (3)
 (SUBPARTITION sp85 VALUES IN (1,2,3,4,5,6) ENGINE = InnoDB,
  SUBPARTITION sp86 VALUES IN (10,11,12,13) ENGINE = InnoDB,
  SUBPARTITION sp87 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp88 VALUES IN (738156) ENGINE = InnoDB,
  SUBPARTITION sp89 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p34 VALUES LESS THAN (9223372036854775807)
 (SUBPARTITION sp1 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table h_l_ntp2;
Table,Create Table
h_l_ntp2,CREATE TABLE `h_l_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY HASH(`a`,`b`)
SUBPARTITION BY LIST(TO_DAYS(`c`))
(PARTITION p5 VALUES LESS THAN (-7686143364045646505)
 (SUBPARTITION sp8 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202)
 (SUBPARTITION sp10 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899)
 (SUBPARTITION sp12 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p72 VALUES LESS THAN (-3074457345618258599)
 (SUBPARTITION sp75 VALUES IN (1,2,3,4,5,6) ENGINE = InnoDB,
  SUBPARTITION sp76 VALUES IN (10,11,12,13) ENGINE = InnoDB,
  SUBPARTITION sp77 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp78 VALUES IN (738156) ENGINE = InnoDB,
  SUBPARTITION sp79 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p73 VALUES LESS THAN (-1537228672809129299)
 (SUBPARTITION sp80 VALUES IN (1,2,3,4,5,6) ENGINE = InnoDB,
  SUBPARTITION sp81 VALUES IN (10,11,12,13) ENGINE = InnoDB,
  SUBPARTITION sp82 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp83 VALUES IN (738156) ENGINE = InnoDB,
  SUBPARTITION sp84 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p74 VALUES LESS THAN (3)
 (SUBPARTITION sp85 VALUES IN (1,2,3,4,5,6) ENGINE = InnoDB,
  SUBPARTITION sp86 VALUES IN (10,11,12,13) ENGINE = InnoDB,
  SUBPARTITION sp87 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp88 VALUES IN (738156) ENGINE = InnoDB,
  SUBPARTITION sp89 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p34 VALUES LESS THAN (9223372036854775807)
 (SUBPARTITION sp1 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table h_l_ntp1;
drop table h_l_ntp2;
## h_lc_tp
create table if not exists h_lc_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by hash (a,b) partitions 4
subpartition by list columns (c,d)
(
partition p1
(
subpartition p1sp1 values in ( ('2020-01-01', 'abc') ),
subpartition p1sp2 values in ( default )
),
partition p2
(
subpartition p2sp1 values in ( ('2020-01-01', 'abc') ),
subpartition p2sp2 values in ( ('2021-01-01', 'abc') ),
subpartition p2sp3 values in ( default )
),
partition p3
(
subpartition p3sp1 values in ( ('2020-01-01', 'abc') ),
subpartition p3sp2 values in ( default )
),
partition p4
(
subpartition p4sp1 values in ( ('2020-01-01', 'abc') ),
subpartition p4sp2 values in ( default )
)
);
create table if not exists h_lc_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by hash (a,b) partitions 4
subpartition by list columns (c,d)
(
partition p1
(
subpartition p1sp1 values in ( ('2020-01-01', 'abc') ),
subpartition p1sp2 values in ( default )
),
partition p2
(
subpartition p2sp1 values in ( ('2020-01-01', 'abc') ),
subpartition p2sp2 values in ( ('2021-01-01', 'abc') ),
subpartition p2sp3 values in ( default )
),
partition p3
(
subpartition p3sp1 values in ( ('2020-01-01', 'abc') ),
subpartition p3sp2 values in ( default )
),
partition p4
(
subpartition p4sp1 values in ( ('2020-01-01', 'abc') ),
subpartition p4sp2 values in ( default )
)
);
alter table h_lc_ntp1 split partition p1 into partitions 3;
alter table h_lc_ntp2 split partition p1 into partitions 3;
alter table h_lc_ntp1 split subpartition p2sp3 into (subpartition p2sp30 values in(('2021-01-01', 'bc'), ('2022-01-01', 'abc')), subpartition p2sp31 values in(('2021-01-02', 'abc'))， subpartition p2sp32 values in ( default ));
alter table h_lc_ntp2 split subpartition p2sp3 into (subpartition p2sp30 values in(('2021-01-01', 'bc'), ('2022-01-01', 'abc')), subpartition p2sp31 values in(('2021-01-02', 'abc'))， subpartition p2sp32 values in ( default ));
alter table h_lc_ntp1 merge partitions p3,p4 to p34;
alter table h_lc_ntp2 merge partitions p3,p4 to p34;
alter table h_lc_ntp1 merge subpartitions p2sp30,p2sp31 to p2sp3;
alter table h_lc_ntp2 merge subpartitions p2sp30,p2sp31 to p2sp3;
alter table h_lc_ntp1 set tablegroup=my_ntp_tg_1;
alter table h_lc_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p2sp32 into (subpartition p2sp320 values in(('2021-11-01', 'abc'), ('2022-10-01', 'abc')),subpartition p2sp321 values in(('2022-10-01', 'abce')),subpartition p2sp322 values in ( default ));
alter tablegroup my_ntp_tg_1 merge subpartitions p2sp320,p2sp321 to p2sp32;
alter tablegroup my_ntp_tg_1 split partition p2 into partitions 3;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table h_lc_ntp1;
Table,Create Table
h_lc_ntp1,CREATE TABLE `h_lc_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY HASH(`a`,`b`)
SUBPARTITION BY LIST COLUMNS(`c`,`d`)
(PARTITION p5 VALUES LESS THAN (-7686143364045646505)
 (SUBPARTITION sp8 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202)
 (SUBPARTITION sp10 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899)
 (SUBPARTITION sp12 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p91 VALUES LESS THAN (-3074457345618258599)
 (SUBPARTITION sp94 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp95 VALUES IN (('2021-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp96 VALUES IN (('2021-01-01 00:00:00','bc'),('2021-01-02 00:00:00','abc'),('2022-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp97 VALUES IN (('2021-11-01 00:00:00','abc'),('2022-10-01 00:00:00','abc'),('2022-10-01 00:00:00','abce')) ENGINE = InnoDB,
  SUBPARTITION sp98 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p92 VALUES LESS THAN (-1537228672809129299)
 (SUBPARTITION sp99 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp100 VALUES IN (('2021-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp101 VALUES IN (('2021-01-01 00:00:00','bc'),('2021-01-02 00:00:00','abc'),('2022-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp102 VALUES IN (('2021-11-01 00:00:00','abc'),('2022-10-01 00:00:00','abc'),('2022-10-01 00:00:00','abce')) ENGINE = InnoDB,
  SUBPARTITION sp103 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p93 VALUES LESS THAN (3)
 (SUBPARTITION sp104 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp105 VALUES IN (('2021-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp106 VALUES IN (('2021-01-01 00:00:00','bc'),('2021-01-02 00:00:00','abc'),('2022-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp107 VALUES IN (('2021-11-01 00:00:00','abc'),('2022-10-01 00:00:00','abc'),('2022-10-01 00:00:00','abce')) ENGINE = InnoDB,
  SUBPARTITION sp108 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p34 VALUES LESS THAN (9223372036854775807)
 (SUBPARTITION sp1 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table h_lc_ntp2;
Table,Create Table
h_lc_ntp2,CREATE TABLE `h_lc_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY HASH(`a`,`b`)
SUBPARTITION BY LIST COLUMNS(`c`,`d`)
(PARTITION p5 VALUES LESS THAN (-7686143364045646505)
 (SUBPARTITION sp8 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202)
 (SUBPARTITION sp10 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899)
 (SUBPARTITION sp12 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p91 VALUES LESS THAN (-3074457345618258599)
 (SUBPARTITION sp94 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp95 VALUES IN (('2021-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp96 VALUES IN (('2021-01-01 00:00:00','bc'),('2021-01-02 00:00:00','abc'),('2022-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp97 VALUES IN (('2021-11-01 00:00:00','abc'),('2022-10-01 00:00:00','abc'),('2022-10-01 00:00:00','abce')) ENGINE = InnoDB,
  SUBPARTITION sp98 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p92 VALUES LESS THAN (-1537228672809129299)
 (SUBPARTITION sp99 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp100 VALUES IN (('2021-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp101 VALUES IN (('2021-01-01 00:00:00','bc'),('2021-01-02 00:00:00','abc'),('2022-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp102 VALUES IN (('2021-11-01 00:00:00','abc'),('2022-10-01 00:00:00','abc'),('2022-10-01 00:00:00','abce')) ENGINE = InnoDB,
  SUBPARTITION sp103 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p93 VALUES LESS THAN (3)
 (SUBPARTITION sp104 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp105 VALUES IN (('2021-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp106 VALUES IN (('2021-01-01 00:00:00','bc'),('2021-01-02 00:00:00','abc'),('2022-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp107 VALUES IN (('2021-11-01 00:00:00','abc'),('2022-10-01 00:00:00','abc'),('2022-10-01 00:00:00','abce')) ENGINE = InnoDB,
  SUBPARTITION sp108 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p34 VALUES LESS THAN (9223372036854775807)
 (SUBPARTITION sp1 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table h_lc_ntp1;
drop table h_lc_ntp2;
#########
  ## k_h_ntp
create table if not exists k_h_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by key (c,d) partitions 4
subpartition by hash (a,b)
(
partition p1 subpartitions 2,
partition p2 subpartitions 4,
partition p3 subpartitions 3,
partition p4 subpartitions 1
);
create table if not exists k_h_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by key (c,d) partitions 4
subpartition by hash (a,b)
(
partition p1 subpartitions 2,
partition p2 subpartitions 4,
partition p3 subpartitions 3,
partition p4 subpartitions 1
);
alter table k_h_ntp1 split partition p1 into partitions 3;
alter table k_h_ntp2 split partition p1 into partitions 3;
alter table k_h_ntp1 split subpartition p2sp1 into subpartitions 2;
alter table k_h_ntp2 split subpartition p2sp1 into subpartitions 2;
alter table k_h_ntp1 merge partitions p3,p4 to p34;
alter table k_h_ntp2 merge partitions p3,p4 to p34;
alter table k_h_ntp1 merge subpartitions p2sp3,p2sp4 to p2sp34;
alter table k_h_ntp2 merge subpartitions p2sp3,p2sp4 to p2sp34;
alter table k_h_ntp1 set tablegroup=my_ntp_tg_1;
alter table k_h_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 merge subpartitions p2sp2,p2sp34 to p2sp234;
alter tablegroup my_ntp_tg_1 split subpartition p2sp234 into subpartitions 3;
alter tablegroup my_ntp_tg_1 merge partitions p2,p34 to p234;
alter tablegroup my_ntp_tg_1 split partition p234 into partitions 3;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table k_h_ntp1;
Table,Create Table
k_h_ntp1,CREATE TABLE `k_h_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`c`,`d`)
SUBPARTITION BY HASH(`a`,`b`)
(PARTITION p5 VALUES LESS THAN (-7686143364045646505,9223372036854775807)
 (SUBPARTITION sp8 VALUES LESS THAN (1) ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202,9223372036854775807)
 (SUBPARTITION sp10 VALUES LESS THAN (1) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899,9223372036854775807)
 (SUBPARTITION sp12 VALUES LESS THAN (1) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p113 VALUES LESS THAN (3,9223372036854775807)
 (SUBPARTITION sp116 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p114 VALUES LESS THAN (6148914691236517205,9223372036854775807)
 (SUBPARTITION sp117 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p115 VALUES LESS THAN (9223372036854775807,9223372036854775807)
 (SUBPARTITION sp118 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table k_h_ntp2;
Table,Create Table
k_h_ntp2,CREATE TABLE `k_h_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`c`,`d`)
SUBPARTITION BY HASH(`a`,`b`)
(PARTITION p5 VALUES LESS THAN (-7686143364045646505,9223372036854775807)
 (SUBPARTITION sp8 VALUES LESS THAN (1) ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202,9223372036854775807)
 (SUBPARTITION sp10 VALUES LESS THAN (1) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899,9223372036854775807)
 (SUBPARTITION sp12 VALUES LESS THAN (1) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p113 VALUES LESS THAN (3,9223372036854775807)
 (SUBPARTITION sp116 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p114 VALUES LESS THAN (6148914691236517205,9223372036854775807)
 (SUBPARTITION sp117 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p115 VALUES LESS THAN (9223372036854775807,9223372036854775807)
 (SUBPARTITION sp118 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table k_h_ntp1;
drop table k_h_ntp2;
## k_k_ntp
create table if not exists k_k_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by key (c,d) partitions 4
subpartition by key (a,b)
(
partition p1 subpartitions 2,
partition p2 subpartitions 4,
partition p3 subpartitions 3,
partition p4 subpartitions 1
);
create table if not exists k_k_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by key (c,d) partitions 4
subpartition by key (a,b)
(
partition p1 subpartitions 2,
partition p2 subpartitions 4,
partition p3 subpartitions 3,
partition p4 subpartitions 1
);
alter table k_k_ntp1 split partition p1 into partitions 3;
alter table k_k_ntp2 split partition p1 into partitions 3;
alter table k_k_ntp1 split subpartition p2sp1 into subpartitions 2;
alter table k_k_ntp2 split subpartition p2sp1 into subpartitions 2;
alter table k_k_ntp1 merge partitions p3,p4 to p34;
alter table k_k_ntp2 merge partitions p3,p4 to p34;
alter table k_k_ntp1 merge subpartitions p2sp3,p2sp4 to p2sp34;
alter table k_k_ntp2 merge subpartitions p2sp3,p2sp4 to p2sp34;
alter table k_k_ntp1 set tablegroup=my_ntp_tg_1;
alter table k_k_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 merge subpartitions p2sp2,p2sp34 to p2sp234;
alter tablegroup my_ntp_tg_1 split subpartition p2sp234 into subpartitions 3;
alter tablegroup my_ntp_tg_1 merge partitions p2,p34 to p234;
alter tablegroup my_ntp_tg_1 split partition p234 into partitions 3;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table k_k_ntp1;
Table,Create Table
k_k_ntp1,CREATE TABLE `k_k_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`c`,`d`)
SUBPARTITION BY KEY(`a`,`b`)
(PARTITION p5 VALUES LESS THAN (-7686143364045646505,9223372036854775807)
 (SUBPARTITION sp8 VALUES LESS THAN (1,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202,9223372036854775807)
 (SUBPARTITION sp10 VALUES LESS THAN (1,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899,9223372036854775807)
 (SUBPARTITION sp12 VALUES LESS THAN (1,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p123 VALUES LESS THAN (3,9223372036854775807)
 (SUBPARTITION sp126 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p124 VALUES LESS THAN (6148914691236517205,9223372036854775807)
 (SUBPARTITION sp127 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p125 VALUES LESS THAN (9223372036854775807,9223372036854775807)
 (SUBPARTITION sp128 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table k_k_ntp2;
Table,Create Table
k_k_ntp2,CREATE TABLE `k_k_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`c`,`d`)
SUBPARTITION BY KEY(`a`,`b`)
(PARTITION p5 VALUES LESS THAN (-7686143364045646505,9223372036854775807)
 (SUBPARTITION sp8 VALUES LESS THAN (1,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202,9223372036854775807)
 (SUBPARTITION sp10 VALUES LESS THAN (1,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899,9223372036854775807)
 (SUBPARTITION sp12 VALUES LESS THAN (1,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p123 VALUES LESS THAN (3,9223372036854775807)
 (SUBPARTITION sp126 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p124 VALUES LESS THAN (6148914691236517205,9223372036854775807)
 (SUBPARTITION sp127 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p125 VALUES LESS THAN (9223372036854775807,9223372036854775807)
 (SUBPARTITION sp128 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table k_k_ntp1;
drop table k_k_ntp2;
## k_r_ntp
create table if not exists k_r_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by key (a,b) partitions 4
subpartition by range (to_days(c))
(
partition p1
(
subpartition p1sp1 values less than ( to_days('2020-01-01') ),
subpartition p1sp2 values less than ( maxvalue )
),
partition p2
(
subpartition p2sp1 values less than ( to_days('2020-01-01') ),
subpartition p2sp2 values less than ( to_days('2021-01-01') ),
subpartition p2sp3 values less than ( to_days('2022-01-01') ),
subpartition p2sp4 values less than ( maxvalue )
),
partition p3
(
subpartition p3sp1 values less than ( to_days('2020-01-01') ),
subpartition p3sp2 values less than ( maxvalue )
),
partition p4
(
subpartition p4sp1 values less than ( to_days('2020-01-01') ),
subpartition p4sp2 values less than ( maxvalue )
)
);
create table if not exists k_r_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by key (a,b) partitions 4
subpartition by range (to_days(c))
(
partition p1
(
subpartition p1sp1 values less than ( to_days('2020-01-01') ),
subpartition p1sp2 values less than ( maxvalue )
),
partition p2
(
subpartition p2sp1 values less than ( to_days('2020-01-01') ),
subpartition p2sp2 values less than ( to_days('2021-01-01') ),
subpartition p2sp3 values less than ( to_days('2022-01-01') ),
subpartition p2sp4 values less than ( maxvalue )
),
partition p3
(
subpartition p3sp1 values less than ( to_days('2020-01-01') ),
subpartition p3sp2 values less than ( maxvalue )
),
partition p4
(
subpartition p4sp1 values less than ( to_days('2020-01-01') ),
subpartition p4sp2 values less than ( maxvalue )
)
);
alter table k_r_ntp1 split partition p1 into partitions 3;
alter table k_r_ntp2 split partition p1 into partitions 3;
alter table k_r_ntp1 split subpartition p3sp2 at(1000000) into (subpartition p3sp20,subpartition p3sp21);
alter table k_r_ntp2 split subpartition p3sp2 at(1000000) into (subpartition p3sp20,subpartition p3sp21);
alter table k_r_ntp1 merge subpartitions p3sp20,p3sp21 to p3sp2;
alter table k_r_ntp2 merge subpartitions p3sp20,p3sp21 to p3sp2;
alter table k_r_ntp1 merge partitions p3,p4 to p34;
alter table k_r_ntp2 merge partitions p3,p4 to p34;
alter table k_r_ntp1 set tablegroup=my_ntp_tg_1;
alter table k_r_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p2sp4 at(100000000) into (subpartition p2sp40,subpartition p2sp41);
alter tablegroup my_ntp_tg_1 merge subpartitions p2sp40,p2sp41 to p2sp4;
alter tablegroup my_ntp_tg_1 split partition p2 into px partitions 3;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table k_r_ntp1;
Table,Create Table
k_r_ntp1,CREATE TABLE `k_r_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`a`,`b`)
SUBPARTITION BY RANGE(TO_DAYS(`c`))
(PARTITION p5 VALUES LESS THAN (-7686143364045646505,9223372036854775807)
 (SUBPARTITION sp8 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202,9223372036854775807)
 (SUBPARTITION sp10 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899,9223372036854775807)
 (SUBPARTITION sp12 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION px1 VALUES LESS THAN (-3074457345618258599,9223372036854775807)
 (SUBPARTITION sp130 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp131 VALUES LESS THAN (738156) ENGINE = InnoDB,
  SUBPARTITION sp132 VALUES LESS THAN (738521) ENGINE = InnoDB,
  SUBPARTITION sp133 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION px2 VALUES LESS THAN (-1024819115206086199,9223372036854775807)
 (SUBPARTITION sp134 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp135 VALUES LESS THAN (738156) ENGINE = InnoDB,
  SUBPARTITION sp136 VALUES LESS THAN (738521) ENGINE = InnoDB,
  SUBPARTITION sp137 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION px3 VALUES LESS THAN (3,9223372036854775807)
 (SUBPARTITION sp138 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp139 VALUES LESS THAN (738156) ENGINE = InnoDB,
  SUBPARTITION sp140 VALUES LESS THAN (738521) ENGINE = InnoDB,
  SUBPARTITION sp141 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p34 VALUES LESS THAN (9223372036854775807,9223372036854775807)
 (SUBPARTITION sp1 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table k_r_ntp2;
Table,Create Table
k_r_ntp2,CREATE TABLE `k_r_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`a`,`b`)
SUBPARTITION BY RANGE(TO_DAYS(`c`))
(PARTITION p5 VALUES LESS THAN (-7686143364045646505,9223372036854775807)
 (SUBPARTITION sp8 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202,9223372036854775807)
 (SUBPARTITION sp10 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899,9223372036854775807)
 (SUBPARTITION sp12 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION px1 VALUES LESS THAN (-3074457345618258599,9223372036854775807)
 (SUBPARTITION sp130 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp131 VALUES LESS THAN (738156) ENGINE = InnoDB,
  SUBPARTITION sp132 VALUES LESS THAN (738521) ENGINE = InnoDB,
  SUBPARTITION sp133 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION px2 VALUES LESS THAN (-1024819115206086199,9223372036854775807)
 (SUBPARTITION sp134 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp135 VALUES LESS THAN (738156) ENGINE = InnoDB,
  SUBPARTITION sp136 VALUES LESS THAN (738521) ENGINE = InnoDB,
  SUBPARTITION sp137 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION px3 VALUES LESS THAN (3,9223372036854775807)
 (SUBPARTITION sp138 VALUES LESS THAN (737790) ENGINE = InnoDB,
  SUBPARTITION sp139 VALUES LESS THAN (738156) ENGINE = InnoDB,
  SUBPARTITION sp140 VALUES LESS THAN (738521) ENGINE = InnoDB,
  SUBPARTITION sp141 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p34 VALUES LESS THAN (9223372036854775807,9223372036854775807)
 (SUBPARTITION sp1 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table k_r_ntp1;
drop table k_r_ntp2;
## k_rc_ntp
create table if not exists k_rc_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by key (a,b) partitions 4
subpartition by range columns (c,d)
(
partition p1
(
subpartition p1sp1 values less than ( '2020-01-01', 'abc' ),
subpartition p1sp2 values less than ( maxvalue, maxvalue )
),
partition p2
(
subpartition p2sp1 values less than ( '2020-01-01', 'abc' ),
subpartition p2sp2 values less than ( '2021-01-01', 'abc' ),
subpartition p2sp3 values less than ( '2022-01-01', 'abc' ),
subpartition p2sp4 values less than ( maxvalue, maxvalue )
),
partition p3
(
subpartition p3sp1 values less than ( '2020-01-01', 'abc' ),
subpartition p3sp2 values less than ( maxvalue, maxvalue )
),
partition p4
(
subpartition p4sp1 values less than ( '2020-01-01', 'abc' ),
subpartition p4sp2 values less than ( maxvalue, maxvalue )
)
);
create table if not exists k_rc_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by key (a,b) partitions 4
subpartition by range columns (c,d)
(
partition p1
(
subpartition p1sp1 values less than ( '2020-01-01', 'abc' ),
subpartition p1sp2 values less than ( maxvalue, maxvalue )
),
partition p2
(
subpartition p2sp1 values less than ( '2020-01-01', 'abc' ),
subpartition p2sp2 values less than ( '2021-01-01', 'abc' ),
subpartition p2sp3 values less than ( '2022-01-01', 'abc' ),
subpartition p2sp4 values less than ( maxvalue, maxvalue )
),
partition p3
(
subpartition p3sp1 values less than ( '2020-01-01', 'abc' ),
subpartition p3sp2 values less than ( maxvalue, maxvalue )
),
partition p4
(
subpartition p4sp1 values less than ( '2020-01-01', 'abc' ),
subpartition p4sp2 values less than ( maxvalue, maxvalue )
)
);
alter table k_rc_ntp1 split partition p1 into partitions 3;
alter table k_rc_ntp2 split partition p1 into partitions 3;
alter table k_rc_ntp1 split subpartition p3sp2 into (subpartition p3sp20 values less than ( '2021-01-01', 'abc' ),subpartition p3sp21 values less than ( '2022-01-01', 'abc' ),subpartition p3sp22 values less than ( maxvalue, maxvalue ));
alter table k_rc_ntp2 split subpartition p3sp2 into (subpartition p3sp20 values less than ( '2021-01-01', 'abc' ),subpartition p3sp21 values less than ( '2022-01-01', 'abc' ),subpartition p3sp22 values less than ( maxvalue, maxvalue ));
alter table k_rc_ntp1 merge subpartitions p3sp20,p3sp21,p3sp22 to p3sp2;
alter table k_rc_ntp2 merge subpartitions p3sp20,p3sp21,p3sp22 to p3sp2;
alter table k_rc_ntp1 merge partitions p3,p4 to p34;
alter table k_rc_ntp2 merge partitions p3,p4 to p34;
alter table k_rc_ntp1 set tablegroup=my_ntp_tg_1;
alter table k_rc_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p2sp4 into (subpartition p2sp40 values less than ( '2023-01-01', 'abc' ),subpartition p2sp41 values less than ( maxvalue, maxvalue ));
alter tablegroup my_ntp_tg_1 merge subpartitions p2sp40,p2sp41 to p2sp4;
alter tablegroup my_ntp_tg_1 split partition p2 into px partitions 3;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table k_rc_ntp1;
Table,Create Table
k_rc_ntp1,CREATE TABLE `k_rc_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`a`,`b`)
SUBPARTITION BY RANGE COLUMNS(`c`,`d`)
(PARTITION p5 VALUES LESS THAN (-7686143364045646505,9223372036854775807)
 (SUBPARTITION sp8 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202,9223372036854775807)
 (SUBPARTITION sp10 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899,9223372036854775807)
 (SUBPARTITION sp12 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION px1 VALUES LESS THAN (-3074457345618258599,9223372036854775807)
 (SUBPARTITION sp143 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp144 VALUES LESS THAN ('2021-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp145 VALUES LESS THAN ('2022-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp146 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION px2 VALUES LESS THAN (-1024819115206086199,9223372036854775807)
 (SUBPARTITION sp147 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp148 VALUES LESS THAN ('2021-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp149 VALUES LESS THAN ('2022-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp150 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION px3 VALUES LESS THAN (3,9223372036854775807)
 (SUBPARTITION sp151 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp152 VALUES LESS THAN ('2021-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp153 VALUES LESS THAN ('2022-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp154 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p34 VALUES LESS THAN (9223372036854775807,9223372036854775807)
 (SUBPARTITION sp1 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table k_rc_ntp2;
Table,Create Table
k_rc_ntp2,CREATE TABLE `k_rc_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`a`,`b`)
SUBPARTITION BY RANGE COLUMNS(`c`,`d`)
(PARTITION p5 VALUES LESS THAN (-7686143364045646505,9223372036854775807)
 (SUBPARTITION sp8 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202,9223372036854775807)
 (SUBPARTITION sp10 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899,9223372036854775807)
 (SUBPARTITION sp12 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION px1 VALUES LESS THAN (-3074457345618258599,9223372036854775807)
 (SUBPARTITION sp143 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp144 VALUES LESS THAN ('2021-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp145 VALUES LESS THAN ('2022-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp146 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION px2 VALUES LESS THAN (-1024819115206086199,9223372036854775807)
 (SUBPARTITION sp147 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp148 VALUES LESS THAN ('2021-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp149 VALUES LESS THAN ('2022-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp150 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION px3 VALUES LESS THAN (3,9223372036854775807)
 (SUBPARTITION sp151 VALUES LESS THAN ('2020-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp152 VALUES LESS THAN ('2021-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp153 VALUES LESS THAN ('2022-01-01 00:00:00','abc') ENGINE = InnoDB,
  SUBPARTITION sp154 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p34 VALUES LESS THAN (9223372036854775807,9223372036854775807)
 (SUBPARTITION sp1 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table k_rc_ntp1;
drop table k_rc_ntp2;
## k_l_ntp
create table if not exists k_l_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by key (a,b) partitions 4
subpartition by list (to_days(c))
(
partition p1
(
subpartition p1sp1 values in ( to_days('2020-01-01') ),
subpartition p1sp2 values in ( default )
),
partition p2
(
subpartition p2sp1 values in ( to_days('2020-01-01') ),
subpartition p2sp2 values in ( to_days('2021-01-01') ),
subpartition p2sp3 values in ( default )
),
partition p3
(
subpartition p3sp1 values in ( to_days('2020-01-01') ),
subpartition p3sp2 values in ( default )
),
partition p4
(
subpartition p4sp1 values in ( to_days('2020-01-01') ),
subpartition p4sp2 values in ( default )
)
);
create table if not exists k_l_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by key (a,b) partitions 4
subpartition by list (to_days(c))
(
partition p1
(
subpartition p1sp1 values in ( to_days('2020-01-01') ),
subpartition p1sp2 values in ( default )
),
partition p2
(
subpartition p2sp1 values in ( to_days('2020-01-01') ),
subpartition p2sp2 values in ( to_days('2021-01-01') ),
subpartition p2sp3 values in ( default )
),
partition p3
(
subpartition p3sp1 values in ( to_days('2020-01-01') ),
subpartition p3sp2 values in ( default )
),
partition p4
(
subpartition p4sp1 values in ( to_days('2020-01-01') ),
subpartition p4sp2 values in ( default )
)
);
alter table k_l_ntp1 split partition p1 into partitions 3;
alter table k_l_ntp2 split partition p1 into partitions 3;
alter table k_l_ntp1 split subpartition p2sp3 into (subpartition p2sp30 values in(1,2,3,4), subpartition p2sp31 values in(5，6)， subpartition p2sp32 values in ( default ));
alter table k_l_ntp2 split subpartition p2sp3 into (subpartition p2sp30 values in(1,2,3,4), subpartition p2sp31 values in(5，6)， subpartition p2sp32 values in ( default ));
alter table k_l_ntp1 merge partitions p3,p4 to p34;
alter table k_l_ntp2 merge partitions p3,p4 to p34;
alter table k_l_ntp1 merge subpartitions p2sp30,p2sp31 to p2sp3;
alter table k_l_ntp2 merge subpartitions p2sp30,p2sp31 to p2sp3;
alter table k_l_ntp1 set tablegroup=my_ntp_tg_1;
alter table k_l_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p2sp32 into (subpartition p2sp320 values in(10,11),subpartition p2sp321 values in(12,13),subpartition p2sp322 values in ( default ));
alter tablegroup my_ntp_tg_1 merge subpartitions p2sp320,p2sp321 to p2sp32;
alter tablegroup my_ntp_tg_1 split partition p2 into partitions 3;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table k_l_ntp1;
Table,Create Table
k_l_ntp1,CREATE TABLE `k_l_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`a`,`b`)
SUBPARTITION BY LIST(TO_DAYS(`c`))
(PARTITION p5 VALUES LESS THAN (-7686143364045646505,9223372036854775807)
 (SUBPARTITION sp8 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202,9223372036854775807)
 (SUBPARTITION sp10 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899,9223372036854775807)
 (SUBPARTITION sp12 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p156 VALUES LESS THAN (-3074457345618258599,9223372036854775807)
 (SUBPARTITION sp159 VALUES IN (1,2,3,4,5,6) ENGINE = InnoDB,
  SUBPARTITION sp160 VALUES IN (10,11,12,13) ENGINE = InnoDB,
  SUBPARTITION sp161 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp162 VALUES IN (738156) ENGINE = InnoDB,
  SUBPARTITION sp163 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p157 VALUES LESS THAN (-1024819115206086199,9223372036854775807)
 (SUBPARTITION sp164 VALUES IN (1,2,3,4,5,6) ENGINE = InnoDB,
  SUBPARTITION sp165 VALUES IN (10,11,12,13) ENGINE = InnoDB,
  SUBPARTITION sp166 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp167 VALUES IN (738156) ENGINE = InnoDB,
  SUBPARTITION sp168 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p158 VALUES LESS THAN (3,9223372036854775807)
 (SUBPARTITION sp169 VALUES IN (1,2,3,4,5,6) ENGINE = InnoDB,
  SUBPARTITION sp170 VALUES IN (10,11,12,13) ENGINE = InnoDB,
  SUBPARTITION sp171 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp172 VALUES IN (738156) ENGINE = InnoDB,
  SUBPARTITION sp173 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p34 VALUES LESS THAN (9223372036854775807,9223372036854775807)
 (SUBPARTITION sp1 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table k_l_ntp2;
Table,Create Table
k_l_ntp2,CREATE TABLE `k_l_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`a`,`b`)
SUBPARTITION BY LIST(TO_DAYS(`c`))
(PARTITION p5 VALUES LESS THAN (-7686143364045646505,9223372036854775807)
 (SUBPARTITION sp8 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202,9223372036854775807)
 (SUBPARTITION sp10 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899,9223372036854775807)
 (SUBPARTITION sp12 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p156 VALUES LESS THAN (-3074457345618258599,9223372036854775807)
 (SUBPARTITION sp159 VALUES IN (1,2,3,4,5,6) ENGINE = InnoDB,
  SUBPARTITION sp160 VALUES IN (10,11,12,13) ENGINE = InnoDB,
  SUBPARTITION sp161 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp162 VALUES IN (738156) ENGINE = InnoDB,
  SUBPARTITION sp163 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p157 VALUES LESS THAN (-1024819115206086199,9223372036854775807)
 (SUBPARTITION sp164 VALUES IN (1,2,3,4,5,6) ENGINE = InnoDB,
  SUBPARTITION sp165 VALUES IN (10,11,12,13) ENGINE = InnoDB,
  SUBPARTITION sp166 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp167 VALUES IN (738156) ENGINE = InnoDB,
  SUBPARTITION sp168 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p158 VALUES LESS THAN (3,9223372036854775807)
 (SUBPARTITION sp169 VALUES IN (1,2,3,4,5,6) ENGINE = InnoDB,
  SUBPARTITION sp170 VALUES IN (10,11,12,13) ENGINE = InnoDB,
  SUBPARTITION sp171 VALUES IN (737790) ENGINE = InnoDB,
  SUBPARTITION sp172 VALUES IN (738156) ENGINE = InnoDB,
  SUBPARTITION sp173 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p34 VALUES LESS THAN (9223372036854775807,9223372036854775807)
 (SUBPARTITION sp1 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table k_l_ntp1;
drop table k_l_ntp2;
## k_lc_tp
create table if not exists k_lc_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by key (a,b) partitions 4
subpartition by list columns (c,d)
(
partition p1
(
subpartition p1sp1 values in ( ('2020-01-01', 'abc') ),
subpartition p1sp2 values in ( default )
),
partition p2
(
subpartition p2sp1 values in ( ('2020-01-01', 'abc') ),
subpartition p2sp2 values in ( ('2021-01-01', 'abc') ),
subpartition p2sp3 values in ( default )
),
partition p3
(
subpartition p3sp1 values in ( ('2020-01-01', 'abc') ),
subpartition p3sp2 values in ( default )
),
partition p4
(
subpartition p4sp1 values in ( ('2020-01-01', 'abc') ),
subpartition p4sp2 values in ( default )
)
);
create table if not exists k_lc_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by key (a,b) partitions 4
subpartition by list columns (c,d)
(
partition p1
(
subpartition p1sp1 values in ( ('2020-01-01', 'abc') ),
subpartition p1sp2 values in ( default )
),
partition p2
(
subpartition p2sp1 values in ( ('2020-01-01', 'abc') ),
subpartition p2sp2 values in ( ('2021-01-01', 'abc') ),
subpartition p2sp3 values in ( default )
),
partition p3
(
subpartition p3sp1 values in ( ('2020-01-01', 'abc') ),
subpartition p3sp2 values in ( default )
),
partition p4
(
subpartition p4sp1 values in ( ('2020-01-01', 'abc') ),
subpartition p4sp2 values in ( default )
)
);
alter table k_lc_ntp1 split partition p1 into partitions 3;
alter table k_lc_ntp2 split partition p1 into partitions 3;
alter table k_lc_ntp1 split subpartition p2sp3 into (subpartition p2sp30 values in(('2021-01-01', 'bc'), ('2022-01-01', 'abc')), subpartition p2sp31 values in(('2021-01-02', 'abc'))， subpartition p2sp32 values in ( default ));
alter table k_lc_ntp2 split subpartition p2sp3 into (subpartition p2sp30 values in(('2021-01-01', 'bc'), ('2022-01-01', 'abc')), subpartition p2sp31 values in(('2021-01-02', 'abc'))， subpartition p2sp32 values in ( default ));
alter table k_lc_ntp1 merge partitions p3,p4 to p34;
alter table k_lc_ntp2 merge partitions p3,p4 to p34;
alter table k_lc_ntp1 merge subpartitions p2sp30,p2sp31 to p2sp3;
alter table k_lc_ntp2 merge subpartitions p2sp30,p2sp31 to p2sp3;
alter table k_lc_ntp1 set tablegroup=my_ntp_tg_1;
alter table k_lc_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p2sp32 into (subpartition p2sp320 values in(('2021-11-01', 'abc'), ('2022-10-01', 'abc')),subpartition p2sp321 values in(('2022-10-01', 'abce')),subpartition p2sp322 values in ( default ));
alter tablegroup my_ntp_tg_1 merge subpartitions p2sp320,p2sp321 to p2sp32;
alter tablegroup my_ntp_tg_1 split partition p2 into partitions 3;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table k_lc_ntp1;
Table,Create Table
k_lc_ntp1,CREATE TABLE `k_lc_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`a`,`b`)
SUBPARTITION BY LIST COLUMNS(`c`,`d`)
(PARTITION p5 VALUES LESS THAN (-7686143364045646505,9223372036854775807)
 (SUBPARTITION sp8 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202,9223372036854775807)
 (SUBPARTITION sp10 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899,9223372036854775807)
 (SUBPARTITION sp12 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p175 VALUES LESS THAN (-3074457345618258599,9223372036854775807)
 (SUBPARTITION sp178 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp179 VALUES IN (('2021-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp180 VALUES IN (('2021-01-01 00:00:00','bc'),('2021-01-02 00:00:00','abc'),('2022-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp181 VALUES IN (('2021-11-01 00:00:00','abc'),('2022-10-01 00:00:00','abc'),('2022-10-01 00:00:00','abce')) ENGINE = InnoDB,
  SUBPARTITION sp182 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p176 VALUES LESS THAN (-1024819115206086199,9223372036854775807)
 (SUBPARTITION sp183 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp184 VALUES IN (('2021-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp185 VALUES IN (('2021-01-01 00:00:00','bc'),('2021-01-02 00:00:00','abc'),('2022-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp186 VALUES IN (('2021-11-01 00:00:00','abc'),('2022-10-01 00:00:00','abc'),('2022-10-01 00:00:00','abce')) ENGINE = InnoDB,
  SUBPARTITION sp187 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p177 VALUES LESS THAN (3,9223372036854775807)
 (SUBPARTITION sp188 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp189 VALUES IN (('2021-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp190 VALUES IN (('2021-01-01 00:00:00','bc'),('2021-01-02 00:00:00','abc'),('2022-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp191 VALUES IN (('2021-11-01 00:00:00','abc'),('2022-10-01 00:00:00','abc'),('2022-10-01 00:00:00','abce')) ENGINE = InnoDB,
  SUBPARTITION sp192 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p34 VALUES LESS THAN (9223372036854775807,9223372036854775807)
 (SUBPARTITION sp1 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table k_lc_ntp2;
Table,Create Table
k_lc_ntp2,CREATE TABLE `k_lc_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`a`,`b`)
SUBPARTITION BY LIST COLUMNS(`c`,`d`)
(PARTITION p5 VALUES LESS THAN (-7686143364045646505,9223372036854775807)
 (SUBPARTITION sp8 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp9 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p6 VALUES LESS THAN (-6148914691236517202,9223372036854775807)
 (SUBPARTITION sp10 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p7 VALUES LESS THAN (-4611686018427387899,9223372036854775807)
 (SUBPARTITION sp12 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p175 VALUES LESS THAN (-3074457345618258599,9223372036854775807)
 (SUBPARTITION sp178 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp179 VALUES IN (('2021-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp180 VALUES IN (('2021-01-01 00:00:00','bc'),('2021-01-02 00:00:00','abc'),('2022-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp181 VALUES IN (('2021-11-01 00:00:00','abc'),('2022-10-01 00:00:00','abc'),('2022-10-01 00:00:00','abce')) ENGINE = InnoDB,
  SUBPARTITION sp182 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p176 VALUES LESS THAN (-1024819115206086199,9223372036854775807)
 (SUBPARTITION sp183 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp184 VALUES IN (('2021-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp185 VALUES IN (('2021-01-01 00:00:00','bc'),('2021-01-02 00:00:00','abc'),('2022-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp186 VALUES IN (('2021-11-01 00:00:00','abc'),('2022-10-01 00:00:00','abc'),('2022-10-01 00:00:00','abce')) ENGINE = InnoDB,
  SUBPARTITION sp187 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p177 VALUES LESS THAN (3,9223372036854775807)
 (SUBPARTITION sp188 VALUES IN (('2020-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp189 VALUES IN (('2021-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp190 VALUES IN (('2021-01-01 00:00:00','bc'),('2021-01-02 00:00:00','abc'),('2022-01-01 00:00:00','abc')) ENGINE = InnoDB,
  SUBPARTITION sp191 VALUES IN (('2021-11-01 00:00:00','abc'),('2022-10-01 00:00:00','abc'),('2022-10-01 00:00:00','abce')) ENGINE = InnoDB,
  SUBPARTITION sp192 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p34 VALUES LESS THAN (9223372036854775807,9223372036854775807)
 (SUBPARTITION sp1 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table k_lc_ntp1;
drop table k_lc_ntp2;
#########
  ## r_h_ntp
create table if not exists r_h_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range (to_days(c))
subpartition by hash (a,b)
(
partition p1 values less than ( to_days('2020-01-01') ) subpartitions 4,
partition p2 values less than ( maxvalue ) subpartitions 3
);
create table if not exists r_h_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range (to_days(c))
subpartition by hash (a,b)
(
partition p1 values less than ( to_days('2020-01-01') ) subpartitions 4,
partition p2 values less than ( maxvalue ) subpartitions 3
);
alter table r_h_ntp1 split subpartition p2sp1 into pxx subpartitions 3;
alter table r_h_ntp2 split subpartition p2sp1 into pxx subpartitions 3;
alter table r_h_ntp1 split partition p2 at(1000000) into (partition p20,partition p21);
alter table r_h_ntp2 split partition p2 at(1000000) into (partition p20,partition p21);
alter table r_h_ntp1 merge subpartitions p1sp3,p1sp4 to p1sp34;
alter table r_h_ntp2 merge subpartitions p1sp3,p1sp4 to p1sp34;
alter table r_h_ntp1 merge partitions p20,p21 to p2;
alter table r_h_ntp2 merge partitions p20,p21 to p2;
alter table r_h_ntp1 set tablegroup=my_ntp_tg_1;
alter table r_h_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p1sp2 into subpartitions 2;
alter tablegroup my_ntp_tg_1 split partition p1 at(1000) into (partition p10,partition p11);
alter tablegroup my_ntp_tg_1 merge partitions p10,p11 to p1;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table r_h_ntp1;
Table,Create Table
r_h_ntp1,CREATE TABLE `r_h_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE(TO_DAYS(`c`))
SUBPARTITION BY HASH(`a`,`b`)
(PARTITION p1 VALUES LESS THAN (737790)
 (SUBPARTITION sp203 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p2 VALUES LESS THAN (MAXVALUE)
 (SUBPARTITION sp2 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table r_h_ntp2;
Table,Create Table
r_h_ntp2,CREATE TABLE `r_h_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE(TO_DAYS(`c`))
SUBPARTITION BY HASH(`a`,`b`)
(PARTITION p1 VALUES LESS THAN (737790)
 (SUBPARTITION sp203 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p2 VALUES LESS THAN (MAXVALUE)
 (SUBPARTITION sp2 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table r_h_ntp1;
drop table r_h_ntp2;
## r_k_ntp
create table if not exists r_k_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range (to_days(c))
subpartition by key (a,b)
(
partition p1 values less than ( to_days('2020-01-01') ) subpartitions 4,
partition p2 values less than ( maxvalue ) subpartitions 3
);
create table if not exists r_k_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range (to_days(c))
subpartition by key (a,b)
(
partition p1 values less than ( to_days('2020-01-01') ) subpartitions 4,
partition p2 values less than ( maxvalue ) subpartitions 3
);
alter table r_k_ntp1 split subpartition p2sp1 into pxx subpartitions 3;
alter table r_k_ntp2 split subpartition p2sp1 into pxx subpartitions 3;
alter table r_k_ntp1 split partition p2 at(1000000) into (partition p20,partition p21);
alter table r_k_ntp2 split partition p2 at(1000000) into (partition p20,partition p21);
alter table r_k_ntp1 merge subpartitions p1sp3,p1sp4 to p1sp34;
alter table r_k_ntp2 merge subpartitions p1sp3,p1sp4 to p1sp34;
alter table r_k_ntp1 merge partitions p20,p21 to p2;
alter table r_k_ntp2 merge partitions p20,p21 to p2;
alter table r_k_ntp1 set tablegroup=my_ntp_tg_1;
alter table r_k_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p1sp2 into xxm subpartitions 2;
alter tablegroup my_ntp_tg_1 split partition p1 at(1000) into (partition p10,partition p11);
alter tablegroup my_ntp_tg_1 merge partitions p10,p11 to p1;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table r_k_ntp1;
Table,Create Table
r_k_ntp1,CREATE TABLE `r_k_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE(TO_DAYS(`c`))
SUBPARTITION BY KEY(`a`,`b`)
(PARTITION p1 VALUES LESS THAN (737790)
 (SUBPARTITION sp212 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p2 VALUES LESS THAN (MAXVALUE)
 (SUBPARTITION sp2 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table r_k_ntp2;
Table,Create Table
r_k_ntp2,CREATE TABLE `r_k_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE(TO_DAYS(`c`))
SUBPARTITION BY KEY(`a`,`b`)
(PARTITION p1 VALUES LESS THAN (737790)
 (SUBPARTITION sp212 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p2 VALUES LESS THAN (MAXVALUE)
 (SUBPARTITION sp2 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table r_k_ntp1;
drop table r_k_ntp2;
## r_r_ntp
create table if not exists r_r_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range (to_days(c))
subpartition by range (a)
(
partition p1 values less than ( to_days('2020-01-01') )
(
subpartition p1sp1 values less than ( 1000 ),
subpartition p1sp2 values less than ( maxvalue )
),
partition p2 values less than ( maxvalue )
(
subpartition p2sp1 values less than ( 1000 ),
subpartition p2sp2 values less than ( 2000 ),
subpartition p2sp3 values less than ( maxvalue )
)
);
create table if not exists r_r_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range (to_days(c))
subpartition by range (a)
(
partition p1 values less than ( to_days('2020-01-01') )
(
subpartition p1sp1 values less than ( 1000 ),
subpartition p1sp2 values less than ( maxvalue )
),
partition p2 values less than ( maxvalue )
(
subpartition p2sp1 values less than ( 1000 ),
subpartition p2sp2 values less than ( 2000 ),
subpartition p2sp3 values less than ( maxvalue )
)
);
alter table r_r_ntp1 split subpartition p1sp1 at(600) into (subpartition p1sp10,subpartition p1sp11);
alter table r_r_ntp2 split subpartition p1sp1 at(600) into (subpartition p1sp10,subpartition p1sp11);
alter table r_r_ntp1 merge subpartitions p1sp10,p1sp11 to p1sp1;
alter table r_r_ntp2 merge subpartitions p1sp10,p1sp11 to p1sp1;
alter table r_r_ntp1 split partition p1 at(1000) into (partition p10,partition p11);
alter table r_r_ntp2 split partition p1 at(1000) into (partition p10,partition p11);
alter table r_r_ntp1 merge partitions p10,p11 to p1;
alter table r_r_ntp2 merge partitions p10,p11 to p1;
alter table r_r_ntp1 set tablegroup=my_ntp_tg_1;
alter table r_r_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p2sp2 at(1300) into (subpartition p2sp20,subpartition p2sp21);
alter tablegroup my_ntp_tg_1 merge subpartitions p2sp20,p2sp21 to p2sp2;
alter tablegroup my_ntp_tg_1 split partition p2 at(10000000) into (partition p20,partition p21);
alter tablegroup my_ntp_tg_1 merge partitions p20,p21 to p2;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table r_r_ntp1;
Table,Create Table
r_r_ntp1,CREATE TABLE `r_r_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a` USING BTREE (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE(TO_DAYS(`c`))
SUBPARTITION BY RANGE(`a`)
(PARTITION p1 VALUES LESS THAN (737790)
 (SUBPARTITION sp1 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p2 VALUES LESS THAN (MAXVALUE)
 (SUBPARTITION sp220 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table r_r_ntp2;
Table,Create Table
r_r_ntp2,CREATE TABLE `r_r_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a` USING BTREE (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE(TO_DAYS(`c`))
SUBPARTITION BY RANGE(`a`)
(PARTITION p1 VALUES LESS THAN (737790)
 (SUBPARTITION sp1 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p2 VALUES LESS THAN (MAXVALUE)
 (SUBPARTITION sp220 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table r_r_ntp1;
drop table r_r_ntp2;
## r_rc_ntp
create table if not exists r_rc_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range (to_days(c))
subpartition by range columns (a,b)
(
partition p1 values less than ( to_days('2020-01-01') ) (
subpartition p1sp1 values less than ( 1000, 10000),
subpartition p1sp2 values less than ( maxvalue, maxvalue )
),
partition p2 values less than ( to_days('2023-01-01') ) (
subpartition p2sp1 values less than ( 1000, 10000),
subpartition p2sp2 values less than ( 2000, 10000),
subpartition p2sp3 values less than ( maxvalue, maxvalue )
),
partition p3 values less than ( maxvalue ) (
subpartition p3sp1 values less than ( 1000, 10000),
subpartition p3sp2 values less than ( 2000, 10000),
subpartition p3sp3 values less than ( maxvalue, maxvalue )
)
);
create table if not exists r_rc_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range (to_days(c))
subpartition by range columns (a,b)
(
partition p1 values less than ( to_days('2020-01-01') ) (
subpartition p1sp1 values less than ( 1000, 10000),
subpartition p1sp2 values less than ( maxvalue, maxvalue )
),
partition p2 values less than ( to_days('2023-01-01') ) (
subpartition p2sp1 values less than ( 1000, 10000),
subpartition p2sp2 values less than ( 2000, 10000),
subpartition p2sp3 values less than ( maxvalue, maxvalue )
),
partition p3 values less than ( maxvalue ) (
subpartition p3sp1 values less than ( 1000, 10000),
subpartition p3sp2 values less than ( 2000, 10000),
subpartition p3sp3 values less than ( maxvalue, maxvalue )
)
);
alter table r_rc_ntp1 split subpartition p2sp1 into (
subpartition p2sp10 values less than ( 800, 8000),
subpartition p2sp11 values less than ( 1000, 8000),
subpartition p2sp12 values less than ( 1000, 10000)
);
alter table r_rc_ntp2 split subpartition p2sp1 into (
subpartition p2sp10 values less than ( 800, 8000),
subpartition p2sp11 values less than ( 1000, 8000),
subpartition p2sp12 values less than ( 1000, 10000)
);
alter table r_rc_ntp1 merge subpartitions p2sp2,p2sp3 to p2sp23;
alter table r_rc_ntp2 merge subpartitions p2sp3,p2sp2 to p2sp23;
alter table r_rc_ntp1 merge partitions p1,p2 to p12;
alter table r_rc_ntp2 merge partitions p1,p2 to p12;
alter table r_rc_ntp1 set tablegroup=my_ntp_tg_1;
alter table r_rc_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split partition p12 into (
partition p1 values less than ( to_days('2021-01-01') ),
partition p2 values less than ( to_days('2023-01-01') )
);
alter tablegroup my_ntp_tg_1 split subpartition p3sp1 into (
subpartition p3sp10 values less than ( 800, 8000),
subpartition p3sp11 values less than ( 1000, 8000),
subpartition p3sp12 values less than ( 1000, 10000)
);
alter tablegroup my_ntp_tg_1 merge partitions p1,p2 to p12;
alter tablegroup my_ntp_tg_1 merge subpartitions p3sp10,p3sp11,p3sp12 to p3sp1;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table r_rc_ntp1;
Table,Create Table
r_rc_ntp1,CREATE TABLE `r_rc_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE(TO_DAYS(`c`))
SUBPARTITION BY RANGE COLUMNS(`a`,`b`)
(PARTITION p12 VALUES LESS THAN (738886)
 (SUBPARTITION sp225 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p3 VALUES LESS THAN (MAXVALUE)
 (SUBPARTITION p3sp1 VALUES LESS THAN (1000,10000) ENGINE = InnoDB,
  SUBPARTITION p3sp2 VALUES LESS THAN (2000,10000) ENGINE = InnoDB,
  SUBPARTITION p3sp3 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table r_rc_ntp2;
Table,Create Table
r_rc_ntp2,CREATE TABLE `r_rc_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE(TO_DAYS(`c`))
SUBPARTITION BY RANGE COLUMNS(`a`,`b`)
(PARTITION p12 VALUES LESS THAN (738886)
 (SUBPARTITION sp225 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p3 VALUES LESS THAN (MAXVALUE)
 (SUBPARTITION p3sp1 VALUES LESS THAN (1000,10000) ENGINE = InnoDB,
  SUBPARTITION p3sp2 VALUES LESS THAN (2000,10000) ENGINE = InnoDB,
  SUBPARTITION p3sp3 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table r_rc_ntp1;
drop table r_rc_ntp2;
## r_l_ntp
create table if not exists r_l_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range (to_days(c))
subpartition by list (a)
(
partition p1 values less than ( to_days('2020-01-01') ) (
subpartition p1sp1 values in ( 1000, 2000),
subpartition p1sp2 values in ( default )
),
partition p2 values less than ( maxvalue ) (
subpartition p2sp1 values in ( 1000, 2000),
subpartition p2sp2 values in ( 3000, 4000),
subpartition p2sp3 values in ( default )
)
);
create table if not exists r_l_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range (to_days(c))
subpartition by list (a)
(
partition p1 values less than ( to_days('2020-01-01') ) (
subpartition p1sp1 values in ( 1000, 2000),
subpartition p1sp2 values in ( default )
),
partition p2 values less than ( maxvalue ) (
subpartition p2sp1 values in ( 1000, 2000),
subpartition p2sp2 values in ( 3000, 4000),
subpartition p2sp3 values in ( default )
)
);
alter table r_l_ntp1 split subpartition p1sp1 into (subpartition p1sp10 values in ( 1000),subpartition p1sp11 values in ( 2000));
alter table r_l_ntp2 split subpartition p1sp1 into (subpartition p1sp10 values in ( 1000),subpartition p1sp11 values in ( 2000));
alter table r_l_ntp1 merge subpartitions p1sp10,p1sp11 to p1sp1;
alter table r_l_ntp2 merge subpartitions p1sp10,p1sp11 to p1sp1;
alter table r_l_ntp1 split partition p1 at(1000) into (partition p10,partition p11);
alter table r_l_ntp2 split partition p1 at(1000) into (partition p10,partition p11);
alter table r_l_ntp1 merge partitions p10,p11 to p1;
alter table r_l_ntp2 merge partitions p10,p11 to p1;
alter table r_l_ntp1 set tablegroup=my_ntp_tg_1;
alter table r_l_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p2sp3 into (subpartition p2sp30 values in ( 100000),subpartition p2sp31 values in ( 200000),subpartition p2sp32 values in ( default));
alter tablegroup my_ntp_tg_1 merge subpartitions p2sp30,p2sp31 to p2sp3;
alter tablegroup my_ntp_tg_1 split partition p2 at(500000000) into (partition p20,partition p21);
alter tablegroup my_ntp_tg_1 merge partitions p20,p21 to p2;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table r_l_ntp1;
Table,Create Table
r_l_ntp1,CREATE TABLE `r_l_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a` USING BTREE (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE(TO_DAYS(`c`))
SUBPARTITION BY LIST(`a`)
(PARTITION p1 VALUES LESS THAN (737790)
 (SUBPARTITION sp1 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p2 VALUES LESS THAN (MAXVALUE)
 (SUBPARTITION sp236 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table r_l_ntp2;
Table,Create Table
r_l_ntp2,CREATE TABLE `r_l_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a` USING BTREE (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE(TO_DAYS(`c`))
SUBPARTITION BY LIST(`a`)
(PARTITION p1 VALUES LESS THAN (737790)
 (SUBPARTITION sp1 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p2 VALUES LESS THAN (MAXVALUE)
 (SUBPARTITION sp236 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table r_l_ntp1;
drop table r_l_ntp2;
## r_lc_ntp
create table if not exists r_lc_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range (to_days(c))
subpartition by list columns (a,b)
(
partition p1 values less than ( to_days('2020-01-01') ) (
subpartition p1sp1 values in ( (1000, 2000) ),
subpartition p1sp2 values in ( default )
),
partition p2 values less than ( maxvalue ) (
subpartition p2sp1 values in ( (1000, 2000) ),
subpartition p2sp2 values in ( (4000, 3000) ),
subpartition p2sp3 values in ( default )
)
);
create table if not exists r_lc_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range (to_days(c))
subpartition by list columns (a,b)
(
partition p1 values less than ( to_days('2020-01-01') ) (
subpartition p1sp1 values in ( (1000, 2000) ),
subpartition p1sp2 values in ( default )
),
partition p2 values less than ( maxvalue ) (
subpartition p2sp1 values in ( (1000, 2000) ),
subpartition p2sp2 values in ( (4000, 3000) ),
subpartition p2sp3 values in ( default )
)
);
alter table r_lc_ntp1 split subpartition p1sp2 into (subpartition p1sp20 values in ((1000,1000)),subpartition p1sp21 values in ((2000,1000)),subpartition p1sp22 values in ( default));
alter table r_lc_ntp2 split subpartition p1sp2 into (subpartition p1sp20 values in ((1000,1000)),subpartition p1sp21 values in ((2000,1000)),subpartition p1sp22 values in ( default));
alter table r_lc_ntp1 merge subpartitions p1sp20,p1sp21 to p1sp2;
alter table r_lc_ntp2 merge subpartitions p1sp20,p1sp21 to p1sp2;
alter table r_lc_ntp1 split partition p1 at(1000) into (partition p10,partition p11);
alter table r_lc_ntp2 split partition p1 at(1000) into (partition p10,partition p11);
alter table r_lc_ntp1 merge partitions p10,p11 to p1;
alter table r_lc_ntp2 merge partitions p10,p11 to p1;
alter table r_lc_ntp1 set tablegroup=my_ntp_tg_1;
alter table r_lc_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p2sp3 into (subpartition p2sp30 values in ((1000,1000)),subpartition p2sp31 values in ((2000,1000)), subpartition p2sp32 values in ( default));
alter tablegroup my_ntp_tg_1 merge subpartitions p2sp30,p2sp31 to p2sp3;
alter tablegroup my_ntp_tg_1 split partition p2 at(500000000) into (partition p20,partition p21);
alter tablegroup my_ntp_tg_1 merge partitions p20,p21 to p2;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table r_lc_ntp1;
Table,Create Table
r_lc_ntp1,CREATE TABLE `r_lc_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE(TO_DAYS(`c`))
SUBPARTITION BY LIST COLUMNS(`a`,`b`)
(PARTITION p1 VALUES LESS THAN (737790)
 (SUBPARTITION sp1 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p2 VALUES LESS THAN (MAXVALUE)
 (SUBPARTITION sp246 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table r_lc_ntp2;
Table,Create Table
r_lc_ntp2,CREATE TABLE `r_lc_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE(TO_DAYS(`c`))
SUBPARTITION BY LIST COLUMNS(`a`,`b`)
(PARTITION p1 VALUES LESS THAN (737790)
 (SUBPARTITION sp1 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p2 VALUES LESS THAN (MAXVALUE)
 (SUBPARTITION sp246 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table r_lc_ntp1;
drop table r_lc_ntp2;
#########
  ## rc_h_ntp
create table if not exists rc_h_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range columns (c,d)
subpartition by hash (a,b)
(
partition p1 values less than ( '2020-01-01','abc' ) subpartitions 2,
partition p2 values less than ( maxvalue, maxvalue ) subpartitions 3
);
create table if not exists rc_h_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range columns (c,d)
subpartition by hash (a,b)
(
partition p1 values less than ( '2020-01-01','abc' ) subpartitions 2,
partition p2 values less than ( maxvalue, maxvalue ) subpartitions 3
);
alter table rc_h_ntp1 split subpartition p1sp1 into subpartitions 3;
alter table rc_h_ntp2 split subpartition p1sp1 into subpartitions 3;
alter table rc_h_ntp1 split partition p1 into (partition p10 values less than('2020-01-01','aaa'), partition p11 values less than('2020-01-01','abc'));
alter table rc_h_ntp2 split partition p1 into (partition p10 values less than('2020-01-01','aaa'), partition p11 values less than('2020-01-01','abc'));
alter table rc_h_ntp1 merge subpartitions p2sp1,p2sp2 to p2sp12;
alter table rc_h_ntp2 merge subpartitions p2sp1,p2sp2 to p2sp12;
alter table rc_h_ntp1 merge partitions p10,p11 to p1;
alter table rc_h_ntp2 merge partitions p10,p11 to p1;
alter table rc_h_ntp1 set tablegroup=my_ntp_tg_1;
alter table rc_h_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p2sp3 into subpartitions 2;
alter tablegroup my_ntp_tg_1 split partition p1 into (partition p10 values less than('2020-01-01','aaa'), partition p11 values less than('2020-01-01','abc'));
alter tablegroup my_ntp_tg_1 merge partitions p10,p11 to p1;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table rc_h_ntp1;
Table,Create Table
rc_h_ntp1,CREATE TABLE `rc_h_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE COLUMNS(`c`,`d`)
SUBPARTITION BY HASH(`a`,`b`)
(PARTITION p1 VALUES LESS THAN ('2020-01-01 00:00:00','abc')
 (SUBPARTITION sp251 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p2 VALUES LESS THAN (MAXVALUE,MAXVALUE)
 (SUBPARTITION p2sp12 VALUES LESS THAN (3074457345618258603) ENGINE = InnoDB,
  SUBPARTITION sp247 VALUES LESS THAN (6148914691236517205) ENGINE = InnoDB,
  SUBPARTITION sp248 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table rc_h_ntp2;
Table,Create Table
rc_h_ntp2,CREATE TABLE `rc_h_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE COLUMNS(`c`,`d`)
SUBPARTITION BY HASH(`a`,`b`)
(PARTITION p1 VALUES LESS THAN ('2020-01-01 00:00:00','abc')
 (SUBPARTITION sp251 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p2 VALUES LESS THAN (MAXVALUE,MAXVALUE)
 (SUBPARTITION p2sp12 VALUES LESS THAN (3074457345618258603) ENGINE = InnoDB,
  SUBPARTITION sp247 VALUES LESS THAN (6148914691236517205) ENGINE = InnoDB,
  SUBPARTITION sp248 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table rc_h_ntp1;
drop table rc_h_ntp2;
## rc_k_ntp
create table if not exists rc_k_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range columns (c,d)
subpartition by key (a,b)
(
partition p1 values less than ( '2020-01-01','abc' ) subpartitions 2,
partition p2 values less than ( maxvalue, maxvalue ) subpartitions 3
);
create table if not exists rc_k_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range columns (c,d)
subpartition by key (a,b)
(
partition p1 values less than ( '2020-01-01','abc' ) subpartitions 2,
partition p2 values less than ( maxvalue, maxvalue ) subpartitions 3
);
alter table rc_k_ntp1 split subpartition p1sp1 into subpartitions 3;
alter table rc_k_ntp2 split subpartition p1sp1 into subpartitions 3;
alter table rc_k_ntp1 split partition p1 into (partition p10 values less than('2020-01-01','aaa'), partition p11 values less than('2020-01-01','abb'),partition p12 values less than('2020-01-01','abc'));
alter table rc_k_ntp2 split partition p1 into (partition p10 values less than('2020-01-01','aaa'), partition p11 values less than('2020-01-01','abb'),partition p12 values less than('2020-01-01','abc'));
alter table rc_k_ntp1 merge subpartitions p2sp1,p2sp2 to p2sp12;
alter table rc_k_ntp2 merge subpartitions p2sp1,p2sp2 to p2sp12;
alter table rc_k_ntp1 merge partitions p10,p11,p12 to p1;
alter table rc_k_ntp2 merge partitions p10,p11,p12 to p1;
alter table rc_k_ntp1 set tablegroup=my_ntp_tg_1;
alter table rc_k_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p2sp3 into subpartitions 2;
alter tablegroup my_ntp_tg_1 split partition p1 into (partition p10 values less than('2020-01-01','aaa'), partition p11 values less than('2020-01-01','abc'));
alter tablegroup my_ntp_tg_1 merge partitions p10,p11 to p1;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table rc_k_ntp1;
Table,Create Table
rc_k_ntp1,CREATE TABLE `rc_k_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE COLUMNS(`c`,`d`)
SUBPARTITION BY KEY(`a`,`b`)
(PARTITION p1 VALUES LESS THAN ('2020-01-01 00:00:00','abc')
 (SUBPARTITION sp256 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p2 VALUES LESS THAN (MAXVALUE,MAXVALUE)
 (SUBPARTITION p2sp12 VALUES LESS THAN (3074457345618258603,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp252 VALUES LESS THAN (6148914691236517205,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp253 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table rc_k_ntp2;
Table,Create Table
rc_k_ntp2,CREATE TABLE `rc_k_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE COLUMNS(`c`,`d`)
SUBPARTITION BY KEY(`a`,`b`)
(PARTITION p1 VALUES LESS THAN ('2020-01-01 00:00:00','abc')
 (SUBPARTITION sp256 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p2 VALUES LESS THAN (MAXVALUE,MAXVALUE)
 (SUBPARTITION p2sp12 VALUES LESS THAN (3074457345618258603,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp252 VALUES LESS THAN (6148914691236517205,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp253 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table rc_k_ntp1;
drop table rc_k_ntp2;
## rc_r_ntp
create table if not exists rc_r_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range columns (c,d)
subpartition by range (a)
(
partition p1 values less than ( '2020-01-01','abc' ) (
subpartition p1sp1 values less than ( 1000),
subpartition p1sp2 values less than ( maxvalue )
),
partition p2 values less than ( '2022-01-01','abc' ) (
subpartition p2sp1 values less than ( 1000),
subpartition p2sp2 values less than ( 2000),
subpartition p2sp3 values less than ( maxvalue )
),
partition p3 values less than ( maxvalue, maxvalue ) (
subpartition p3sp1 values less than ( 1000),
subpartition p3sp2 values less than ( 2000),
subpartition p3sp3 values less than ( maxvalue )
)
);
create table if not exists rc_r_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range columns (c,d)
subpartition by range (a)
(
partition p1 values less than ( '2020-01-01','abc' ) (
subpartition p1sp1 values less than ( 1000),
subpartition p1sp2 values less than ( maxvalue )
),
partition p2 values less than ( '2022-01-01','abc' ) (
subpartition p2sp1 values less than ( 1000),
subpartition p2sp2 values less than ( 2000),
subpartition p2sp3 values less than ( maxvalue )
),
partition p3 values less than ( maxvalue, maxvalue ) (
subpartition p3sp1 values less than ( 1000),
subpartition p3sp2 values less than ( 2000),
subpartition p3sp3 values less than ( maxvalue )
)
);
alter table rc_r_ntp1 merge partitions p1,p2 to p12;
alter table rc_r_ntp2 merge partitions p1,p2 to p12;
alter table rc_r_ntp1 merge subpartitions p3sp1,p3sp2 to p3sp12;
alter table rc_r_ntp2 merge subpartitions p3sp1,p3sp2 to p3sp12;
alter table rc_r_ntp1 set tablegroup=my_ntp_tg_1;
alter table rc_r_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p3sp12 into (
subpartition p3sp1 values less than ( 100 ),
subpartition p3sp2 values less than ( 200 ),
subpartition p3sp0 values less than ( 2000 )
);
alter tablegroup my_ntp_tg_1 split partition p12 into (
partition p1 values less than ( '2020-01-01','abc'),
partition p2 values less than ( '2022-01-01','abc' )
);
alter tablegroup my_ntp_tg_1 merge partitions p1,p2 to p12;
alter tablegroup my_ntp_tg_1 merge subpartitions p3sp1,p3sp2 to p3sp12;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table rc_r_ntp1;
Table,Create Table
rc_r_ntp1,CREATE TABLE `rc_r_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a` USING BTREE (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE COLUMNS(`c`,`d`)
SUBPARTITION BY RANGE(`a`)
(PARTITION p12 VALUES LESS THAN ('2022-01-01 00:00:00','abc')
 (SUBPARTITION sp259 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p3 VALUES LESS THAN (MAXVALUE,MAXVALUE)
 (SUBPARTITION p3sp12 VALUES LESS THAN (200) ENGINE = InnoDB,
  SUBPARTITION p3sp0 VALUES LESS THAN (2000) ENGINE = InnoDB,
  SUBPARTITION p3sp3 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table rc_r_ntp2;
Table,Create Table
rc_r_ntp2,CREATE TABLE `rc_r_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a` USING BTREE (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE COLUMNS(`c`,`d`)
SUBPARTITION BY RANGE(`a`)
(PARTITION p12 VALUES LESS THAN ('2022-01-01 00:00:00','abc')
 (SUBPARTITION sp259 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p3 VALUES LESS THAN (MAXVALUE,MAXVALUE)
 (SUBPARTITION p3sp12 VALUES LESS THAN (200) ENGINE = InnoDB,
  SUBPARTITION p3sp0 VALUES LESS THAN (2000) ENGINE = InnoDB,
  SUBPARTITION p3sp3 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table rc_r_ntp1;
drop table rc_r_ntp2;
## rc_rc_ntp
create table if not exists rc_rc_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range columns (c,d)
subpartition by range columns (a,b)
(
partition p1 values less than ( '2020-01-01','abc' ) (
subpartition p1sp1 values less than ( 1000, 2000),
subpartition p1sp2 values less than ( maxvalue, maxvalue )
),
partition p2 values less than ( '2023-01-01','abc' ) (
subpartition p2sp1 values less than ( 1000, 2000),
subpartition p2sp2 values less than ( 2000, 2000),
subpartition p2sp3 values less than ( maxvalue, maxvalue )
),
partition p3 values less than ( maxvalue, maxvalue ) (
subpartition p3sp1 values less than ( 1000, 2000),
subpartition p3sp2 values less than ( 2000, 2000),
subpartition p3sp3 values less than ( maxvalue, maxvalue )
)
);
create table if not exists rc_rc_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range columns (c,d)
subpartition by range columns (a,b)
(
partition p1 values less than ( '2020-01-01','abc' ) (
subpartition p1sp1 values less than ( 1000, 2000),
subpartition p1sp2 values less than ( maxvalue, maxvalue )
),
partition p2 values less than ( '2023-01-01','abc' ) (
subpartition p2sp1 values less than ( 1000, 2000),
subpartition p2sp2 values less than ( 2000, 2000),
subpartition p2sp3 values less than ( maxvalue, maxvalue )
),
partition p3 values less than ( maxvalue, maxvalue ) (
subpartition p3sp1 values less than ( 1000, 2000),
subpartition p3sp2 values less than ( 2000, 2000),
subpartition p3sp3 values less than ( maxvalue, maxvalue )
)
);
alter table rc_rc_ntp1 merge subpartitions p1sp1,p1sp2 to p1sp12;
alter table rc_rc_ntp2 merge subpartitions p1sp1,p1sp2 to p1sp12;
alter table rc_rc_ntp1 split subpartition p2sp2 into (
subpartition p2sp20 values less than ( 1300, 2000 ),
subpartition p2sp21 values less than ( 2000, 2000 )
);
alter table rc_rc_ntp2 split subpartition p2sp2 into (
subpartition p2sp20 values less than ( 1300, 2000 ),
subpartition p2sp21 values less than ( 2000, 2000 )
);
alter table rc_rc_ntp1 merge partitions p1,p2 to p12;
alter table rc_rc_ntp2 merge partitions p1,p2 to p12;
alter table rc_rc_ntp1 set tablegroup=my_ntp_tg_1;
alter table rc_rc_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p3sp3 into (
subpartition p3sp30 values less than ( 3000, 2000 ),
subpartition p3sp31 values less than ( maxvalue,maxvalue )
);
alter tablegroup my_ntp_tg_1 split partition p12 into (
partition p1 values less than ( '2021-01-01','abc'),
partition p2 values less than ( '2023-01-01','abc' )
);
alter tablegroup my_ntp_tg_1 merge partitions p1,p2 to p12;
alter tablegroup my_ntp_tg_1 merge subpartitions p3sp1,p3sp2 to p3sp12;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table rc_rc_ntp1;
Table,Create Table
rc_rc_ntp1,CREATE TABLE `rc_rc_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE COLUMNS(`c`,`d`)
SUBPARTITION BY RANGE COLUMNS(`a`,`b`)
(PARTITION p12 VALUES LESS THAN ('2023-01-01 00:00:00','abc')
 (SUBPARTITION sp263 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p3 VALUES LESS THAN (MAXVALUE,MAXVALUE)
 (SUBPARTITION p3sp12 VALUES LESS THAN (2000,2000) ENGINE = InnoDB,
  SUBPARTITION p3sp30 VALUES LESS THAN (3000,2000) ENGINE = InnoDB,
  SUBPARTITION p3sp31 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table rc_rc_ntp2;
Table,Create Table
rc_rc_ntp2,CREATE TABLE `rc_rc_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE COLUMNS(`c`,`d`)
SUBPARTITION BY RANGE COLUMNS(`a`,`b`)
(PARTITION p12 VALUES LESS THAN ('2023-01-01 00:00:00','abc')
 (SUBPARTITION sp263 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p3 VALUES LESS THAN (MAXVALUE,MAXVALUE)
 (SUBPARTITION p3sp12 VALUES LESS THAN (2000,2000) ENGINE = InnoDB,
  SUBPARTITION p3sp30 VALUES LESS THAN (3000,2000) ENGINE = InnoDB,
  SUBPARTITION p3sp31 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table rc_rc_ntp1;
drop table rc_rc_ntp2;
## rc_l_ntp
create table if not exists rc_l_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range columns (c,d)
subpartition by list (a)
(
partition p1 values less than ( '2020-01-01','abc' ) (
subpartition p1sp1 values in ( 1000, 2000),
subpartition p1sp2 values in ( 3000 ),
subpartition p1sp3 values in ( default )
),
partition p2 values less than ( '2023-01-01','abc' ) (
subpartition p2sp1 values in ( 1000, 2000),
subpartition p2sp2 values in ( 3000, 4000, 5000),
subpartition p2sp3 values in ( default )
),
partition p3 values less than ( maxvalue, maxvalue ) (
subpartition p3sp1 values in ( 1000, 2000),
subpartition p3sp2 values in ( 3000, 4000, 5000),
subpartition p3sp3 values in ( default )
)
);
create table if not exists rc_l_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range columns (c,d)
subpartition by list (a)
(
partition p1 values less than ( '2020-01-01','abc' ) (
subpartition p1sp1 values in ( 1000, 2000),
subpartition p1sp2 values in ( 3000 ),
subpartition p1sp3 values in ( default )
),
partition p2 values less than ( '2023-01-01','abc' ) (
subpartition p2sp1 values in ( 1000, 2000),
subpartition p2sp2 values in ( 3000, 4000, 5000),
subpartition p2sp3 values in ( default )
),
partition p3 values less than ( maxvalue, maxvalue ) (
subpartition p3sp1 values in ( 1000, 2000),
subpartition p3sp2 values in ( 3000, 4000, 5000),
subpartition p3sp3 values in ( default )
)
);
alter table rc_l_ntp1 merge subpartitions p1sp1,p1sp2 to p1sp12;
alter table rc_l_ntp2 merge subpartitions p1sp1,p1sp2 to p1sp12;
alter table rc_l_ntp1 split subpartition p2sp2 into (
subpartition p2sp20 values in ( 3000),
subpartition p2sp21 values in ( 4000),
subpartition p2sp22 values in ( 5000)
);
alter table rc_l_ntp2 split subpartition p2sp2 into (
subpartition p2sp20 values in ( 3000),
subpartition p2sp21 values in ( 4000),
subpartition p2sp22 values in ( 5000)
);
alter table rc_l_ntp1 merge partitions p1,p2 to p12;
alter table rc_l_ntp2 merge partitions p1,p2 to p12;
alter table rc_l_ntp1 set tablegroup=my_ntp_tg_1;
alter table rc_l_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p3sp2 into (
subpartition p3sp20 values in ( 5000),
subpartition p3sp21 values in ( 3000, 4000 )
);
alter tablegroup my_ntp_tg_1 split partition p12 into (
partition p1 values less than ( '2020-01-01','abc'),
partition p2 values less than ( '2023-01-01','abc' )
);
alter tablegroup my_ntp_tg_1 merge partitions p1,p2 to p12;
alter tablegroup my_ntp_tg_1 merge subpartitions p3sp20,p3sp21 to p3sp2;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table rc_l_ntp1;
Table,Create Table
rc_l_ntp1,CREATE TABLE `rc_l_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a` USING BTREE (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE COLUMNS(`c`,`d`)
SUBPARTITION BY LIST(`a`)
(PARTITION p12 VALUES LESS THAN ('2023-01-01 00:00:00','abc')
 (SUBPARTITION sp267 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p3 VALUES LESS THAN (MAXVALUE,MAXVALUE)
 (SUBPARTITION p3sp1 VALUES IN (1000,2000) ENGINE = InnoDB,
  SUBPARTITION p3sp2 VALUES IN (3000,4000,5000) ENGINE = InnoDB,
  SUBPARTITION p3sp3 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table rc_l_ntp2;
Table,Create Table
rc_l_ntp2,CREATE TABLE `rc_l_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a` USING BTREE (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE COLUMNS(`c`,`d`)
SUBPARTITION BY LIST(`a`)
(PARTITION p12 VALUES LESS THAN ('2023-01-01 00:00:00','abc')
 (SUBPARTITION sp267 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p3 VALUES LESS THAN (MAXVALUE,MAXVALUE)
 (SUBPARTITION p3sp1 VALUES IN (1000,2000) ENGINE = InnoDB,
  SUBPARTITION p3sp2 VALUES IN (3000,4000,5000) ENGINE = InnoDB,
  SUBPARTITION p3sp3 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table rc_l_ntp1;
drop table rc_l_ntp2;
## rc_lc_ntp
create table if not exists rc_lc_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range columns (c,d)
subpartition by list columns (a,b)
(
partition p1 values less than ( '2020-01-01','abc' ) (
subpartition p1sp1 values in ( (1000, 2000)),
subpartition p1sp2 values in ( (2000, 2000)),
subpartition p1sp3 values in ( default )
),
partition p2 values less than ( '2024-01-01','abc' ) (
subpartition p2sp1 values in ( (1000, 2000)),
subpartition p2sp2 values in ( (2000, 2000)),
subpartition p2sp3 values in ( default )
),
partition p3 values less than ( maxvalue, maxvalue ) (
subpartition p3sp1 values in ( (1000, 2000)),
subpartition p3sp2 values in ( (2000, 2000),(4000, 2000)),
subpartition p3sp3 values in ( default )
)
);
create table if not exists rc_lc_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by range columns (c,d)
subpartition by list columns (a,b)
(
partition p1 values less than ( '2020-01-01','abc' ) (
subpartition p1sp1 values in ( (1000, 2000)),
subpartition p1sp2 values in ( (2000, 2000)),
subpartition p1sp3 values in ( default )
),
partition p2 values less than ( '2024-01-01','abc' ) (
subpartition p2sp1 values in ( (1000, 2000)),
subpartition p2sp2 values in ( (2000, 2000)),
subpartition p2sp3 values in ( default )
),
partition p3 values less than ( maxvalue, maxvalue ) (
subpartition p3sp1 values in ( (1000, 2000)),
subpartition p3sp2 values in ( (2000, 2000),(4000, 2000)),
subpartition p3sp3 values in ( default )
)
);
alter table rc_lc_ntp1 merge subpartitions p1sp1,p1sp2 to p1sp12;
alter table rc_lc_ntp2 merge subpartitions p1sp1,p1sp2 to p1sp12;
alter table rc_lc_ntp1 split subpartition p1sp3 into (
subpartition p1sp30 values in ( (3000, 2000)),
subpartition p1sp31 values in ( default)
);
alter table rc_lc_ntp1 merge partitions p1,p2 to p12;
alter table rc_lc_ntp2 merge partitions p1,p2 to p12;
alter table rc_lc_ntp1 set tablegroup=my_ntp_tg_1;
alter table rc_lc_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p3sp2 into (
subpartition p3sp21 values in ( (4000, 2000)),
subpartition p3sp22 values in ( (2000, 2000))
);
alter tablegroup my_ntp_tg_1 split partition p12 into (
partition p1 values less than ( '2020-01-01','abc'),
partition p2 values less than ( '2024-01-01','abc' )
);
alter tablegroup my_ntp_tg_1 merge partitions p1,p2 to p12;
alter tablegroup my_ntp_tg_1 merge subpartitions p3sp21,p3sp22 to p3sp2;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table rc_lc_ntp1;
Table,Create Table
rc_lc_ntp1,CREATE TABLE `rc_lc_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE COLUMNS(`c`,`d`)
SUBPARTITION BY LIST COLUMNS(`a`,`b`)
(PARTITION p12 VALUES LESS THAN ('2024-01-01 00:00:00','abc')
 (SUBPARTITION sp271 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p3 VALUES LESS THAN (MAXVALUE,MAXVALUE)
 (SUBPARTITION p3sp1 VALUES IN ((1000,2000)) ENGINE = InnoDB,
  SUBPARTITION p3sp2 VALUES IN ((2000,2000),(4000,2000)) ENGINE = InnoDB,
  SUBPARTITION p3sp3 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table rc_lc_ntp2;
Table,Create Table
rc_lc_ntp2,CREATE TABLE `rc_lc_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY RANGE COLUMNS(`c`,`d`)
SUBPARTITION BY LIST COLUMNS(`a`,`b`)
(PARTITION p12 VALUES LESS THAN ('2024-01-01 00:00:00','abc')
 (SUBPARTITION sp271 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p3 VALUES LESS THAN (MAXVALUE,MAXVALUE)
 (SUBPARTITION p3sp1 VALUES IN ((1000,2000)) ENGINE = InnoDB,
  SUBPARTITION p3sp2 VALUES IN ((2000,2000),(4000,2000)) ENGINE = InnoDB,
  SUBPARTITION p3sp3 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table rc_lc_ntp1;
drop table rc_lc_ntp2;
#########
  ## l_h_ntp
create table if not exists l_h_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list (to_days(c))
subpartition by hash (a,b)
(
partition p1 values in ( to_days('2020-01-01') ) subpartitions 3,
partition p2 values in ( to_days('2025-01-01') ) subpartitions 4,
partition p3 values in ( default ) subpartitions 3
);
create table if not exists l_h_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list (to_days(c))
subpartition by hash (a,b)
(
partition p1 values in ( to_days('2020-01-01') ) subpartitions 3,
partition p2 values in ( to_days('2025-01-01') ) subpartitions 4,
partition p3 values in ( default ) subpartitions 3
);
alter table l_h_ntp1 split subpartition p1sp1 into subpartitions 3;
alter table l_h_ntp2 split subpartition p1sp1 into subpartitions 3;
alter table l_h_ntp1 split partition p3 into (partition p30 values in(1,2,3,4),partition p31 values in(7,8),partition p32 values in ( default ));
alter table l_h_ntp2 split partition p3 into (partition p30 values in(1,2,3,4),partition p31 values in(7,8),partition p32 values in ( default ));
alter table l_h_ntp1 merge subpartitions p1sp2,p1sp3 to p1sp23;
alter table l_h_ntp2 merge subpartitions p1sp2,p1sp3 to p1sp23;
alter table l_h_ntp1 merge partitions p30,p31 to p3;
alter table l_h_ntp2 merge partitions p30,p31 to p3;
alter table l_h_ntp1 set tablegroup=my_ntp_tg_1;
alter table l_h_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p2sp1 into pxx subpartitions 4;
alter tablegroup my_ntp_tg_1 split partition p3 into (partition p30 values in(1,2,3,4),partition p31 values in(7,8));
alter tablegroup my_ntp_tg_1 merge partitions p30,p31 to p3;
alter tablegroup my_ntp_tg_1 merge subpartitions p2sp2,p2sp3,p2sp4 to p2sp234;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table l_h_ntp1;
Table,Create Table
l_h_ntp1,CREATE TABLE `l_h_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST(TO_DAYS(`c`))
SUBPARTITION BY HASH(`a`,`b`)
(PARTITION p3 VALUES IN (1,2,3,4,7,8)
 (SUBPARTITION sp275 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p1 VALUES IN (737790)
 (SUBPARTITION sp4 VALUES LESS THAN (-7173733806442603406) ENGINE = InnoDB,
  SUBPARTITION sp5 VALUES LESS THAN (-5124095576030431004) ENGINE = InnoDB,
  SUBPARTITION sp6 VALUES LESS THAN (-3074457345618258601) ENGINE = InnoDB,
  SUBPARTITION p1sp23 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p2 VALUES IN (739617)
 (SUBPARTITION pxx1 VALUES LESS THAN (-8070450532247928831) ENGINE = InnoDB,
  SUBPARTITION pxx2 VALUES LESS THAN (-6917529027641081854) ENGINE = InnoDB,
  SUBPARTITION pxx3 VALUES LESS THAN (-5764607523034234877) ENGINE = InnoDB,
  SUBPARTITION pxx4 VALUES LESS THAN (-4611686018427387899) ENGINE = InnoDB,
  SUBPARTITION p2sp234 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p32 VALUES IN (DEFAULT)
 (SUBPARTITION sp13 VALUES LESS THAN (-3074457345618258601) ENGINE = InnoDB,
  SUBPARTITION sp14 VALUES LESS THAN (3074457345618258603) ENGINE = InnoDB,
  SUBPARTITION sp15 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table l_h_ntp2;
Table,Create Table
l_h_ntp2,CREATE TABLE `l_h_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST(TO_DAYS(`c`))
SUBPARTITION BY HASH(`a`,`b`)
(PARTITION p3 VALUES IN (1,2,3,4,7,8)
 (SUBPARTITION sp275 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p1 VALUES IN (737790)
 (SUBPARTITION sp4 VALUES LESS THAN (-7173733806442603406) ENGINE = InnoDB,
  SUBPARTITION sp5 VALUES LESS THAN (-5124095576030431004) ENGINE = InnoDB,
  SUBPARTITION sp6 VALUES LESS THAN (-3074457345618258601) ENGINE = InnoDB,
  SUBPARTITION p1sp23 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p2 VALUES IN (739617)
 (SUBPARTITION pxx1 VALUES LESS THAN (-8070450532247928831) ENGINE = InnoDB,
  SUBPARTITION pxx2 VALUES LESS THAN (-6917529027641081854) ENGINE = InnoDB,
  SUBPARTITION pxx3 VALUES LESS THAN (-5764607523034234877) ENGINE = InnoDB,
  SUBPARTITION pxx4 VALUES LESS THAN (-4611686018427387899) ENGINE = InnoDB,
  SUBPARTITION p2sp234 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p32 VALUES IN (DEFAULT)
 (SUBPARTITION sp13 VALUES LESS THAN (-3074457345618258601) ENGINE = InnoDB,
  SUBPARTITION sp14 VALUES LESS THAN (3074457345618258603) ENGINE = InnoDB,
  SUBPARTITION sp15 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table l_h_ntp1;
drop table l_h_ntp2;
## l_k_ntp
create table if not exists l_k_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list (to_days(c))
subpartition by key (a,b)
(
partition p1 values in ( to_days('2020-01-01') ) subpartitions 3,
partition p2 values in ( to_days('2025-01-01') ) subpartitions 4,
partition p3 values in ( default ) subpartitions 3
);
create table if not exists l_k_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list (to_days(c))
subpartition by key (a,b)
(
partition p1 values in ( to_days('2020-01-01') ) subpartitions 3,
partition p2 values in ( to_days('2025-01-01') ) subpartitions 4,
partition p3 values in ( default ) subpartitions 3
);
alter table l_k_ntp1 split subpartition p1sp1 into subpartitions 3;
alter table l_k_ntp2 split subpartition p1sp1 into subpartitions 3;
alter table l_k_ntp1 split partition p3 into (partition p30 values in(1,2,3,4),partition p31 values in(7,8),partition p32 values in ( default ));
alter table l_k_ntp2 split partition p3 into (partition p30 values in(1,2,3,4),partition p31 values in(7,8),partition p32 values in ( default ));
alter table l_k_ntp1 merge subpartitions p1sp2,p1sp3 to p1sp23;
alter table l_k_ntp2 merge subpartitions p1sp2,p1sp3 to p1sp23;
alter table l_k_ntp1 merge partitions p30,p31 to p3;
alter table l_k_ntp2 merge partitions p30,p31 to p3;
alter table l_k_ntp1 set tablegroup=my_ntp_tg_1;
alter table l_k_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p2sp1 into pxx subpartitions 4;
alter tablegroup my_ntp_tg_1 split partition p3 into (partition p30 values in(1,2,3,4),partition p31 values in(7,8));
alter tablegroup my_ntp_tg_1 merge partitions p30,p31 to p3;
alter tablegroup my_ntp_tg_1 merge subpartitions p2sp2,p2sp3,p2sp4 to p2sp234;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table l_k_ntp1;
Table,Create Table
l_k_ntp1,CREATE TABLE `l_k_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST(TO_DAYS(`c`))
SUBPARTITION BY KEY(`a`,`b`)
(PARTITION p3 VALUES IN (1,2,3,4,7,8)
 (SUBPARTITION sp279 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p1 VALUES IN (737790)
 (SUBPARTITION sp4 VALUES LESS THAN (-7173733806442603406,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp5 VALUES LESS THAN (-5124095576030431004,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp6 VALUES LESS THAN (-3074457345618258601,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION p1sp23 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p2 VALUES IN (739617)
 (SUBPARTITION pxx1 VALUES LESS THAN (-8070450532247928831,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION pxx2 VALUES LESS THAN (-6917529027641081854,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION pxx3 VALUES LESS THAN (-5764607523034234877,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION pxx4 VALUES LESS THAN (-4611686018427387899,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION p2sp234 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p32 VALUES IN (DEFAULT)
 (SUBPARTITION sp13 VALUES LESS THAN (-3074457345618258601,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp14 VALUES LESS THAN (3074457345618258603,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp15 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table l_k_ntp2;
Table,Create Table
l_k_ntp2,CREATE TABLE `l_k_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST(TO_DAYS(`c`))
SUBPARTITION BY KEY(`a`,`b`)
(PARTITION p3 VALUES IN (1,2,3,4,7,8)
 (SUBPARTITION sp279 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p1 VALUES IN (737790)
 (SUBPARTITION sp4 VALUES LESS THAN (-7173733806442603406,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp5 VALUES LESS THAN (-5124095576030431004,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp6 VALUES LESS THAN (-3074457345618258601,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION p1sp23 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p2 VALUES IN (739617)
 (SUBPARTITION pxx1 VALUES LESS THAN (-8070450532247928831,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION pxx2 VALUES LESS THAN (-6917529027641081854,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION pxx3 VALUES LESS THAN (-5764607523034234877,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION pxx4 VALUES LESS THAN (-4611686018427387899,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION p2sp234 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p32 VALUES IN (DEFAULT)
 (SUBPARTITION sp13 VALUES LESS THAN (-3074457345618258601,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp14 VALUES LESS THAN (3074457345618258603,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp15 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table l_k_ntp1;
drop table l_k_ntp2;
## l_r_ntp
create table if not exists l_r_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list (to_days(c))
subpartition by range (a)
(
partition p1 values in ( to_days('2020-01-01') ) (
subpartition p1sp1 values less than ( 1000),
subpartition p1sp2 values less than ( maxvalue )
),
partition p2 values in ( default ) (
subpartition p2sp1 values less than ( 1000),
subpartition p2sp2 values less than ( 2000),
subpartition p2sp3 values less than ( maxvalue )
)
);
create table if not exists l_r_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list (to_days(c))
subpartition by range (a)
(
partition p1 values in ( to_days('2020-01-01') ) (
subpartition p1sp1 values less than ( 1000),
subpartition p1sp2 values less than ( maxvalue )
),
partition p2 values in ( default ) (
subpartition p2sp1 values less than ( 1000),
subpartition p2sp2 values less than ( 2000),
subpartition p2sp3 values less than ( maxvalue )
)
);
alter table l_r_ntp1 split subpartition p1sp1 at(600) into (subpartition p1sp10,subpartition p1sp11);
alter table l_r_ntp2 split subpartition p1sp1 at(600) into (subpartition p1sp10,subpartition p1sp11);
alter table l_r_ntp1 split partition p2 into (partition p20 values in ( 1000000),partition p21 values in ( 3000000),partition p22 values in ( default));
alter table l_r_ntp2 split partition p2 into (partition p20 values in ( 1000000),partition p21 values in ( 3000000),partition p22 values in ( default));
alter table l_r_ntp1 merge partitions p20,p21 to p2;
alter table l_r_ntp2 merge partitions p20,p21 to p2;
alter table l_r_ntp1 merge subpartitions p1sp10,p1sp11 to p1sp1;
alter table l_r_ntp2 merge subpartitions p1sp10,p1sp11 to p1sp1;
alter table l_r_ntp1 set tablegroup=my_ntp_tg_1;
alter table l_r_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p1sp1 at(600) into (subpartition p1sp10,subpartition p1sp11);
alter tablegroup my_ntp_tg_1 split partition p2 into (partition p20 values in ( 1000000),partition p21 values in ( 3000000));
alter tablegroup my_ntp_tg_1 merge partitions p20,p21 to p2;
alter tablegroup my_ntp_tg_1 merge subpartitions p1sp10,p1sp11 to p1sp1;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table l_r_ntp1;
Table,Create Table
l_r_ntp1,CREATE TABLE `l_r_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a` USING BTREE (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST(TO_DAYS(`c`))
SUBPARTITION BY RANGE(`a`)
(PARTITION p1 VALUES IN (737790)
 (SUBPARTITION p1sp1 VALUES LESS THAN (1000) ENGINE = InnoDB,
  SUBPARTITION p1sp2 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p2 VALUES IN (1000000,3000000)
 (SUBPARTITION sp283 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p22 VALUES IN (DEFAULT)
 (SUBPARTITION sp9 VALUES LESS THAN (1000) ENGINE = InnoDB,
  SUBPARTITION sp10 VALUES LESS THAN (2000) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table l_r_ntp2;
Table,Create Table
l_r_ntp2,CREATE TABLE `l_r_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a` USING BTREE (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST(TO_DAYS(`c`))
SUBPARTITION BY RANGE(`a`)
(PARTITION p1 VALUES IN (737790)
 (SUBPARTITION p1sp1 VALUES LESS THAN (1000) ENGINE = InnoDB,
  SUBPARTITION p1sp2 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p2 VALUES IN (1000000,3000000)
 (SUBPARTITION sp283 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p22 VALUES IN (DEFAULT)
 (SUBPARTITION sp9 VALUES LESS THAN (1000) ENGINE = InnoDB,
  SUBPARTITION sp10 VALUES LESS THAN (2000) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table l_r_ntp1;
drop table l_r_ntp2;
## l_rc_ntp
create table if not exists l_rc_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list (to_days(c))
subpartition by range columns (a,b)
(
partition p1 values in ( to_days('2020-01-01') ) (
subpartition p1sp1 values less than ( 1000, 10000),
subpartition p1sp2 values less than ( maxvalue, maxvalue )
),
partition p2 values in ( default ) (
subpartition p2sp1 values less than ( 1000, 10000),
subpartition p2sp2 values less than ( 2000, 10000),
subpartition p2sp3 values less than ( maxvalue, maxvalue )
)
);
create table if not exists l_rc_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list (to_days(c))
subpartition by range columns (a,b)
(
partition p1 values in ( to_days('2020-01-01') ) (
subpartition p1sp1 values less than ( 1000, 10000),
subpartition p1sp2 values less than ( maxvalue, maxvalue )
),
partition p2 values in ( default ) (
subpartition p2sp1 values less than ( 1000, 10000),
subpartition p2sp2 values less than ( 2000, 10000),
subpartition p2sp3 values less than ( maxvalue, maxvalue )
)
);
alter table l_rc_ntp1 split subpartition p1sp1 into (subpartition p1sp10 values less than ( 100, 10000),subpartition p1sp11 values less than ( 1000, 10000));
alter table l_rc_ntp2 split subpartition p1sp1 into (subpartition p1sp10 values less than ( 100, 10000),subpartition p1sp11 values less than ( 1000, 10000));
alter table l_rc_ntp1 split partition p2 into (partition p20 values in ( 1000),partition p21 values in ( 11000),partition p22 values in ( default));
alter table l_rc_ntp2 split partition p2 into (partition p20 values in ( 1000),partition p21 values in ( 11000),partition p22 values in ( default));
alter table l_rc_ntp1 merge partitions p20,p21 to p2;
alter table l_rc_ntp2 merge partitions p20,p21 to p2;
alter table l_rc_ntp1 merge subpartitions p1sp10,p1sp11 to p1sp1;
alter table l_rc_ntp2 merge subpartitions p1sp10,p1sp11 to p1sp1;
alter table l_rc_ntp1 set tablegroup=my_ntp_tg_1;
alter table l_rc_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p1sp1 into (subpartition p1sp10 values less than ( 100, 10000),subpartition p1sp11 values less than ( 1000, 10000));
alter tablegroup my_ntp_tg_1 split partition p2 into (partition p20 values in ( 1000),partition p21 values in ( 11000));
alter tablegroup my_ntp_tg_1 merge partitions p20,p21 to p2;
alter tablegroup my_ntp_tg_1 merge subpartitions p1sp10,p1sp11 to p1sp1;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table l_rc_ntp1;
Table,Create Table
l_rc_ntp1,CREATE TABLE `l_rc_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST(TO_DAYS(`c`))
SUBPARTITION BY RANGE COLUMNS(`a`,`b`)
(PARTITION p2 VALUES IN (1000,11000)
 (SUBPARTITION sp287 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p1 VALUES IN (737790)
 (SUBPARTITION p1sp1 VALUES LESS THAN (1000,10000) ENGINE = InnoDB,
  SUBPARTITION p1sp2 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p22 VALUES IN (DEFAULT)
 (SUBPARTITION sp9 VALUES LESS THAN (1000,10000) ENGINE = InnoDB,
  SUBPARTITION sp10 VALUES LESS THAN (2000,10000) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table l_rc_ntp2;
Table,Create Table
l_rc_ntp2,CREATE TABLE `l_rc_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST(TO_DAYS(`c`))
SUBPARTITION BY RANGE COLUMNS(`a`,`b`)
(PARTITION p2 VALUES IN (1000,11000)
 (SUBPARTITION sp287 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p1 VALUES IN (737790)
 (SUBPARTITION p1sp1 VALUES LESS THAN (1000,10000) ENGINE = InnoDB,
  SUBPARTITION p1sp2 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p22 VALUES IN (DEFAULT)
 (SUBPARTITION sp9 VALUES LESS THAN (1000,10000) ENGINE = InnoDB,
  SUBPARTITION sp10 VALUES LESS THAN (2000,10000) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table l_rc_ntp1;
drop table l_rc_ntp2;
## l_l_ntp
create table if not exists l_l_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list (to_days(c))
subpartition by list (a)
(
partition p1 values in ( to_days('2020-01-01') ) (
subpartition p1sp1 values in ( 1000, 2000),
subpartition p1sp2 values in ( default )
),
partition p2 values in ( default ) (
subpartition p2sp1 values in ( 1000, 2000),
subpartition p2sp2 values in ( 3000, 4000),
subpartition p2sp3 values in ( default )
)
);
create table if not exists l_l_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list (to_days(c))
subpartition by list (a)
(
partition p1 values in ( to_days('2020-01-01') ) (
subpartition p1sp1 values in ( 1000, 2000),
subpartition p1sp2 values in ( default )
),
partition p2 values in ( default ) (
subpartition p2sp1 values in ( 1000, 2000),
subpartition p2sp2 values in ( 3000, 4000),
subpartition p2sp3 values in ( default )
)
);
alter table l_l_ntp1 split subpartition p1sp1 into (subpartition p1sp10 values in ( 1000),subpartition p1sp11 values in ( 2000));
alter table l_l_ntp2 split subpartition p1sp1 into (subpartition p1sp10 values in ( 1000),subpartition p1sp11 values in ( 2000));
alter table l_l_ntp1 split partition p2 into (partition p20 values in ( 1000),partition p21 values in ( 1400),partition p22 values in ( default));
alter table l_l_ntp2 split partition p2 into (partition p20 values in ( 1000),partition p21 values in ( 1400),partition p22 values in ( default));
alter table l_l_ntp1 merge partitions p20,p21 to p2;
alter table l_l_ntp2 merge partitions p20,p21 to p2;
alter table l_l_ntp1 merge subpartitions p1sp10,p1sp11 to p1sp1;
alter table l_l_ntp2 merge subpartitions p1sp10,p1sp11 to p1sp1;
alter table l_l_ntp1 set tablegroup=my_ntp_tg_1;
alter table l_l_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p1sp1 into (subpartition p1sp10 values in ( 1000),subpartition p1sp11 values in ( 2000));
alter tablegroup my_ntp_tg_1 split partition p2 into (partition p20 values in ( 1000),partition p21 values in ( 1400));
alter tablegroup my_ntp_tg_1 merge partitions p20,p21 to p2;
alter tablegroup my_ntp_tg_1 merge subpartitions p1sp10,p1sp11 to p1sp1;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table l_l_ntp1;
Table,Create Table
l_l_ntp1,CREATE TABLE `l_l_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a` USING BTREE (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST(TO_DAYS(`c`))
SUBPARTITION BY LIST(`a`)
(PARTITION p2 VALUES IN (1000,1400)
 (SUBPARTITION sp291 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p1 VALUES IN (737790)
 (SUBPARTITION p1sp1 VALUES IN (1000,2000) ENGINE = InnoDB,
  SUBPARTITION p1sp2 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p22 VALUES IN (DEFAULT)
 (SUBPARTITION sp9 VALUES IN (1000,2000) ENGINE = InnoDB,
  SUBPARTITION sp10 VALUES IN (3000,4000) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table l_l_ntp2;
Table,Create Table
l_l_ntp2,CREATE TABLE `l_l_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a` USING BTREE (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST(TO_DAYS(`c`))
SUBPARTITION BY LIST(`a`)
(PARTITION p2 VALUES IN (1000,1400)
 (SUBPARTITION sp291 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p1 VALUES IN (737790)
 (SUBPARTITION p1sp1 VALUES IN (1000,2000) ENGINE = InnoDB,
  SUBPARTITION p1sp2 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p22 VALUES IN (DEFAULT)
 (SUBPARTITION sp9 VALUES IN (1000,2000) ENGINE = InnoDB,
  SUBPARTITION sp10 VALUES IN (3000,4000) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table l_l_ntp1;
drop table l_l_ntp2;
## l_lc_ntp
create table if not exists l_lc_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list (to_days(c))
subpartition by list columns (a,b)
(
partition p1 values in ( to_days('2020-01-01') ) (
subpartition p1sp1 values in ( (1000, 2000) ),
subpartition p1sp2 values in ( default )
),
partition p2 values in ( default ) (
subpartition p2sp1 values in ( (1000, 2000) ),
subpartition p2sp2 values in ( (2000, 2000) ),
subpartition p2sp3 values in ( default )
)
);
create table if not exists l_lc_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list (to_days(c))
subpartition by list columns (a,b)
(
partition p1 values in ( to_days('2020-01-01') ) (
subpartition p1sp1 values in ( (1000, 2000) ),
subpartition p1sp2 values in ( default )
),
partition p2 values in ( default ) (
subpartition p2sp1 values in ( (1000, 2000) ),
subpartition p2sp2 values in ( (2000, 2000) ),
subpartition p2sp3 values in ( default )
)
);
alter table l_lc_ntp1 split subpartition p1sp2 into (subpartition p1sp20 values in ( (1000,4000)),subpartition p1sp21 values in ( (1000,5000)),subpartition p1sp22 values in ( default));
alter table l_lc_ntp2 split subpartition p1sp2 into (subpartition p1sp20 values in ( (1000,4000)),subpartition p1sp21 values in ( (1000,5000)),subpartition p1sp22 values in ( default));
alter table l_lc_ntp1 split partition p2 into (partition p20 values in ( 1000),partition p21 values in ( 1400),partition p22 values in ( default));
alter table l_lc_ntp2 split partition p2 into (partition p20 values in ( 1000),partition p21 values in ( 1400),partition p22 values in ( default));
alter table l_lc_ntp1 merge partitions p20,p21 to p2;
alter table l_lc_ntp2 merge partitions p20,p21 to p2;
alter table l_lc_ntp1 merge subpartitions p1sp20,p1sp21 to p1sp2;
alter table l_lc_ntp2 merge subpartitions p1sp20,p1sp21 to p1sp2;
alter table l_lc_ntp1 set tablegroup=my_ntp_tg_1;
alter table l_lc_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p1sp2 into (subpartition p1sp20 values in ( (1000,4000)),subpartition p1sp21 values in ( (1000,5000)));
alter tablegroup my_ntp_tg_1 split partition p2 into (partition p20 values in ( 1000),partition p21 values in ( 1400));
alter tablegroup my_ntp_tg_1 merge partitions p20,p21 to p2;
alter tablegroup my_ntp_tg_1 merge subpartitions p1sp20,p1sp21 to p1sp2;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table l_lc_ntp1;
Table,Create Table
l_lc_ntp1,CREATE TABLE `l_lc_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST(TO_DAYS(`c`))
SUBPARTITION BY LIST COLUMNS(`a`,`b`)
(PARTITION p2 VALUES IN (1000,1400)
 (SUBPARTITION sp295 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p1 VALUES IN (737790)
 (SUBPARTITION p1sp1 VALUES IN ((1000,2000)) ENGINE = InnoDB,
  SUBPARTITION p1sp2 VALUES IN ((1000,4000),(1000,5000)) ENGINE = InnoDB,
  SUBPARTITION p1sp22 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p22 VALUES IN (DEFAULT)
 (SUBPARTITION sp9 VALUES IN ((1000,2000)) ENGINE = InnoDB,
  SUBPARTITION sp10 VALUES IN ((2000,2000)) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table l_lc_ntp2;
Table,Create Table
l_lc_ntp2,CREATE TABLE `l_lc_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c` USING BTREE (`c`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST(TO_DAYS(`c`))
SUBPARTITION BY LIST COLUMNS(`a`,`b`)
(PARTITION p2 VALUES IN (1000,1400)
 (SUBPARTITION sp295 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p1 VALUES IN (737790)
 (SUBPARTITION p1sp1 VALUES IN ((1000,2000)) ENGINE = InnoDB,
  SUBPARTITION p1sp2 VALUES IN ((1000,4000),(1000,5000)) ENGINE = InnoDB,
  SUBPARTITION p1sp22 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p22 VALUES IN (DEFAULT)
 (SUBPARTITION sp9 VALUES IN ((1000,2000)) ENGINE = InnoDB,
  SUBPARTITION sp10 VALUES IN ((2000,2000)) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table l_lc_ntp1;
drop table l_lc_ntp2;
#########
  ## lc_h_ntp
create table if not exists lc_h_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list columns (c,d)
subpartition by hash (a,b)
(
partition p1 values in ( ('2020-01-01', 'abc') ) subpartitions 4,
partition p2 values in ( default ) subpartitions 3
);
create table if not exists lc_h_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list columns (c,d)
subpartition by hash (a,b)
(
partition p1 values in ( ('2020-01-01', 'abc') ) subpartitions 4,
partition p2 values in ( default ) subpartitions 3
);
alter table lc_h_ntp1 split subpartition p1sp1 into subpartitions 3;
alter table lc_h_ntp2 split subpartition p1sp1 into subpartitions 3;
alter table lc_h_ntp1 split partition p2 into (partition p20 values in(('2020-01-01','abcd'),('2020-01-01','abce')),partition p21 values in(('2020-01-01','abcf'),('2020-01-02','abcg')),partition p22 values in ( default ));
alter table lc_h_ntp2 split partition p2 into (partition p20 values in(('2020-01-01','abcd'),('2020-01-01','abce')),partition p21 values in(('2020-01-01','abcf'),('2020-01-02','abcg')),partition p22 values in ( default ));
alter table lc_h_ntp1 merge subpartitions p1sp3,p1sp4 to p1sp34;
alter table lc_h_ntp2 merge subpartitions p1sp3,p1sp4 to p1sp34;
alter table lc_h_ntp1 merge partitions p20,p21 to p2;
alter table lc_h_ntp2 merge partitions p20,p21 to p2;
alter table lc_h_ntp1 set tablegroup=my_ntp_tg_1;
alter table lc_h_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p1sp2 into subpartitions 2;
alter tablegroup my_ntp_tg_1 split partition p2 into (partition p20 values in(('2020-01-01','abcd'),('2020-01-01','abce')),partition p21 values in(('2020-01-01','abcf'),('2020-01-02','abcg')));
alter tablegroup my_ntp_tg_1 merge partitions p20,p21 to p2;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table lc_h_ntp1;
Table,Create Table
lc_h_ntp1,CREATE TABLE `lc_h_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST COLUMNS(`c`,`d`)
SUBPARTITION BY HASH(`a`,`b`)
(PARTITION p1 VALUES IN (('2020-01-01 00:00:00','abc'))
 (SUBPARTITION sp3 VALUES LESS THAN (-7686143364045646505) ENGINE = InnoDB,
  SUBPARTITION sp4 VALUES LESS THAN (-6148914691236517202) ENGINE = InnoDB,
  SUBPARTITION sp5 VALUES LESS THAN (-4611686018427387899) ENGINE = InnoDB,
  SUBPARTITION sp297 VALUES LESS THAN (-2305843009213693948) ENGINE = InnoDB,
  SUBPARTITION sp298 VALUES LESS THAN (3) ENGINE = InnoDB,
  SUBPARTITION p1sp34 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p2 VALUES IN (('2020-01-01 00:00:00','abcd'),('2020-01-01 00:00:00','abce'),('2020-01-01 00:00:00','abcf'),('2020-01-02 00:00:00','abcg'))
 (SUBPARTITION sp301 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p22 VALUES IN (DEFAULT)
 (SUBPARTITION sp12 VALUES LESS THAN (-3074457345618258601) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES LESS THAN (3074457345618258603) ENGINE = InnoDB,
  SUBPARTITION sp14 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table lc_h_ntp2;
Table,Create Table
lc_h_ntp2,CREATE TABLE `lc_h_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST COLUMNS(`c`,`d`)
SUBPARTITION BY HASH(`a`,`b`)
(PARTITION p1 VALUES IN (('2020-01-01 00:00:00','abc'))
 (SUBPARTITION sp3 VALUES LESS THAN (-7686143364045646505) ENGINE = InnoDB,
  SUBPARTITION sp4 VALUES LESS THAN (-6148914691236517202) ENGINE = InnoDB,
  SUBPARTITION sp5 VALUES LESS THAN (-4611686018427387899) ENGINE = InnoDB,
  SUBPARTITION sp297 VALUES LESS THAN (-2305843009213693948) ENGINE = InnoDB,
  SUBPARTITION sp298 VALUES LESS THAN (3) ENGINE = InnoDB,
  SUBPARTITION p1sp34 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p2 VALUES IN (('2020-01-01 00:00:00','abcd'),('2020-01-01 00:00:00','abce'),('2020-01-01 00:00:00','abcf'),('2020-01-02 00:00:00','abcg'))
 (SUBPARTITION sp301 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB),
 PARTITION p22 VALUES IN (DEFAULT)
 (SUBPARTITION sp12 VALUES LESS THAN (-3074457345618258601) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES LESS THAN (3074457345618258603) ENGINE = InnoDB,
  SUBPARTITION sp14 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table lc_h_ntp1;
drop table lc_h_ntp2;
## lc_k_ntp
create table if not exists lc_k_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list columns (c,d)
subpartition by key (a,b)
(
partition p1 values in ( ('2020-01-01', 'abc') ) subpartitions 4,
partition p2 values in ( default ) subpartitions 3
);
create table if not exists lc_k_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list columns (c,d)
subpartition by key (a,b)
(
partition p1 values in ( ('2020-01-01', 'abc') ) subpartitions 4,
partition p2 values in ( default ) subpartitions 3
);
alter table lc_k_ntp1 split subpartition p1sp1 into subpartitions 3;
alter table lc_k_ntp2 split subpartition p1sp1 into subpartitions 3;
alter table lc_k_ntp1 split partition p2 into (partition p20 values in(('2020-01-01','abcd'),('2020-01-01','abce')),partition p21 values in(('2020-01-01','abcf'),('2020-01-02','abcg')),partition p22 values in ( default ));
alter table lc_k_ntp2 split partition p2 into (partition p20 values in(('2020-01-01','abcd'),('2020-01-01','abce')),partition p21 values in(('2020-01-01','abcf'),('2020-01-02','abcg')),partition p22 values in ( default ));
alter table lc_k_ntp1 merge subpartitions p1sp3,p1sp4 to p1sp34;
alter table lc_k_ntp2 merge subpartitions p1sp3,p1sp4 to p1sp34;
alter table lc_k_ntp1 merge partitions p20,p21 to p2;
alter table lc_k_ntp2 merge partitions p20,p21 to p2;
alter table lc_k_ntp1 set tablegroup=my_ntp_tg_1;
alter table lc_k_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p1sp2 into subpartitions 2;
alter tablegroup my_ntp_tg_1 split partition p2 into (partition p20 values in(('2020-01-01','abcd'),('2020-01-01','abce')),partition p21 values in(('2020-01-01','abcf'),('2020-01-02','abcg')));
alter tablegroup my_ntp_tg_1 merge partitions p20,p21 to p2;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table lc_k_ntp1;
Table,Create Table
lc_k_ntp1,CREATE TABLE `lc_k_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST COLUMNS(`c`,`d`)
SUBPARTITION BY KEY(`a`,`b`)
(PARTITION p1 VALUES IN (('2020-01-01 00:00:00','abc'))
 (SUBPARTITION sp3 VALUES LESS THAN (-7686143364045646505,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp4 VALUES LESS THAN (-6148914691236517202,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp5 VALUES LESS THAN (-4611686018427387899,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp302 VALUES LESS THAN (-2305843009213693948,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp303 VALUES LESS THAN (3,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION p1sp34 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p2 VALUES IN (('2020-01-01 00:00:00','abcd'),('2020-01-01 00:00:00','abce'),('2020-01-01 00:00:00','abcf'),('2020-01-02 00:00:00','abcg'))
 (SUBPARTITION sp306 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p22 VALUES IN (DEFAULT)
 (SUBPARTITION sp12 VALUES LESS THAN (-3074457345618258601,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES LESS THAN (3074457345618258603,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp14 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table lc_k_ntp2;
Table,Create Table
lc_k_ntp2,CREATE TABLE `lc_k_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST COLUMNS(`c`,`d`)
SUBPARTITION BY KEY(`a`,`b`)
(PARTITION p1 VALUES IN (('2020-01-01 00:00:00','abc'))
 (SUBPARTITION sp3 VALUES LESS THAN (-7686143364045646505,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp4 VALUES LESS THAN (-6148914691236517202,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp5 VALUES LESS THAN (-4611686018427387899,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp302 VALUES LESS THAN (-2305843009213693948,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp303 VALUES LESS THAN (3,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION p1sp34 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p2 VALUES IN (('2020-01-01 00:00:00','abcd'),('2020-01-01 00:00:00','abce'),('2020-01-01 00:00:00','abcf'),('2020-01-02 00:00:00','abcg'))
 (SUBPARTITION sp306 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB),
 PARTITION p22 VALUES IN (DEFAULT)
 (SUBPARTITION sp12 VALUES LESS THAN (-3074457345618258601,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp13 VALUES LESS THAN (3074457345618258603,9223372036854775807) ENGINE = InnoDB,
  SUBPARTITION sp14 VALUES LESS THAN (9223372036854775807,9223372036854775807) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table lc_k_ntp1;
drop table lc_k_ntp2;
## lc_r_ntp
create table if not exists lc_r_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list columns (c,d)
subpartition by range (a)
(
partition p1 values in ( ('2020-01-01', 'abc') ) (
subpartition p1sp1 values less than ( 1000),
subpartition p1sp2 values less than ( maxvalue )
),
partition p2 values in ( default ) (
subpartition p2sp1 values less than ( 1000),
subpartition p2sp2 values less than ( 2000),
subpartition p2sp3 values less than ( maxvalue )
)
);
create table if not exists lc_r_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list columns (c,d)
subpartition by range (a)
(
partition p1 values in ( ('2020-01-01', 'abc') ) (
subpartition p1sp1 values less than ( 1000),
subpartition p1sp2 values less than ( maxvalue )
),
partition p2 values in ( default ) (
subpartition p2sp1 values less than ( 1000),
subpartition p2sp2 values less than ( 2000),
subpartition p2sp3 values less than ( maxvalue )
)
);
alter table lc_r_ntp1 split subpartition p1sp1 at(300) into (subpartition p1sp10,subpartition p1sp11);
alter table lc_r_ntp2 split subpartition p1sp1 at(300) into (subpartition p1sp10,subpartition p1sp11);
alter table lc_r_ntp1 split partition p2 into (partition p20 values in (('2020-01-01','1000')),partition p21 values in (('2020-01-02','1000')),partition p22 values in ( default));
alter table lc_r_ntp2 split partition p2 into (partition p20 values in (('2020-01-01','1000')),partition p21 values in (('2020-01-02','1000')),partition p22 values in ( default));
alter table lc_r_ntp1 merge subpartitions p1sp10,p1sp11 to p1sp1;
alter table lc_r_ntp2 merge subpartitions p1sp10,p1sp11 to p1sp1;
alter table lc_r_ntp1 merge partitions p20,p21 to p2;
alter table lc_r_ntp2 merge partitions p20,p21 to p2;
alter table lc_r_ntp1 set tablegroup=my_ntp_tg_1;
alter table lc_r_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p1sp2 at(500000000) into (subpartition p1sp20, subpartition p1sp21);
alter tablegroup my_ntp_tg_1 split partition p2 into (partition p20 values in (('2020-01-01','1000')),partition p21 values in (('2020-01-02','1000')));
alter tablegroup my_ntp_tg_1 merge partitions p20,p21 to p2;
alter tablegroup my_ntp_tg_1 merge subpartitions p1sp20,p1sp21 to p1sp2;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table lc_r_ntp1;
Table,Create Table
lc_r_ntp1,CREATE TABLE `lc_r_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a` USING BTREE (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST COLUMNS(`c`,`d`)
SUBPARTITION BY RANGE(`a`)
(PARTITION p2 VALUES IN (('2020-01-01 00:00:00','1000'),('2020-01-02 00:00:00','1000'))
 (SUBPARTITION sp309 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p1 VALUES IN (('2020-01-01 00:00:00','abc'))
 (SUBPARTITION p1sp1 VALUES LESS THAN (1000) ENGINE = InnoDB,
  SUBPARTITION p1sp2 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p22 VALUES IN (DEFAULT)
 (SUBPARTITION sp9 VALUES LESS THAN (1000) ENGINE = InnoDB,
  SUBPARTITION sp10 VALUES LESS THAN (2000) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table lc_r_ntp2;
Table,Create Table
lc_r_ntp2,CREATE TABLE `lc_r_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a` USING BTREE (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST COLUMNS(`c`,`d`)
SUBPARTITION BY RANGE(`a`)
(PARTITION p2 VALUES IN (('2020-01-01 00:00:00','1000'),('2020-01-02 00:00:00','1000'))
 (SUBPARTITION sp309 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p1 VALUES IN (('2020-01-01 00:00:00','abc'))
 (SUBPARTITION p1sp1 VALUES LESS THAN (1000) ENGINE = InnoDB,
  SUBPARTITION p1sp2 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB),
 PARTITION p22 VALUES IN (DEFAULT)
 (SUBPARTITION sp9 VALUES LESS THAN (1000) ENGINE = InnoDB,
  SUBPARTITION sp10 VALUES LESS THAN (2000) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table lc_r_ntp1;
drop table lc_r_ntp2;
## lc_rc_ntp
create table if not exists lc_rc_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list columns (c,d)
subpartition by range columns (a,b)
(
partition p1 values in ( ('2020-01-01', 'abc') ) (
subpartition p1sp1 values less than ( 1000, 10000),
subpartition p1sp2 values less than ( maxvalue, maxvalue )
),
partition p2 values in ( default ) (
subpartition p2sp1 values less than ( 1000, 10000),
subpartition p2sp2 values less than ( 2000, 10000),
subpartition p2sp3 values less than ( maxvalue, maxvalue )
)
);
create table if not exists lc_rc_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list columns (c,d)
subpartition by range columns (a,b)
(
partition p1 values in ( ('2020-01-01', 'abc') ) (
subpartition p1sp1 values less than ( 1000, 10000),
subpartition p1sp2 values less than ( maxvalue, maxvalue )
),
partition p2 values in ( default ) (
subpartition p2sp1 values less than ( 1000, 10000),
subpartition p2sp2 values less than ( 2000, 10000),
subpartition p2sp3 values less than ( maxvalue, maxvalue )
)
);
alter table lc_rc_ntp1 split subpartition p1sp1 into (subpartition p1sp10 values less than(200,10000),subpartition p1sp11 values less than(1000,10000));
alter table lc_rc_ntp2 split subpartition p1sp1 into (subpartition p1sp10 values less than(200,10000),subpartition p1sp11 values less than(1000,10000));
alter table lc_rc_ntp1 split partition p2 into (partition p20 values in (('2020-01-01','1000')),partition p21 values in (('2020-01-01','3000')),partition p22 values in ( default));
alter table lc_rc_ntp2 split partition p2 into (partition p20 values in (('2020-01-01','1000')),partition p21 values in (('2020-01-01','3000')),partition p22 values in ( default));
alter table lc_rc_ntp1 merge subpartitions p1sp10,p1sp11 to p1sp1;
alter table lc_rc_ntp2 merge subpartitions p1sp10,p1sp11 to p1sp1;
alter table lc_rc_ntp1 merge partitions p20,p21 to p2;
alter table lc_rc_ntp2 merge partitions p20,p21 to p2;
alter table lc_rc_ntp1 set tablegroup=my_ntp_tg_1;
alter table lc_rc_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p1sp2 into (subpartition p1sp20 values less than(2000,10000),subpartition p1sp21 values less than(maxvalue,maxvalue));
alter tablegroup my_ntp_tg_1 split partition p2 into (partition p20 values in (('2020-01-01','1000')),partition p21 values in (('2020-01-01','3000')));
alter tablegroup my_ntp_tg_1 merge partitions p20,p21 to p2;
alter tablegroup my_ntp_tg_1 merge subpartitions p1sp20,p1sp21 to p1sp2;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table lc_rc_ntp1;
Table,Create Table
lc_rc_ntp1,CREATE TABLE `lc_rc_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST COLUMNS(`c`,`d`)
SUBPARTITION BY RANGE COLUMNS(`a`,`b`)
(PARTITION p2 VALUES IN (('2020-01-01 00:00:00','1000'),('2020-01-01 00:00:00','3000'))
 (SUBPARTITION sp313 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p1 VALUES IN (('2020-01-01 00:00:00','abc'))
 (SUBPARTITION p1sp1 VALUES LESS THAN (1000,10000) ENGINE = InnoDB,
  SUBPARTITION p1sp2 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p22 VALUES IN (DEFAULT)
 (SUBPARTITION sp9 VALUES LESS THAN (1000,10000) ENGINE = InnoDB,
  SUBPARTITION sp10 VALUES LESS THAN (2000,10000) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table lc_rc_ntp2;
Table,Create Table
lc_rc_ntp2,CREATE TABLE `lc_rc_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST COLUMNS(`c`,`d`)
SUBPARTITION BY RANGE COLUMNS(`a`,`b`)
(PARTITION p2 VALUES IN (('2020-01-01 00:00:00','1000'),('2020-01-01 00:00:00','3000'))
 (SUBPARTITION sp313 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p1 VALUES IN (('2020-01-01 00:00:00','abc'))
 (SUBPARTITION p1sp1 VALUES LESS THAN (1000,10000) ENGINE = InnoDB,
  SUBPARTITION p1sp2 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB),
 PARTITION p22 VALUES IN (DEFAULT)
 (SUBPARTITION sp9 VALUES LESS THAN (1000,10000) ENGINE = InnoDB,
  SUBPARTITION sp10 VALUES LESS THAN (2000,10000) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES LESS THAN (MAXVALUE,MAXVALUE) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table lc_rc_ntp1;
drop table lc_rc_ntp2;
## lc_l_tp
create table if not exists lc_l_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list columns (c,d)
subpartition by list (a)
(
partition p1 values in ( ('2020-01-01', 'abc') ) (
subpartition p1sp1 values in ( 1000, 2000),
subpartition p1sp2 values in ( default )
),
partition p2 values in ( default ) (
subpartition p2sp1 values in ( 1000, 2000),
subpartition p2sp2 values in ( 3000, 4000),
subpartition p2sp3 values in ( default )
)
);
create table if not exists lc_l_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list columns (c,d)
subpartition by list (a)
(
partition p1 values in ( ('2020-01-01', 'abc') ) (
subpartition p1sp1 values in ( 1000, 2000),
subpartition p1sp2 values in ( default )
),
partition p2 values in ( default ) (
subpartition p2sp1 values in ( 1000, 2000),
subpartition p2sp2 values in ( 3000, 4000),
subpartition p2sp3 values in ( default )
)
);
alter table lc_l_ntp1 split partition p2 into (partition p20 values in ( ('2020-01-01','1000')),partition p21 values in ( ('2020-01-01','4000')),partition p22 values in ( default));
alter table lc_l_ntp2 split partition p2 into (partition p20 values in ( ('2020-01-01','1000')),partition p21 values in ( ('2020-01-01','4000')),partition p22 values in ( default));
alter table lc_l_ntp1 split subpartition p1sp2 into (subpartition p1sp20 values in ( 9000),subpartition p1sp21 values in ( 8000),subpartition p1sp22 values in ( default));
alter table lc_l_ntp2 split subpartition p1sp2 into (subpartition p1sp20 values in ( 9000),subpartition p1sp21 values in ( 8000),subpartition p1sp22 values in ( default));
alter table lc_l_ntp1 merge partitions p20,p21 to p2;
alter table lc_l_ntp2 merge partitions p20,p21 to p2;
alter table lc_l_ntp1 merge subpartitions p1sp20,p1sp21 to p1sp2;
alter table lc_l_ntp2 merge subpartitions p1sp20,p1sp21 to p1sp2;
alter table lc_l_ntp1 set tablegroup=my_ntp_tg_1;
alter table lc_l_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p1sp2 into (subpartition p1sp20 values in ( 9000),subpartition p1sp21 values in ( 8000));
alter tablegroup my_ntp_tg_1 split partition p2 into (partition p20 values in ( ('2020-01-01','1000')),partition p21 values in ( ('2020-01-01','4000')));
alter tablegroup my_ntp_tg_1 merge partitions p20,p21 to p2;
alter tablegroup my_ntp_tg_1 merge subpartitions p1sp20,p1sp21 to p1sp2;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table lc_l_ntp1;
Table,Create Table
lc_l_ntp1,CREATE TABLE `lc_l_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a` USING BTREE (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST COLUMNS(`c`,`d`)
SUBPARTITION BY LIST(`a`)
(PARTITION p2 VALUES IN (('2020-01-01 00:00:00','1000'),('2020-01-01 00:00:00','4000'))
 (SUBPARTITION sp317 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p1 VALUES IN (('2020-01-01 00:00:00','abc'))
 (SUBPARTITION p1sp1 VALUES IN (1000,2000) ENGINE = InnoDB,
  SUBPARTITION p1sp2 VALUES IN (8000,9000) ENGINE = InnoDB,
  SUBPARTITION p1sp22 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p22 VALUES IN (DEFAULT)
 (SUBPARTITION sp9 VALUES IN (1000,2000) ENGINE = InnoDB,
  SUBPARTITION sp10 VALUES IN (3000,4000) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table lc_l_ntp2;
Table,Create Table
lc_l_ntp2,CREATE TABLE `lc_l_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a` USING BTREE (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST COLUMNS(`c`,`d`)
SUBPARTITION BY LIST(`a`)
(PARTITION p2 VALUES IN (('2020-01-01 00:00:00','1000'),('2020-01-01 00:00:00','4000'))
 (SUBPARTITION sp317 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p1 VALUES IN (('2020-01-01 00:00:00','abc'))
 (SUBPARTITION p1sp1 VALUES IN (1000,2000) ENGINE = InnoDB,
  SUBPARTITION p1sp2 VALUES IN (8000,9000) ENGINE = InnoDB,
  SUBPARTITION p1sp22 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p22 VALUES IN (DEFAULT)
 (SUBPARTITION sp9 VALUES IN (1000,2000) ENGINE = InnoDB,
  SUBPARTITION sp10 VALUES IN (3000,4000) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table lc_l_ntp1;
drop table lc_l_ntp2;
## lc_lc_ntp
create table if not exists lc_lc_ntp1 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list columns (c,d)
subpartition by list columns (a,b)
(
partition p1 values in ( ('2020-01-01', 'abc') ) (
subpartition p1sp1 values in ( (1000, 2000) ),
subpartition p1sp2 values in ( default )
),
partition p2 values in ( default ) (
subpartition p2sp1 values in ( (1000, 2000) ),
subpartition p2sp2 values in ( (2000, 2000) ),
subpartition p2sp3 values in ( default )
)
);
create table if not exists lc_lc_ntp2 (
a bigint unsigned not null,
b bigint unsigned not null,
c datetime NOT NULL,
d varchar(16) NOT NULL,
e varchar(16) NOT NULL
)
partition by list columns (c,d)
subpartition by list columns (a,b)
(
partition p1 values in ( ('2020-01-01', 'abc') ) (
subpartition p1sp1 values in ( (1000, 2000) ),
subpartition p1sp2 values in ( default )
),
partition p2 values in ( default ) (
subpartition p2sp1 values in ( (1000, 2000) ),
subpartition p2sp2 values in ( (2000, 2000) ),
subpartition p2sp3 values in ( default )
)
);
alter table lc_lc_ntp1 split partition p2 into (partition p20 values in ( ('2020-01-01','4000')),partition p21 values in ( ('2020-01-02','4000')),partition p22 values in ( default));
alter table lc_lc_ntp2 split partition p2 into (partition p20 values in ( ('2020-01-01','4000')),partition p21 values in ( ('2020-01-02','4000')),partition p22 values in ( default));
alter table lc_lc_ntp1 split subpartition p1sp2 into (subpartition p1sp20 values in ( (900,9000)),subpartition p1sp21 values in ( (9800,9000)),subpartition p1sp22 values in ( default));
alter table lc_lc_ntp2 split subpartition p1sp2 into (subpartition p1sp20 values in ( (900,9000)),subpartition p1sp21 values in ( (9800,9000)),subpartition p1sp22 values in ( default));
alter table lc_lc_ntp1 merge partitions p20,p21 to p2;
alter table lc_lc_ntp2 merge partitions p20,p21 to p2;
alter table lc_lc_ntp1 merge subpartitions p1sp20,p1sp21 to p1sp2;
alter table lc_lc_ntp2 merge subpartitions p1sp20,p1sp21 to p1sp2;
alter table lc_lc_ntp1 set tablegroup=my_ntp_tg_1;
alter table lc_lc_ntp2 set tablegroup=my_ntp_tg_1;
alter tablegroup my_ntp_tg_1 split subpartition p1sp2 into (subpartition p1sp20 values in ( (900,9000)),subpartition p1sp21 values in ( (9800,9000)));
alter tablegroup my_ntp_tg_1 split partition p2 into (partition p20 values in ( ('2020-01-01','4000')),partition p21 values in ( ('2020-01-02','4000')));
alter tablegroup my_ntp_tg_1 merge partitions p20,p21 to p2;
alter tablegroup my_ntp_tg_1 merge subpartitions p1sp20,p1sp21 to p1sp2;
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table lc_lc_ntp1;
Table,Create Table
lc_lc_ntp1,CREATE TABLE `lc_lc_ntp1` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST COLUMNS(`c`,`d`)
SUBPARTITION BY LIST COLUMNS(`a`,`b`)
(PARTITION p2 VALUES IN (('2020-01-01 00:00:00','4000'),('2020-01-02 00:00:00','4000'))
 (SUBPARTITION sp321 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p1 VALUES IN (('2020-01-01 00:00:00','abc'))
 (SUBPARTITION p1sp2 VALUES IN ((900,9000),(9800,9000)) ENGINE = InnoDB,
  SUBPARTITION p1sp1 VALUES IN ((1000,2000)) ENGINE = InnoDB,
  SUBPARTITION p1sp22 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p22 VALUES IN (DEFAULT)
 (SUBPARTITION sp9 VALUES IN ((1000,2000)) ENGINE = InnoDB,
  SUBPARTITION sp10 VALUES IN ((2000,2000)) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show full create table lc_lc_ntp2;
Table,Create Table
lc_lc_ntp2,CREATE TABLE `lc_lc_ntp2` (
	`a` bigint(20) UNSIGNED NOT NULL,
	`b` bigint(20) UNSIGNED NOT NULL,
	`c` datetime NOT NULL,
	`d` varchar(16) NOT NULL,
	`e` varchar(16) NOT NULL,
	`_drds_implicit_id_` bigint(20) NOT NULL AUTO_INCREMENT,
	PRIMARY KEY (`_drds_implicit_id_`),
	LOCAL KEY `auto_shard_key_c_d` USING BTREE (`c`, `d`),
	LOCAL KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY LIST COLUMNS(`c`,`d`)
SUBPARTITION BY LIST COLUMNS(`a`,`b`)
(PARTITION p2 VALUES IN (('2020-01-01 00:00:00','4000'),('2020-01-02 00:00:00','4000'))
 (SUBPARTITION sp321 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p1 VALUES IN (('2020-01-01 00:00:00','abc'))
 (SUBPARTITION p1sp2 VALUES IN ((900,9000),(9800,9000)) ENGINE = InnoDB,
  SUBPARTITION p1sp1 VALUES IN ((1000,2000)) ENGINE = InnoDB,
  SUBPARTITION p1sp22 VALUES IN (DEFAULT) ENGINE = InnoDB),
 PARTITION p22 VALUES IN (DEFAULT)
 (SUBPARTITION sp9 VALUES IN ((1000,2000)) ENGINE = InnoDB,
  SUBPARTITION sp10 VALUES IN ((2000,2000)) ENGINE = InnoDB,
  SUBPARTITION sp11 VALUES IN (DEFAULT) ENGINE = InnoDB))
tablegroup = `my_ntp_tg_1`
drop table lc_lc_ntp1;
drop table lc_lc_ntp2;