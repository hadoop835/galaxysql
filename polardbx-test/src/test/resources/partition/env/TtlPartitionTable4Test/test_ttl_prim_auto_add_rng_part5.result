## DISABLE_FAST_SQL_PARSER
## RESERVE_SEMICOLONS
set TTL_DEBUG_CCI_SKIP_DDL_TASKS = "WaitColumnarTableAlterPartitionTask,WaitColumnarTableCreationTask";
set SKIP_DDL_TASKS="WaitColumnarTableAlterPartitionTask,WaitColumnarTableCreationTask";
set TTL_DEBUG_CURRENT_DATETIME='2024-06-27 00:00:00';
set TTL_FORBID_DROP_TTL_TBL_WITH_ARC_CCI=false;
set ENABLE_DROP_TRUNCATE_CCI_PARTITION=true;
create table auto_rng_part_tc5_t1(
a int not null auto_increment,
b decimal(32,0) not null,
primary key(a)
)
partition by range columns(b)
(
partition p1 values less than(1000),
partition p2 values less than(2000),
partition p3 values less than(3000)
);
alter table auto_rng_part_tc5_t1 modify ttl set ttl_expr=`b` expire over 8 partitions, archive_type='PARTITION', ttl_part_interval=interval(1000, NUMBER);
show create table auto_rng_part_tc5_t1;
Table,Create Table
auto_rng_part_tc5_t1,CREATE TABLE `auto_rng_part_tc5_t1` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` decimal(32, 0) NOT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(1000, NUMBER), ARCHIVE_TYPE = 'PARTITION', ARCHIVE_TABLE_NAME = '', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 64 )
PARTITION BY RANGE COLUMNS(`b`)
(PARTITION p1 VALUES LESS THAN (1000) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN (2000) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (3000) ENGINE = InnoDB)
alter table auto_rng_part_tc5_t1 cleanup expired data;
show create table auto_rng_part_tc5_t1;
Table,Create Table
auto_rng_part_tc5_t1,CREATE TABLE `auto_rng_part_tc5_t1` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` decimal(32, 0) NOT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(1000, NUMBER), ARCHIVE_TYPE = 'PARTITION', ARCHIVE_TABLE_NAME = '', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 64 )
PARTITION BY RANGE COLUMNS(`b`)
(PARTITION p1 VALUES LESS THAN (1000) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN (2000) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (3000) ENGINE = InnoDB,
 PARTITION p4000 VALUES LESS THAN (4000) ENGINE = InnoDB,
 PARTITION p5000 VALUES LESS THAN (5000) ENGINE = InnoDB,
 PARTITION p6000 VALUES LESS THAN (6000) ENGINE = InnoDB,
 PARTITION p7000 VALUES LESS THAN (7000) ENGINE = InnoDB,
 PARTITION p8000 VALUES LESS THAN (8000) ENGINE = InnoDB)
alter table auto_rng_part_tc5_t1 modify ttl set  ttl_part_interval=interval(1000000, NUMBER);
alter table auto_rng_part_tc5_t1 drop partition p1;
show create table auto_rng_part_tc5_t1;
Table,Create Table
auto_rng_part_tc5_t1,CREATE TABLE `auto_rng_part_tc5_t1` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` decimal(32, 0) NOT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(1000000, NUMBER), ARCHIVE_TYPE = 'PARTITION', ARCHIVE_TABLE_NAME = '', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 8 )
PARTITION BY RANGE COLUMNS(`b`)
(PARTITION p2 VALUES LESS THAN (2000) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (3000) ENGINE = InnoDB,
 PARTITION p4000 VALUES LESS THAN (4000) ENGINE = InnoDB,
 PARTITION p5000 VALUES LESS THAN (5000) ENGINE = InnoDB,
 PARTITION p6000 VALUES LESS THAN (6000) ENGINE = InnoDB,
 PARTITION p7000 VALUES LESS THAN (7000) ENGINE = InnoDB,
 PARTITION p8000 VALUES LESS THAN (8000) ENGINE = InnoDB)
alter table auto_rng_part_tc5_t1 cleanup expired data;
show create table auto_rng_part_tc5_t1;
Table,Create Table
auto_rng_part_tc5_t1,CREATE TABLE `auto_rng_part_tc5_t1` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` decimal(32, 0) NOT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(1000000, NUMBER), ARCHIVE_TYPE = 'PARTITION', ARCHIVE_TABLE_NAME = '', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 8 )
PARTITION BY RANGE COLUMNS(`b`)
(PARTITION p2 VALUES LESS THAN (2000) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (3000) ENGINE = InnoDB,
 PARTITION p4000 VALUES LESS THAN (4000) ENGINE = InnoDB,
 PARTITION p5000 VALUES LESS THAN (5000) ENGINE = InnoDB,
 PARTITION p6000 VALUES LESS THAN (6000) ENGINE = InnoDB,
 PARTITION p7000 VALUES LESS THAN (7000) ENGINE = InnoDB,
 PARTITION p8000 VALUES LESS THAN (8000) ENGINE = InnoDB,
 PARTITION p1000000 VALUES LESS THAN (1000000) ENGINE = InnoDB)
alter table auto_rng_part_tc5_t1 drop partition p2;
show create table auto_rng_part_tc5_t1;
Table,Create Table
auto_rng_part_tc5_t1,CREATE TABLE `auto_rng_part_tc5_t1` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` decimal(32, 0) NOT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(1000000, NUMBER), ARCHIVE_TYPE = 'PARTITION', ARCHIVE_TABLE_NAME = '', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 8 )
PARTITION BY RANGE COLUMNS(`b`)
(PARTITION p3 VALUES LESS THAN (3000) ENGINE = InnoDB,
 PARTITION p4000 VALUES LESS THAN (4000) ENGINE = InnoDB,
 PARTITION p5000 VALUES LESS THAN (5000) ENGINE = InnoDB,
 PARTITION p6000 VALUES LESS THAN (6000) ENGINE = InnoDB,
 PARTITION p7000 VALUES LESS THAN (7000) ENGINE = InnoDB,
 PARTITION p8000 VALUES LESS THAN (8000) ENGINE = InnoDB,
 PARTITION p1000000 VALUES LESS THAN (1000000) ENGINE = InnoDB)
alter table auto_rng_part_tc5_t1 cleanup expired data;
show create table auto_rng_part_tc5_t1;
Table,Create Table
auto_rng_part_tc5_t1,CREATE TABLE `auto_rng_part_tc5_t1` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` decimal(32, 0) NOT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(1000000, NUMBER), ARCHIVE_TYPE = 'PARTITION', ARCHIVE_TABLE_NAME = '', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 8 )
PARTITION BY RANGE COLUMNS(`b`)
(PARTITION p3 VALUES LESS THAN (3000) ENGINE = InnoDB,
 PARTITION p4000 VALUES LESS THAN (4000) ENGINE = InnoDB,
 PARTITION p5000 VALUES LESS THAN (5000) ENGINE = InnoDB,
 PARTITION p6000 VALUES LESS THAN (6000) ENGINE = InnoDB,
 PARTITION p7000 VALUES LESS THAN (7000) ENGINE = InnoDB,
 PARTITION p8000 VALUES LESS THAN (8000) ENGINE = InnoDB,
 PARTITION p1000000 VALUES LESS THAN (1000000) ENGINE = InnoDB,
 PARTITION p2000000 VALUES LESS THAN (2000000) ENGINE = InnoDB)
create table auto_rng_part_tc5_t2(
a int not null auto_increment,
b bigint not null,
primary key(a)
)
partition by range columns(b)
(
partition p1 values less than(1000),
partition p2 values less than(2000),
partition p3 values less than(3000)
);
alter table auto_rng_part_tc5_t2 modify ttl set ttl_expr=`b` expire over 8 partitions, archive_type='PARTITION', ttl_part_interval=interval(10000, NUMBER),ARCHIVE_TABLE_PRE_ALLOCATE = 2,ARCHIVE_TABLE_POST_ALLOCATE = 8;
show create table auto_rng_part_tc5_t2;
Table,Create Table
auto_rng_part_tc5_t2,CREATE TABLE `auto_rng_part_tc5_t2` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` bigint(20) NOT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(10000, NUMBER), ARCHIVE_TYPE = 'PARTITION', ARCHIVE_TABLE_NAME = '', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 8 )
PARTITION BY RANGE COLUMNS(`b`)
(PARTITION p1 VALUES LESS THAN (1000) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN (2000) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (3000) ENGINE = InnoDB)
alter table auto_rng_part_tc5_t2 cleanup expired data;
show create table auto_rng_part_tc5_t2;
Table,Create Table
auto_rng_part_tc5_t2,CREATE TABLE `auto_rng_part_tc5_t2` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` bigint(20) NOT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(10000, NUMBER), ARCHIVE_TYPE = 'PARTITION', ARCHIVE_TABLE_NAME = '', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 8 )
PARTITION BY RANGE COLUMNS(`b`)
(PARTITION p1 VALUES LESS THAN (1000) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN (2000) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (3000) ENGINE = InnoDB,
 PARTITION p10000 VALUES LESS THAN (10000) ENGINE = InnoDB,
 PARTITION p20000 VALUES LESS THAN (20000) ENGINE = InnoDB,
 PARTITION p30000 VALUES LESS THAN (30000) ENGINE = InnoDB,
 PARTITION p40000 VALUES LESS THAN (40000) ENGINE = InnoDB,
 PARTITION p50000 VALUES LESS THAN (50000) ENGINE = InnoDB)
alter table auto_rng_part_tc5_t2 drop partition p1;
show create table auto_rng_part_tc5_t2;
Table,Create Table
auto_rng_part_tc5_t2,CREATE TABLE `auto_rng_part_tc5_t2` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` bigint(20) NOT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(10000, NUMBER), ARCHIVE_TYPE = 'PARTITION', ARCHIVE_TABLE_NAME = '', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 8 )
PARTITION BY RANGE COLUMNS(`b`)
(PARTITION p2 VALUES LESS THAN (2000) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (3000) ENGINE = InnoDB,
 PARTITION p10000 VALUES LESS THAN (10000) ENGINE = InnoDB,
 PARTITION p20000 VALUES LESS THAN (20000) ENGINE = InnoDB,
 PARTITION p30000 VALUES LESS THAN (30000) ENGINE = InnoDB,
 PARTITION p40000 VALUES LESS THAN (40000) ENGINE = InnoDB,
 PARTITION p50000 VALUES LESS THAN (50000) ENGINE = InnoDB)
alter table auto_rng_part_tc5_t2 cleanup expired data;
show create table auto_rng_part_tc5_t2;
Table,Create Table
auto_rng_part_tc5_t2,CREATE TABLE `auto_rng_part_tc5_t2` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` bigint(20) NOT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(10000, NUMBER), ARCHIVE_TYPE = 'PARTITION', ARCHIVE_TABLE_NAME = '', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 8 )
PARTITION BY RANGE COLUMNS(`b`)
(PARTITION p2 VALUES LESS THAN (2000) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (3000) ENGINE = InnoDB,
 PARTITION p10000 VALUES LESS THAN (10000) ENGINE = InnoDB,
 PARTITION p20000 VALUES LESS THAN (20000) ENGINE = InnoDB,
 PARTITION p30000 VALUES LESS THAN (30000) ENGINE = InnoDB,
 PARTITION p40000 VALUES LESS THAN (40000) ENGINE = InnoDB,
 PARTITION p50000 VALUES LESS THAN (50000) ENGINE = InnoDB,
 PARTITION p60000 VALUES LESS THAN (60000) ENGINE = InnoDB)
alter table auto_rng_part_tc5_t2 cleanup expired data;
show create table auto_rng_part_tc5_t2;
Table,Create Table
auto_rng_part_tc5_t2,CREATE TABLE `auto_rng_part_tc5_t2` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` bigint(20) NOT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(10000, NUMBER), ARCHIVE_TYPE = 'PARTITION', ARCHIVE_TABLE_NAME = '', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 8 )
PARTITION BY RANGE COLUMNS(`b`)
(PARTITION p2 VALUES LESS THAN (2000) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (3000) ENGINE = InnoDB,
 PARTITION p10000 VALUES LESS THAN (10000) ENGINE = InnoDB,
 PARTITION p20000 VALUES LESS THAN (20000) ENGINE = InnoDB,
 PARTITION p30000 VALUES LESS THAN (30000) ENGINE = InnoDB,
 PARTITION p40000 VALUES LESS THAN (40000) ENGINE = InnoDB,
 PARTITION p50000 VALUES LESS THAN (50000) ENGINE = InnoDB,
 PARTITION p60000 VALUES LESS THAN (60000) ENGINE = InnoDB,
 PARTITION p70000 VALUES LESS THAN (70000) ENGINE = InnoDB)
create table auto_rng_part_tc5_t2_bk like auto_rng_part_tc5_t2 engine='columnar' archive_mode='ttl';
drop table if exists auto_rng_part_tc5_t3;
create table auto_rng_part_tc5_t3(
a int not null auto_increment,
b bigint unsigned not null,
primary key(a)
)
partition by range columns(b)
(
partition p1 values less than(1000),
partition p2 values less than(2000),
partition p3 values less than(3000)
);
alter table auto_rng_part_tc5_t3 modify ttl set ttl_expr=`b` expire over 8 partitions, archive_type='PARTITION', ttl_part_interval=interval(10000, NUMBER),ARCHIVE_TABLE_PRE_ALLOCATE = 2,ARCHIVE_TABLE_POST_ALLOCATE = 8;
show create table auto_rng_part_tc5_t3;
Table,Create Table
auto_rng_part_tc5_t3,CREATE TABLE `auto_rng_part_tc5_t3` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` bigint(20) UNSIGNED NOT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(10000, NUMBER), ARCHIVE_TYPE = 'PARTITION', ARCHIVE_TABLE_NAME = '', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 8 )
PARTITION BY RANGE COLUMNS(`b`)
(PARTITION p1 VALUES LESS THAN (1000) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN (2000) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (3000) ENGINE = InnoDB)
alter table auto_rng_part_tc5_t3 cleanup expired data;
show create table auto_rng_part_tc5_t3;
Table,Create Table
auto_rng_part_tc5_t3,CREATE TABLE `auto_rng_part_tc5_t3` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` bigint(20) UNSIGNED NOT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(10000, NUMBER), ARCHIVE_TYPE = 'PARTITION', ARCHIVE_TABLE_NAME = '', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 8 )
PARTITION BY RANGE COLUMNS(`b`)
(PARTITION p1 VALUES LESS THAN (1000) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN (2000) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (3000) ENGINE = InnoDB,
 PARTITION p10000 VALUES LESS THAN (10000) ENGINE = InnoDB,
 PARTITION p20000 VALUES LESS THAN (20000) ENGINE = InnoDB,
 PARTITION p30000 VALUES LESS THAN (30000) ENGINE = InnoDB,
 PARTITION p40000 VALUES LESS THAN (40000) ENGINE = InnoDB,
 PARTITION p50000 VALUES LESS THAN (50000) ENGINE = InnoDB)
create table auto_rng_part_tc5_t3_bk like auto_rng_part_tc5_t3 engine='columnar' archive_mode='ttl';
alter table auto_rng_part_tc5_t3 add partition
(
 partition p80000 values less than(80000),
 partition p90000 values less than(90000),
 partition p100000 values less than(100000)
);
alter table auto_rng_part_tc5_t3 cleanup expired data;
alter table auto_rng_part_tc5_t3 add partition
(
partition p120000 values less than(120000)
);
create table auto_rng_part_tc5_t9(
a int not null auto_increment,
b int not null,
primary key(a)
)
partition by key(a)
partitions 2
subpartition by range columns(b)
(
subpartition sp1 values less than(1000),
subpartition sp2 values less than(2000),
subpartition sp3 values less than(3000),
subpartition spm values less than(maxvalue)
);
alter table auto_rng_part_tc5_t9 modify ttl set ttl_expr=`b` expire over 8 partitions, archive_type='SUBPARTITION', ttl_part_interval=interval(1000, NUMBER);
show create table auto_rng_part_tc5_t9;
Table,Create Table
auto_rng_part_tc5_t9,CREATE TABLE `auto_rng_part_tc5_t9` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` int(11) NOT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(1000, NUMBER), ARCHIVE_TYPE = 'SUBPARTITION', ARCHIVE_TABLE_NAME = '', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 64 )
PARTITION BY KEY(`a`)
PARTITIONS 2
SUBPARTITION BY RANGE COLUMNS(`b`)
(SUBPARTITION sp1 VALUES LESS THAN (1000),
 SUBPARTITION sp2 VALUES LESS THAN (2000),
 SUBPARTITION sp3 VALUES LESS THAN (3000),
 SUBPARTITION spm VALUES LESS THAN (MAXVALUE))
alter table auto_rng_part_tc5_t9 cleanup expired data;
show create table auto_rng_part_tc5_t9;
Table,Create Table
auto_rng_part_tc5_t9,CREATE TABLE `auto_rng_part_tc5_t9` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` int(11) NOT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(1000, NUMBER), ARCHIVE_TYPE = 'SUBPARTITION', ARCHIVE_TABLE_NAME = '', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 64 )
PARTITION BY KEY(`a`)
PARTITIONS 2
SUBPARTITION BY RANGE COLUMNS(`b`)
(SUBPARTITION sp1 VALUES LESS THAN (1000),
 SUBPARTITION sp2 VALUES LESS THAN (2000),
 SUBPARTITION sp3 VALUES LESS THAN (3000),
 SUBPARTITION sp4000 VALUES LESS THAN (4000),
 SUBPARTITION sp5000 VALUES LESS THAN (5000),
 SUBPARTITION sp6000 VALUES LESS THAN (6000),
 SUBPARTITION sp7000 VALUES LESS THAN (7000),
 SUBPARTITION spm VALUES LESS THAN (MAXVALUE))
alter table auto_rng_part_tc5_t9 drop subpartition sp1;
show create table auto_rng_part_tc5_t9;
Table,Create Table
auto_rng_part_tc5_t9,CREATE TABLE `auto_rng_part_tc5_t9` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` int(11) NOT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(1000, NUMBER), ARCHIVE_TYPE = 'SUBPARTITION', ARCHIVE_TABLE_NAME = '', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 64 )
PARTITION BY KEY(`a`)
PARTITIONS 2
SUBPARTITION BY RANGE COLUMNS(`b`)
(SUBPARTITION sp2 VALUES LESS THAN (2000),
 SUBPARTITION sp3 VALUES LESS THAN (3000),
 SUBPARTITION sp4000 VALUES LESS THAN (4000),
 SUBPARTITION sp5000 VALUES LESS THAN (5000),
 SUBPARTITION sp6000 VALUES LESS THAN (6000),
 SUBPARTITION sp7000 VALUES LESS THAN (7000),
 SUBPARTITION spm VALUES LESS THAN (MAXVALUE))
alter table auto_rng_part_tc5_t9 cleanup expired data;
show create table auto_rng_part_tc5_t9;
Table,Create Table
auto_rng_part_tc5_t9,CREATE TABLE `auto_rng_part_tc5_t9` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` int(11) NOT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(1000, NUMBER), ARCHIVE_TYPE = 'SUBPARTITION', ARCHIVE_TABLE_NAME = '', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 64 )
PARTITION BY KEY(`a`)
PARTITIONS 2
SUBPARTITION BY RANGE COLUMNS(`b`)
(SUBPARTITION sp2 VALUES LESS THAN (2000),
 SUBPARTITION sp3 VALUES LESS THAN (3000),
 SUBPARTITION sp4000 VALUES LESS THAN (4000),
 SUBPARTITION sp5000 VALUES LESS THAN (5000),
 SUBPARTITION sp6000 VALUES LESS THAN (6000),
 SUBPARTITION sp7000 VALUES LESS THAN (7000),
 SUBPARTITION sp8000 VALUES LESS THAN (8000),
 SUBPARTITION spm VALUES LESS THAN (MAXVALUE))
set TTL_DEBUG_CCI_SKIP_DDL_TASKS = "WaitColumnarTableAlterPartitionTask,WaitColumnarTableCreationTask";
set SKIP_DDL_TASKS="WaitColumnarTableAlterPartitionTask,WaitColumnarTableCreationTask";
set TTL_DEBUG_CURRENT_DATETIME='2024-06-27 00:00:00';
set TTL_FORBID_DROP_TTL_TBL_WITH_ARC_CCI=false;
drop table if exists auto_rng_part_tc5_t10;
create table if not exists auto_rng_part_tc5_t10(
a int not null auto_increment,
b datetime not null,
primary key(a)
)
partition by key(a)
partitions 2
subpartition by range columns(b)
(
subpartition sp20240501 values less than('2024-01-01'),
subpartition sp20240601 values less than('2024-02-02'),
subpartition sp20240701 values less than('2024-03-03'),
subpartition sp20240801 values less than('2024-04-04')
);
alter table auto_rng_part_tc5_t10 modify ttl set ttl_expr=`b` expire over 8 partitions, archive_type='SUBPARTITION', ttl_part_interval=interval(1, MONTH), archive_table_pre_allocate = 2,archive_table_post_allocate = 8;
alter table auto_rng_part_tc5_t10 cleanup expired data;
show create table auto_rng_part_tc5_t10;
Table,Create Table
auto_rng_part_tc5_t10,CREATE TABLE `auto_rng_part_tc5_t10` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` datetime NOT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(1, MONTH), ARCHIVE_TYPE = 'SUBPARTITION', ARCHIVE_TABLE_NAME = '', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 8 )
PARTITION BY KEY(`a`)
PARTITIONS 2
SUBPARTITION BY RANGE COLUMNS(`b`)
(SUBPARTITION sp20240501 VALUES LESS THAN ('2024-01-01 00:00:00'),
 SUBPARTITION sp20240601 VALUES LESS THAN ('2024-02-02 00:00:00'),
 SUBPARTITION sp20240701 VALUES LESS THAN ('2024-03-03 00:00:00'),
 SUBPARTITION sp20240801 VALUES LESS THAN ('2024-04-04 00:00:00'),
 SUBPARTITION sp20240501@01 VALUES LESS THAN ('2024-05-01 00:00:00'),
 SUBPARTITION sp20240601@01 VALUES LESS THAN ('2024-06-01 00:00:00'),
 SUBPARTITION sp20240701@01 VALUES LESS THAN ('2024-07-01 00:00:00'),
 SUBPARTITION sp20240801@01 VALUES LESS THAN ('2024-08-01 00:00:00'))
create table auto_rng_part_tc5_t10_bk like auto_rng_part_tc5_t10 engine='columnar' archive_mode='ttl';
show create table auto_rng_part_tc5_t10;
Table,Create Table
auto_rng_part_tc5_t10,CREATE TABLE `auto_rng_part_tc5_t10` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` datetime NOT NULL,
	PRIMARY KEY (`a`),
	CLUSTERED COLUMNAR INDEX `arctmp_auto_rng_part_tc5_t10_bk` (`b`)
		PARTITION BY RANGE COLUMNS(`b`)
		(PARTITION p20230501 VALUES LESS THAN ('2023-05-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230601 VALUES LESS THAN ('2023-06-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230701 VALUES LESS THAN ('2023-07-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230801 VALUES LESS THAN ('2023-08-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230901 VALUES LESS THAN ('2023-09-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20231001 VALUES LESS THAN ('2023-10-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20231101 VALUES LESS THAN ('2023-11-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20231201 VALUES LESS THAN ('2023-12-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240101 VALUES LESS THAN ('2024-01-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240201 VALUES LESS THAN ('2024-02-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240301 VALUES LESS THAN ('2024-03-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240401 VALUES LESS THAN ('2024-04-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240501 VALUES LESS THAN ('2024-05-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240601 VALUES LESS THAN ('2024-06-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240701 VALUES LESS THAN ('2024-07-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240801 VALUES LESS THAN ('2024-08-01 00:00:00') ENGINE = Columnar,
		 PARTITION pmax VALUES LESS THAN (MAXVALUE) ENGINE = Columnar),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(1, MONTH), ARCHIVE_TYPE = 'SUBPARTITION', ARCHIVE_TABLE_NAME = 'auto_rng_part_tc5_t10_bk', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 8 )
PARTITION BY KEY(`a`)
PARTITIONS 2
SUBPARTITION BY RANGE COLUMNS(`b`)
(SUBPARTITION sp20240501 VALUES LESS THAN ('2024-01-01 00:00:00'),
 SUBPARTITION sp20240601 VALUES LESS THAN ('2024-02-02 00:00:00'),
 SUBPARTITION sp20240701 VALUES LESS THAN ('2024-03-03 00:00:00'),
 SUBPARTITION sp20240801 VALUES LESS THAN ('2024-04-04 00:00:00'),
 SUBPARTITION sp20240501@01 VALUES LESS THAN ('2024-05-01 00:00:00'),
 SUBPARTITION sp20240601@01 VALUES LESS THAN ('2024-06-01 00:00:00'),
 SUBPARTITION sp20240701@01 VALUES LESS THAN ('2024-07-01 00:00:00'),
 SUBPARTITION sp20240801@01 VALUES LESS THAN ('2024-08-01 00:00:00'))
alter table auto_rng_part_tc5_t10 add subpartition
(
subpartition sp202503 values less than('2025-02-05')
);
show create table auto_rng_part_tc5_t10;
Table,Create Table
auto_rng_part_tc5_t10,CREATE TABLE `auto_rng_part_tc5_t10` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` datetime NOT NULL,
	PRIMARY KEY (`a`),
	CLUSTERED COLUMNAR INDEX `arctmp_auto_rng_part_tc5_t10_bk` (`b`)
		PARTITION BY RANGE COLUMNS(`b`)
		(PARTITION p20230501 VALUES LESS THAN ('2023-05-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230601 VALUES LESS THAN ('2023-06-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230701 VALUES LESS THAN ('2023-07-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230801 VALUES LESS THAN ('2023-08-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230901 VALUES LESS THAN ('2023-09-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20231001 VALUES LESS THAN ('2023-10-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20231101 VALUES LESS THAN ('2023-11-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20231201 VALUES LESS THAN ('2023-12-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240101 VALUES LESS THAN ('2024-01-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240201 VALUES LESS THAN ('2024-02-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240301 VALUES LESS THAN ('2024-03-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240401 VALUES LESS THAN ('2024-04-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240501 VALUES LESS THAN ('2024-05-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240601 VALUES LESS THAN ('2024-06-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240701 VALUES LESS THAN ('2024-07-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240801 VALUES LESS THAN ('2024-08-01 00:00:00') ENGINE = Columnar,
		 PARTITION pmax VALUES LESS THAN (MAXVALUE) ENGINE = Columnar),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(1, MONTH), ARCHIVE_TYPE = 'SUBPARTITION', ARCHIVE_TABLE_NAME = 'auto_rng_part_tc5_t10_bk', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 8 )
PARTITION BY KEY(`a`)
PARTITIONS 2
SUBPARTITION BY RANGE COLUMNS(`b`)
(SUBPARTITION sp20240501 VALUES LESS THAN ('2024-01-01 00:00:00'),
 SUBPARTITION sp20240601 VALUES LESS THAN ('2024-02-02 00:00:00'),
 SUBPARTITION sp20240701 VALUES LESS THAN ('2024-03-03 00:00:00'),
 SUBPARTITION sp20240801 VALUES LESS THAN ('2024-04-04 00:00:00'),
 SUBPARTITION sp20240501@01 VALUES LESS THAN ('2024-05-01 00:00:00'),
 SUBPARTITION sp20240601@01 VALUES LESS THAN ('2024-06-01 00:00:00'),
 SUBPARTITION sp20240701@01 VALUES LESS THAN ('2024-07-01 00:00:00'),
 SUBPARTITION sp20240801@01 VALUES LESS THAN ('2024-08-01 00:00:00'),
 SUBPARTITION sp202503 VALUES LESS THAN ('2025-02-05 00:00:00'))
alter table auto_rng_part_tc5_t10 add subpartition
(
subpartition sp202507 values less than('2025-07-01')
);
show create table auto_rng_part_tc5_t10;
Table,Create Table
auto_rng_part_tc5_t10,CREATE TABLE `auto_rng_part_tc5_t10` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` datetime NOT NULL,
	PRIMARY KEY (`a`),
	CLUSTERED COLUMNAR INDEX `arctmp_auto_rng_part_tc5_t10_bk` (`b`)
		PARTITION BY RANGE COLUMNS(`b`)
		(PARTITION p20230501 VALUES LESS THAN ('2023-05-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230601 VALUES LESS THAN ('2023-06-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230701 VALUES LESS THAN ('2023-07-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230801 VALUES LESS THAN ('2023-08-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230901 VALUES LESS THAN ('2023-09-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20231001 VALUES LESS THAN ('2023-10-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20231101 VALUES LESS THAN ('2023-11-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20231201 VALUES LESS THAN ('2023-12-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240101 VALUES LESS THAN ('2024-01-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240201 VALUES LESS THAN ('2024-02-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240301 VALUES LESS THAN ('2024-03-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240401 VALUES LESS THAN ('2024-04-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240501 VALUES LESS THAN ('2024-05-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240601 VALUES LESS THAN ('2024-06-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240701 VALUES LESS THAN ('2024-07-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240801 VALUES LESS THAN ('2024-08-01 00:00:00') ENGINE = Columnar,
		 PARTITION pmax VALUES LESS THAN (MAXVALUE) ENGINE = Columnar),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(1, MONTH), ARCHIVE_TYPE = 'SUBPARTITION', ARCHIVE_TABLE_NAME = 'auto_rng_part_tc5_t10_bk', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 8 )
PARTITION BY KEY(`a`)
PARTITIONS 2
SUBPARTITION BY RANGE COLUMNS(`b`)
(SUBPARTITION sp20240501 VALUES LESS THAN ('2024-01-01 00:00:00'),
 SUBPARTITION sp20240601 VALUES LESS THAN ('2024-02-02 00:00:00'),
 SUBPARTITION sp20240701 VALUES LESS THAN ('2024-03-03 00:00:00'),
 SUBPARTITION sp20240801 VALUES LESS THAN ('2024-04-04 00:00:00'),
 SUBPARTITION sp20240501@01 VALUES LESS THAN ('2024-05-01 00:00:00'),
 SUBPARTITION sp20240601@01 VALUES LESS THAN ('2024-06-01 00:00:00'),
 SUBPARTITION sp20240701@01 VALUES LESS THAN ('2024-07-01 00:00:00'),
 SUBPARTITION sp20240801@01 VALUES LESS THAN ('2024-08-01 00:00:00'),
 SUBPARTITION sp202503 VALUES LESS THAN ('2025-02-05 00:00:00'),
 SUBPARTITION sp202507 VALUES LESS THAN ('2025-07-01 00:00:00'))
alter table auto_rng_part_tc5_t10 cleanup expired data;
show create table auto_rng_part_tc5_t10;
Table,Create Table
auto_rng_part_tc5_t10,CREATE TABLE `auto_rng_part_tc5_t10` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` datetime NOT NULL,
	PRIMARY KEY (`a`),
	CLUSTERED COLUMNAR INDEX `arctmp_auto_rng_part_tc5_t10_bk` (`b`)
		PARTITION BY RANGE COLUMNS(`b`)
		(PARTITION p20230501 VALUES LESS THAN ('2023-05-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230601 VALUES LESS THAN ('2023-06-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230701 VALUES LESS THAN ('2023-07-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230801 VALUES LESS THAN ('2023-08-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230901 VALUES LESS THAN ('2023-09-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20231001 VALUES LESS THAN ('2023-10-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20231101 VALUES LESS THAN ('2023-11-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20231201 VALUES LESS THAN ('2023-12-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240101 VALUES LESS THAN ('2024-01-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240201 VALUES LESS THAN ('2024-02-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240301 VALUES LESS THAN ('2024-03-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240401 VALUES LESS THAN ('2024-04-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240501 VALUES LESS THAN ('2024-05-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240601 VALUES LESS THAN ('2024-06-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240701 VALUES LESS THAN ('2024-07-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240801 VALUES LESS THAN ('2024-08-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240901 VALUES LESS THAN ('2024-09-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20241001 VALUES LESS THAN ('2024-10-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20241101 VALUES LESS THAN ('2024-11-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20241201 VALUES LESS THAN ('2024-12-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250101 VALUES LESS THAN ('2025-01-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250201 VALUES LESS THAN ('2025-02-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250301 VALUES LESS THAN ('2025-03-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250401 VALUES LESS THAN ('2025-04-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250501 VALUES LESS THAN ('2025-05-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250601 VALUES LESS THAN ('2025-06-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250701 VALUES LESS THAN ('2025-07-01 00:00:00') ENGINE = Columnar,
		 PARTITION pmax VALUES LESS THAN (MAXVALUE) ENGINE = Columnar),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(1, MONTH), ARCHIVE_TYPE = 'SUBPARTITION', ARCHIVE_TABLE_NAME = 'auto_rng_part_tc5_t10_bk', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 8 )
PARTITION BY KEY(`a`)
PARTITIONS 2
SUBPARTITION BY RANGE COLUMNS(`b`)
(SUBPARTITION sp20240501 VALUES LESS THAN ('2024-01-01 00:00:00'),
 SUBPARTITION sp20240601 VALUES LESS THAN ('2024-02-02 00:00:00'),
 SUBPARTITION sp20240701 VALUES LESS THAN ('2024-03-03 00:00:00'),
 SUBPARTITION sp20240801 VALUES LESS THAN ('2024-04-04 00:00:00'),
 SUBPARTITION sp20240501@01 VALUES LESS THAN ('2024-05-01 00:00:00'),
 SUBPARTITION sp20240601@01 VALUES LESS THAN ('2024-06-01 00:00:00'),
 SUBPARTITION sp20240701@01 VALUES LESS THAN ('2024-07-01 00:00:00'),
 SUBPARTITION sp20240801@01 VALUES LESS THAN ('2024-08-01 00:00:00'),
 SUBPARTITION sp202503 VALUES LESS THAN ('2025-02-05 00:00:00'),
 SUBPARTITION sp202507 VALUES LESS THAN ('2025-07-01 00:00:00'))
alter table auto_rng_part_tc5_t10 drop subpartition sp20240501,sp20240601,sp20240701,sp20240801;
alter table auto_rng_part_tc5_t10 drop subpartition `sp20240501@01`;
show create table auto_rng_part_tc5_t10;
Table,Create Table
auto_rng_part_tc5_t10,CREATE TABLE `auto_rng_part_tc5_t10` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` datetime NOT NULL,
	PRIMARY KEY (`a`),
	CLUSTERED COLUMNAR INDEX `arctmp_auto_rng_part_tc5_t10_bk` (`b`)
		PARTITION BY RANGE COLUMNS(`b`)
		(PARTITION p20230501 VALUES LESS THAN ('2023-05-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230601 VALUES LESS THAN ('2023-06-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230701 VALUES LESS THAN ('2023-07-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230801 VALUES LESS THAN ('2023-08-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230901 VALUES LESS THAN ('2023-09-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20231001 VALUES LESS THAN ('2023-10-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20231101 VALUES LESS THAN ('2023-11-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20231201 VALUES LESS THAN ('2023-12-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240101 VALUES LESS THAN ('2024-01-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240201 VALUES LESS THAN ('2024-02-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240301 VALUES LESS THAN ('2024-03-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240401 VALUES LESS THAN ('2024-04-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240501 VALUES LESS THAN ('2024-05-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240601 VALUES LESS THAN ('2024-06-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240701 VALUES LESS THAN ('2024-07-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240801 VALUES LESS THAN ('2024-08-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240901 VALUES LESS THAN ('2024-09-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20241001 VALUES LESS THAN ('2024-10-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20241101 VALUES LESS THAN ('2024-11-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20241201 VALUES LESS THAN ('2024-12-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250101 VALUES LESS THAN ('2025-01-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250201 VALUES LESS THAN ('2025-02-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250301 VALUES LESS THAN ('2025-03-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250401 VALUES LESS THAN ('2025-04-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250501 VALUES LESS THAN ('2025-05-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250601 VALUES LESS THAN ('2025-06-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250701 VALUES LESS THAN ('2025-07-01 00:00:00') ENGINE = Columnar,
		 PARTITION pmax VALUES LESS THAN (MAXVALUE) ENGINE = Columnar),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(1, MONTH), ARCHIVE_TYPE = 'SUBPARTITION', ARCHIVE_TABLE_NAME = 'auto_rng_part_tc5_t10_bk', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 8 )
PARTITION BY KEY(`a`)
PARTITIONS 2
SUBPARTITION BY RANGE COLUMNS(`b`)
(SUBPARTITION sp20240601@01 VALUES LESS THAN ('2024-06-01 00:00:00'),
 SUBPARTITION sp20240701@01 VALUES LESS THAN ('2024-07-01 00:00:00'),
 SUBPARTITION sp20240801@01 VALUES LESS THAN ('2024-08-01 00:00:00'),
 SUBPARTITION sp202503 VALUES LESS THAN ('2025-02-05 00:00:00'),
 SUBPARTITION sp202507 VALUES LESS THAN ('2025-07-01 00:00:00'))
alter table auto_rng_part_tc5_t10 cleanup expired data;
show create table auto_rng_part_tc5_t10;
Table,Create Table
auto_rng_part_tc5_t10,CREATE TABLE `auto_rng_part_tc5_t10` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` datetime NOT NULL,
	PRIMARY KEY (`a`),
	CLUSTERED COLUMNAR INDEX `arctmp_auto_rng_part_tc5_t10_bk` (`b`)
		PARTITION BY RANGE COLUMNS(`b`)
		(PARTITION p20230501 VALUES LESS THAN ('2023-05-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230601 VALUES LESS THAN ('2023-06-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230701 VALUES LESS THAN ('2023-07-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230801 VALUES LESS THAN ('2023-08-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230901 VALUES LESS THAN ('2023-09-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20231001 VALUES LESS THAN ('2023-10-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20231101 VALUES LESS THAN ('2023-11-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20231201 VALUES LESS THAN ('2023-12-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240101 VALUES LESS THAN ('2024-01-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240201 VALUES LESS THAN ('2024-02-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240301 VALUES LESS THAN ('2024-03-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240401 VALUES LESS THAN ('2024-04-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240501 VALUES LESS THAN ('2024-05-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240601 VALUES LESS THAN ('2024-06-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240701 VALUES LESS THAN ('2024-07-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240801 VALUES LESS THAN ('2024-08-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240901 VALUES LESS THAN ('2024-09-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20241001 VALUES LESS THAN ('2024-10-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20241101 VALUES LESS THAN ('2024-11-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20241201 VALUES LESS THAN ('2024-12-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250101 VALUES LESS THAN ('2025-01-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250201 VALUES LESS THAN ('2025-02-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250301 VALUES LESS THAN ('2025-03-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250401 VALUES LESS THAN ('2025-04-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250501 VALUES LESS THAN ('2025-05-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250601 VALUES LESS THAN ('2025-06-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250701 VALUES LESS THAN ('2025-07-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250801 VALUES LESS THAN ('2025-08-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250901 VALUES LESS THAN ('2025-09-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20251001 VALUES LESS THAN ('2025-10-01 00:00:00') ENGINE = Columnar,
		 PARTITION pmax VALUES LESS THAN (MAXVALUE) ENGINE = Columnar),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'OFF', TTL_PART_INTERVAL = INTERVAL(1, MONTH), ARCHIVE_TYPE = 'SUBPARTITION', ARCHIVE_TABLE_NAME = 'auto_rng_part_tc5_t10_bk', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 8 )
PARTITION BY KEY(`a`)
PARTITIONS 2
SUBPARTITION BY RANGE COLUMNS(`b`)
(SUBPARTITION sp20240601@01 VALUES LESS THAN ('2024-06-01 00:00:00'),
 SUBPARTITION sp20240701@01 VALUES LESS THAN ('2024-07-01 00:00:00'),
 SUBPARTITION sp20240801@01 VALUES LESS THAN ('2024-08-01 00:00:00'),
 SUBPARTITION sp202503 VALUES LESS THAN ('2025-02-05 00:00:00'),
 SUBPARTITION sp202507 VALUES LESS THAN ('2025-07-01 00:00:00'),
 SUBPARTITION sp20250801 VALUES LESS THAN ('2025-08-01 00:00:00'),
 SUBPARTITION sp20250901 VALUES LESS THAN ('2025-09-01 00:00:00'),
 SUBPARTITION sp20251001 VALUES LESS THAN ('2025-10-01 00:00:00'))
alter table auto_rng_part_tc5_t10 modify ttl set ttl_cleanup='ON';
show create table auto_rng_part_tc5_t10;
Table,Create Table
auto_rng_part_tc5_t10,CREATE TABLE `auto_rng_part_tc5_t10` (
	`a` int(11) NOT NULL AUTO_INCREMENT,
	`b` datetime NOT NULL,
	PRIMARY KEY (`a`),
	CLUSTERED COLUMNAR INDEX `arctmp_auto_rng_part_tc5_t10_bk` (`b`)
		PARTITION BY RANGE COLUMNS(`b`)
		(PARTITION p20230501 VALUES LESS THAN ('2023-05-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230601 VALUES LESS THAN ('2023-06-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230701 VALUES LESS THAN ('2023-07-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230801 VALUES LESS THAN ('2023-08-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20230901 VALUES LESS THAN ('2023-09-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20231001 VALUES LESS THAN ('2023-10-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20231101 VALUES LESS THAN ('2023-11-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20231201 VALUES LESS THAN ('2023-12-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240101 VALUES LESS THAN ('2024-01-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240201 VALUES LESS THAN ('2024-02-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240301 VALUES LESS THAN ('2024-03-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240401 VALUES LESS THAN ('2024-04-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240501 VALUES LESS THAN ('2024-05-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240601 VALUES LESS THAN ('2024-06-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240701 VALUES LESS THAN ('2024-07-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240801 VALUES LESS THAN ('2024-08-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20240901 VALUES LESS THAN ('2024-09-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20241001 VALUES LESS THAN ('2024-10-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20241101 VALUES LESS THAN ('2024-11-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20241201 VALUES LESS THAN ('2024-12-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250101 VALUES LESS THAN ('2025-01-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250201 VALUES LESS THAN ('2025-02-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250301 VALUES LESS THAN ('2025-03-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250401 VALUES LESS THAN ('2025-04-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250501 VALUES LESS THAN ('2025-05-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250601 VALUES LESS THAN ('2025-06-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250701 VALUES LESS THAN ('2025-07-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250801 VALUES LESS THAN ('2025-08-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20250901 VALUES LESS THAN ('2025-09-01 00:00:00') ENGINE = Columnar,
		 PARTITION p20251001 VALUES LESS THAN ('2025-10-01 00:00:00') ENGINE = Columnar,
		 PARTITION pmax VALUES LESS THAN (MAXVALUE) ENGINE = Columnar),
	KEY `auto_shard_key_b` USING BTREE (`b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4 TTL = TTL_DEFINITION ( TTL_ENABLE = 'OFF', TTL_EXPR = `b` EXPIRE OVER 8 PARTITIONS , TTL_JOB = CRON '0 0 2 * * ? *', TTL_CLEANUP = 'ON', TTL_PART_INTERVAL = INTERVAL(1, MONTH), ARCHIVE_TYPE = 'SUBPARTITION', ARCHIVE_TABLE_NAME = 'auto_rng_part_tc5_t10_bk', ARCHIVE_TABLE_PRE_ALLOCATE = 8, ARCHIVE_TABLE_POST_ALLOCATE = 8 )
PARTITION BY KEY(`a`)
PARTITIONS 2
SUBPARTITION BY RANGE COLUMNS(`b`)
(SUBPARTITION sp20240601@01 VALUES LESS THAN ('2024-06-01 00:00:00'),
 SUBPARTITION sp20240701@01 VALUES LESS THAN ('2024-07-01 00:00:00'),
 SUBPARTITION sp20240801@01 VALUES LESS THAN ('2024-08-01 00:00:00'),
 SUBPARTITION sp202503 VALUES LESS THAN ('2025-02-05 00:00:00'),
 SUBPARTITION sp202507 VALUES LESS THAN ('2025-07-01 00:00:00'),
 SUBPARTITION sp20250801 VALUES LESS THAN ('2025-08-01 00:00:00'),
 SUBPARTITION sp20250901 VALUES LESS THAN ('2025-09-01 00:00:00'),
 SUBPARTITION sp20251001 VALUES LESS THAN ('2025-10-01 00:00:00'))
drop table auto_rng_part_tc5_t1;
drop table auto_rng_part_tc5_t2;
drop table auto_rng_part_tc5_t3;
drop table auto_rng_part_tc5_t9;
drop table auto_rng_part_tc5_t10;